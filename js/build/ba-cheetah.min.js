var BACheetahColorPicker;!function(d){var a=[],t=navigator.userAgent.toLowerCase(),i="Microsoft Internet Explorer"===navigator.appName,o=i?parseFloat(t.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,h=i&&o<10,s=!1,n=["-moz-","-webkit-","-o-","-ms-"];function l(e,t){return e="top"===e?"top":"left",t=d.isArray(t)?t:Array.prototype.slice.call(arguments,1),"webkit"===s?(o=[],a="top"===(a=e)?"0% 0%,0% 100%,":"0% 100%,100% 100%,",i=r(i=t),d.each(i,function(e,t){o.push("color-stop("+parseFloat(t.stop)/100+", "+t.color+")")}),"-webkit-gradient(linear,"+a+o.join(",")+")"):n[s]+"linear-gradient("+e+", "+t.join(", ")+")";var a,i,o}function r(e){var h=[],s=[],t=[],a=e.length-1;return d.each(e,function(e,t){var a=t,i=!1,o=t.match(/1?[0-9]{1,2}%$/);o&&(a=t.replace(/\s?1?[0-9]{1,2}%$/,""),i=o.shift()),h.push(a),s.push(i)}),!1===s[0]&&(s[0]="0%"),!1===s[a]&&(s[a]="100%"),s=function e(t){var a,i,o,h,s=0,n=t.length-1,l=0,r=!1;if(t.length<=2||d.inArray(!1,t)<0)return t;for(;l<t.length-1;)r||!1!==t[l]?r&&!1!==t[l]&&(n=l,l=t.length):(s=l-1,r=!0),l++;i=n-s;h=parseInt(t[s].replace("%"),10);a=(parseFloat(t[n].replace("%"))-h)/i;l=s+1;o=1;for(;l<n;)t[l]=h+o*a+"%",o++,l++;return e(t)}(s),d.each(s,function(e){t[e]={color:h[e],stop:s[e]}}),t}baCheetahParseColorValue=function(e){var t=e.replace(/\s+/g,""),e=-1!==t.indexOf("rgba")?parseFloat(100*t.replace(/^.*,(.+)\)/,"$1")):100;return{value:t,alpha:e,rgba:e<100}},d.fn.baCheetahColorPickerGradient=function(){var e=arguments;return this.each(function(){h?function(e,i){var o,t,h,s,n;e="top"===e?"top":"left",i=d.isArray(i)?i:Array.prototype.slice.call(arguments,1),o="top"===e?0:1,t=d(this),h=i.length-1,s='<div class="iris-ie-gradient-shim" style="position:absolute;'+(1==o?"height":"width")+":100%;"+(1==o?"left":"top")+":%start%;"+(1==o?"right":"bottom")+':%end%;filter:%filter%;" data-color:"%color%"></div>',n="","static"===t.css("position")&&t.css({position:"relative"}),i=r(i),d.each(i,function(e,t){var a;return e!==h&&(a=i[e+1],void(t.stop!==a.stop&&(e=100-parseFloat(a.stop)+"%",t.octoHex=new BACheetahColor(t.color).toIEOctoHex(),a.octoHex=new BACheetahColor(a.color).toIEOctoHex(),a="progid:DXImageTransform.Microsoft.Gradient(GradientType="+o+", StartColorStr='"+t.octoHex+"', EndColorStr='"+a.octoHex+"')",n+=s.replace("%start%",t.stop).replace("%end%",e).replace("%filter%",a))))}),t.find(".iris-ie-gradient-shim").remove(),d(n).prependTo(t)}.apply(this,e):d(this).css("backgroundImage",l.apply(this,e))})},d.fn.baCheetahColorPickerRaninbowGradient=function(e,t){var a,i,o;for(e=e||"top",a="hsl(%h%,"+(t=d.extend({},{s:100,l:50},t)).s+"%,"+t.l+"%)",i=0,o=[];i<=360;)o.push(a.replace("%h%",i)),i+=30;return this.each(function(){d(this).baCheetahColorPickerGradient(e,o)})},(BACheetahColorPicker=function(e){this._html='<div class="ba-cheetah-color-picker-ui"><div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="javascript:void(0);"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div></div>';this.options=d.extend({},{elements:null,color:"",mode:"hsl",controls:{horiz:"s",vert:"l",strip:"h"},target:!1,width:200,presets:[],labels:{colorPresets:"My colors",colorPicker:"Color Picker",placeholder:"Paste color here...",removePresetConfirm:"Are you sure?",noneColorSelected:"None color selected.",alreadySaved:"%s is already a saved.",noPresets:"Add a color preset first.",presetAdded:"%s added to palette!"}},e),(!1==h||!0==h&&7<o)&&this._init()}).prototype={_html:"",_color:"",_currentElement:"",_inited:!1,_defaultHSLControls:{horiz:"s",vert:"l",strip:"h"},_defaultHSVControls:{horiz:"h",vert:"v",strip:"s"},_scale:{h:360,s:100,l:100,v:100},_init:function(){var e=this;d(e.options.elements);d("html").hasClass("ba-cheetah-color-picker-init")?this._prepareColorFields():(this._color=new BACheetahColor("").setHSpace(e.options.mode),a=this.options.presets,!1===s&&function(){var a,i="backgroundImage";h?s="filter":(a=d('<div id="iris-gradtest" />'),d.each(n,function(e,t){if(a.css(i,t+"linear-gradient(top,#fff,#000)"),a.css(i).match("gradient"))return s=e,!1}),!1===s&&(a.css("background","-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))"),a.css(this.bgImageString).match("gradient")&&(s="webkit")),a.remove())}(),e.picker=d(this._html).appendTo("body"),i?9===o?e.picker.addClass("iris-ie-9"):o<=8&&e.picker.addClass("iris-ie-lt9"):t.indexOf("compatible")<0&&t.indexOf("khtml")<0&&t.match(/mozilla/)&&e.picker.addClass("iris-mozilla"),e.controls={square:e.picker.find(".iris-square"),squareDrag:e.picker.find(".iris-square-value"),horiz:e.picker.find(".iris-square-horiz"),vert:e.picker.find(".iris-square-vert"),strip:e.picker.find(".iris-strip"),stripSlider:e.picker.find(".iris-strip .iris-slider-offset")},"hsv"===e.options.mode&&e._has("l",e.options.controls)?e.options.controls=e._defaultHSVControls:"hsl"===e.options.mode&&e._has("v",e.options.controls)&&(e.options.controls=e._defaultHSLControls),e.hue=e._color.h(),this._setTemplates(),this._ui=d(".ba-cheetah-color-picker-ui"),this._iris=d(".iris-picker"),this._wrapper=d("body"),this._ui.append(this._hexHtml).append(this._presetsHtml),e.element=this._ui.find(".ba-cheetah-color-picker-input"),e._initControls(),e.active="external",e._change(),e._addInputListeners(e.element),this._buildUI(),this._prepareColorFields(),this._pickerControls(),this._presetsControls(),this._buildAlphaUI(),d("html").addClass("ba-cheetah-color-picker-init"))},_prepareColorFields:function(){var h=this;d(".ba-cheetah-color-picker-value").each(function(){var e=d(this),t=e.val(),a=e.parent().find(".ba-cheetah-color-picker-color"),i=baCheetahParseColorValue(t),o="";t&&(a.hasClass("ba-cheetah-color-picker-alpha-enabled")&&i.rgba?o=e.val().toString():!a.hasClass("ba-cheetah-color-picker-alpha-enabled")&&i.rgba?(t=(t=t.replace("rgba","rgb")).substr(0,t.lastIndexOf(","))+")",h._color._alpha=1,o=t,e.val(t)):o="#"+e.val().toString(),a.css({backgroundColor:o}))})},_setTemplates:function(){this._alphaHtml='<div class="ba-cheetah-alpha-wrap"><div class="ba-cheetah-alpha-slider"></div><div class="ba-cheetah-alpha-slider-offset"></div><div class="ba-cheetah-alpha-text"></div></div>',this._presetsHtml='<div class="ba-cheetah-color-picker-presets"><span class="ba-cheetah-color-picker-presets-title">'+this.options.labels.colorPresets+'</span><ul class="ba-cheetah-color-picker-presets-list"></ul></div>',this._hexHtml='<input type="text" class="ba-cheetah-color-picker-input" placeholder="'+this.options.labels.placeholder+'">',this._presetsAdd='<div title="Save current color to your palette" class="ba-cheetah-color-picker-preset-add"></div>',this._presetsTpl='<li class="ba-cheetah-color-picker-preset"><span class="ba-cheetah-color-picker-preset-color"></span> <span class="ba-cheetah-color-picker-preset-label"></span> <span class="ba-cheetah-color-picker-preset-remove ba-cheetah-color-picker-icon-remove"></span></li>',this._noPresetsTpl='<li class="ba-cheetah-color-picker-no-preset"><span class="ba-cheetah-color-picker-preset-label">'+this.options.labels.noPresets+"</span></li>"},_has:function(a,e){var i=!1;return d.each(e,function(e,t){if(a===t)return!(i=!0)}),i},_buildUI:function(){var a=this;a._presetsList=this._ui.find(".ba-cheetah-color-picker-presets-list"),a._presetsList.html(""),a._presetsList.append(this._presetsAdd),0<this.options.presets.length?d.each(this.options.presets,function(e,t){a._addPresetView(t)}):a._presetsList.append(this._noPresetsTpl)},_addPresetView:function(e){var t=this._presetsList.find(".ba-cheetah-color-picker-no-preset");0<t.length&&t.remove();var a=d(this._presetsTpl),t=BACheetahColor(e);a.attr("data-color",e).find(".ba-cheetah-color-picker-preset-color").css({backgroundColor:t.toString()}).end().find(".ba-cheetah-color-picker-preset-label").html(t.toString()),this._presetsList.append(a)},_addPresetFeedback:function(){this._ui.append('<div class="ba-cheetah-color-picker-added"><div class="ba-cheetah-color-picker-added-text"><div class="ba-cheetah-color-picker-icon-check"></div> "'+this.options.labels.presetAdded.replace("%s",this._color.toString())+'"</div></div>'),this._ui.find(".ba-cheetah-color-picker-added").hide().fadeIn(200).delay(2e3).fadeOut(200,function(){d(this).remove()})},_pickerControls:function(){var a=this;this._wrapper.on("click",".ba-cheetah-color-picker-color",function(){var e=d(this);a._currentElement=e.parent().find(".ba-cheetah-color-picker-value"),a._ui.position({my:"left top",at:"left bottom",of:e,collision:"flip",using:function(e,t){a._togglePicker(e)}})}).on("click",".ba-cheetah-color-picker-clear",function(){var e=d(this);a._currentElement=e.parent().find(".ba-cheetah-color-picker-value"),e.parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:"transparent"}).addClass("ba-cheetah-color-picker-empty"),e.parent().find(".ba-cheetah-color-picker-value-input").val(""),a._setColor(""),a.element.val(""),a._currentElement.val("").trigger("change")}).on("input",".ba-cheetah-color-picker-value-input",function(){var e=d(this);a._currentElement=e.parent().find(".ba-cheetah-color-picker-value");var t=new BACheetahColor(e.val()),e=e.val().replace(/^#/,"");t.error||""==t.toString?console.warn("Invalid color"):(a._currentElement.parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:BACheetahColor(e).toString()}).removeClass("ba-cheetah-color-picker-empty"),a._currentElement.val(e.toLowerCase()).trigger("change"))}),d(document).on("mousedown",function(e){0===d(e.target).closest(".ba-cheetah-color-picker-ui").length&&(presets=a._ui.find(".ba-cheetah-color-picker-presets"),presetsList=presets.find(".ba-cheetah-color-picker-presets-list"),d(".ba-cheetah-color-picker-ui.ba-cheetah-color-picker-active").removeClass("ba-cheetah-color-picker-active"))})},_presetsControls:function(){var a=this,e=a._ui.find(".ba-cheetah-color-picker-preset-add"),t=a._ui.find(".ba-cheetah-color-picker-presets"),i=t.find(".ba-cheetah-color-picker-presets-list");e.off("click").on("click",function(){a._addPreset(a.element.val())}),i.sortable(),t.off("click").on("click",".ba-cheetah-color-picker-preset",function(e){var t=new BACheetahColor(d(this).data("color").toString());a._setColor(t),a._currentElement.parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:t.toString()}).removeClass("ba-cheetah-color-picker-empty")}).on("click",".ba-cheetah-color-picker-preset-remove",function(e){e.stopPropagation(),a._removePreset(d(this).parent().data("color"))})},_removePreset:function(e){var t;confirm(this.options.labels.removePresetConfirm)&&(t=e.toString(),-1<(e=a.indexOf(t))&&(a.splice(e,1),this.options.presets=a,this._presetsList.find('.ba-cheetah-color-picker-preset[data-color="'+t+'"]').slideUp(function(){d(this).remove()})),a.length<1&&this._presetsList.append(this._noPresetsTpl),d(this).trigger("presetRemoved",{presets:a}))},_addPreset:function(e){if(!this._CheckValidColor(e))return alert(this.options.labels.noneColorSelected),!1;e=e.toString().replace(/^#/,"");""===e?alert(this.options.labels.noneColorSelected):-1<a.indexOf(e)?alert(this.options.labels.alreadySaved.replace("%s","#"+e)):(this._addPresetView(e),this._addPresetFeedback(),a.push(e),this.options.presets=a,d(this).trigger("presetAdded",{presets:a}))},_CheckValidColor:function(e){if(!e.match(/^#/)&&!e.match(/^rgb/)&&!e.match(/^hsl/))return!1;var t=document.getElementById("divValidColor");return t||((t=document.createElement("div")).id="divValidColor"),t.style.borderColor="",t.style.borderColor=e,0!=t.style.borderColor.length},_togglePicker:function(e){var t=this;this._ui.hasClass("ba-cheetah-color-picker-active")?(this._ui.removeClass("ba-cheetah-color-picker-active"),e&&setTimeout(function(){t._ui.css(e),t._ui.addClass("ba-cheetah-color-picker-active"),t._setColor(t._currentElement.val())},200)):(e&&t._ui.css(e),setTimeout(function(){t._ui.addClass("ba-cheetah-color-picker-active"),t._setColor(t._currentElement.val())},200))},_paint:function(){this._paintDimension("right","strip"),this._paintDimension("top","vert"),this._paintDimension("left","horiz")},_paintDimension:function(e,t){var a,i=this,o=i._color,h=i.options.mode,s=i._getHSpaceColor(),n=i.controls[t],l=i.options.controls;if(t!==i.active&&("square"!==i.active||"strip"===t))switch(l[t]){case"h":n.baCheetahColorPickerRaninbowGradient(e,a={s:100,l:50});break;case"s":"hsv"===h?"vert"===t?a=[o.clone().a(0).s(0).toCSS("rgba"),o.clone().a(1).s(0).toCSS("rgba")]:"strip"===t?a=[o.clone().s(100).toCSS("hsl"),o.clone().s(0).toCSS("hsl")]:"horiz"===t&&(a=["#fff","hsl("+s.h+",100%,50%)"]):a="vert"===t&&"h"===i.options.controls.horiz?["hsla(0, 0%, "+s.l+"%, 0)","hsla(0, 0%, "+s.l+"%, 1)"]:["hsl("+s.h+",0%,50%)","hsl("+s.h+",100%,50%)"],n.baCheetahColorPickerGradient(e,a);break;case"l":a="strip"===t?["hsl("+s.h+",100%,100%)","hsl("+s.h+", "+s.s+"%,50%)","hsl("+s.h+",100%,0%)"]:["#fff","rgba(255,255,255,0) 50%","rgba(0,0,0,0) 50%","rgba(0,0,0,1)"],n.baCheetahColorPickerGradient(e,a);break;case"v":a="strip"===t?[o.clone().v(100).toCSS(),o.clone().v(0).toCSS()]:["rgba(0,0,0,0)","#000"],n.baCheetahColorPickerGradient(e,a)}},_getHSpaceColor:function(){return"hsv"===this.options.mode?this._color.toHsv():this._color.toHsl()},_dimensions:function(e){var t,a,i=this,o=i.options,h=i.controls.square,s=i.picker.find(".iris-strip"),n=o.border?o.width-20:o.width;if(e&&(h.css("width",""),s.css("width",""),i.picker.css({width:"",height:""})),t=n*(parseFloat("77.5%")/100),a=n*(parseFloat("12%")/100),n=o.border?20+t:t,h.width(t).height(t),s.height(t).width(a),i.picker.css({width:o.width,height:n}),!o.palettes)return i.picker.css("paddingBottom","")},_addInputListeners:function(o){function e(e){var t=new BACheetahColor(o.val()),a=o.val().replace(/^#/,""),i=h._currentElement.hasClass("ba-cheetah-color-picker-empty");if(o.removeClass("iris-error"),t.error)""!==a&&o.addClass("iris-error");else if(t.toString()!==h._color.toString()||""!==h._color.toString()&&i)if("keyup"===e.type)a.match(/^[0-9a-fA-F]{3}$/)||(h._setColor(a),h._currentElement.parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:BACheetahColor(a).toString()}).removeClass("ba-cheetah-color-picker-empty"),h._currentElement.val(a).trigger("change"));else if("paste"===e.type)return a=e.originalEvent.clipboardData.getData("text").replace(/^#/,""),hex=BACheetahColor(a).toString(),h._setColor(a),o.val(hex),h._currentElement.parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:hex}).removeClass("ba-cheetah-color-picker-empty"),h._currentElement.val(a).trigger("change"),!1}var h=this;o.on("change",e).on("keyup",h._debounce(e,100))},_initControls:function(){var h=this,s=h.controls,e=s.square,a=h.options.controls,i=h._scale[a.strip];s.stripSlider.slider({orientation:"horizontal",max:i,slide:function(e,t){h.active="strip","h"===a.strip&&(t.value=i-t.value),h._color[a.strip](t.value),h._change.apply(h,arguments)}}),s.squareDrag.draggable({containment:s.square.find(".iris-square-inner"),zIndex:1e3,cursor:"move",drag:function(e,t){h._squareDrag(e,t)},start:function(){e.addClass("iris-dragging"),d(this).addClass("ui-state-focus")},stop:function(){e.removeClass("iris-dragging"),d(this).removeClass("ui-state-focus")}}).on("mousedown mouseup",function(e){var t="ui-state-focus";e.preventDefault(),"mousedown"===e.type?(h.picker.find("."+t).removeClass(t).blur(),d(this).addClass(t).focus()):d(this).removeClass(t)}).on("keydown",function(e){var t=s.square,a=s.squareDrag,i=a.position(),o=2;switch(e.altKey&&(o*=10),e.keyCode){case 37:i.left-=o;break;case 38:i.top-=o;break;case 39:i.left+=o;break;case 40:i.top+=o;break;default:return!0}i.left=Math.max(0,Math.min(i.left,t.width())),i.top=Math.max(0,Math.min(i.top,t.height())),a.css(i),h._squareDrag(e,{position:i}),e.preventDefault()}),e.mousedown(function(e){var t;1===e.which&&d(e.target).is("div")&&(t=h.controls.square.offset(),t={top:e.pageY-t.top,left:e.pageX-t.left},e.preventDefault(),h._squareDrag(e,{position:t}),e.target=h.controls.squareDrag.get(0),h.controls.squareDrag.css(t).trigger(e))})},_squareDrag:function(e,t){var a=this,i=a.options.controls,o=a._squareDimensions(),h=Math.round((o.h-t.position.top)/o.h*a._scale[i.vert]),o=a._scale[i.horiz]-Math.round((o.w-t.position.left)/o.w*a._scale[i.horiz]);a._color[i.horiz](o)[i.vert](h),a.active="square",a._change.apply(a,arguments)},_setColor:function(e){var t=this,a=t.options.color;t.default=""===e&&!(e=""),(e=""+(t.options.color=e)).replace(/^#/,""),(e=new BACheetahColor(e).setHSpace(t.options.mode)).error?t.options.color=a:(t._color=e,t.options.color=t._color.toString(),t.active="external",t._change())},_squareDimensions:function(e){var t=this.controls.square;return void 0!==e&&t.data("dimensions")?t.data("dimensions"):(this.controls.squareDrag,e={w:t.width(),h:t.height()},t.data("dimensions",e),e)},_isNonHueControl:function(e,t){return"square"===e&&"h"===this.options.controls.strip||"external"!==t&&("h"!==t||"strip"!==e)},_change:function(){var i=this,o=i.controls,h=i._getHSpaceColor(),e=["square","strip"],s=i.options.controls,t=s[i.active]||"external",a=i.hue;"strip"===i.active?e=[]:"external"!==i.active&&e.pop(),d.each(e,function(e,t){var a;if(t!==i.active)switch(t){case"strip":a="h"===s.strip?i._scale[s.strip]-h[s.strip]:h[s.strip],o.stripSlider.slider("value",a);break;case"square":a=i._squareDimensions(),a={left:h[s.horiz]/i._scale[s.horiz]*a.w,top:a.h-h[s.vert]/i._scale[s.vert]*a.h},i.controls.squareDrag.css(a)}}),h.h!==a&&i._isNonHueControl(i.active,t)&&i._color.h(a),i.hue=i._color.h(),i.options.color=i._color.toString(),i.element.is(":input")&&!i._color.error&&(i.element.removeClass("iris-error"),i.element.val()!==i._color.toString()&&(i.element.val(i._color.toString()),this._currentElement&&(!i.default||i.default&&"external"!==i.active?this._currentElement.val(i._color.toString().replace(/^#/,"")).parent().find(".ba-cheetah-color-picker-color").css({backgroundColor:i._color.toString()}).removeClass("ba-cheetah-color-picker-empty").parent().find(".ba-cheetah-color-picker-value-input").val(i._color.toString()):this._currentElement.val(""),i._wrapper.find(".ba-cheetah-alpha-slider-offset").css("background-color",i._color.toString()),this._currentElement.trigger("change")))),i._paint(),i._inited=!0,i.active=!1},_debounce:function(o,h,s){var n,l;return function(){var e=this,t=arguments,a=function(){n=null,s||(l=o.apply(e,t))},i=s&&!n;return clearTimeout(n),n=setTimeout(a,h),l=i?o.apply(e,t):l}},_buildAlphaUI:function(){var t=this;t._wrapper.on("click",".ba-cheetah-color-picker-color",function(){var e=d(this);t._currentElement.val();e.hasClass("ba-cheetah-color-picker-alpha-enabled")?(t._ui.find(".ba-cheetah-alpha-wrap").length<=0&&d(t._alphaHtml).insertAfter(t._iris),t.picker.addClass("ba-cheetah-color-alpha-enabled"),t._pickerAlphaControls()):(t.picker.removeClass("ba-cheetah-color-alpha-enabled"),t._ui.find(".ba-cheetah-alpha-wrap").remove())})},_pickerAlphaControls:function(){var i=this,e=i._currentElement,t=baCheetahParseColorValue(e.val()),a=parseFloat(t.alpha/100),o=i._wrapper,e=i._ui.find(".ba-cheetah-alpha-wrap"),h=e.find(".ba-cheetah-alpha-slider"),s=e.find(".ba-cheetah-alpha-text"),n=e.find(".ba-cheetah-alpha-slider-offset");alphaHandle=e.find(".ui-slider-handle"),s.text(a<1?a:""),h.slider({slide:function(e,t){var a=parseFloat(t.value/100);i._color._alpha=a,s.text(a<1?a:""),i._change.apply(i,arguments)},create:function(){n.css({backgroundColor:t.value}),o.on("click",".ba-cheetah-color-picker-clear",function(){i._color._alpha=1,s.text(""),h.slider("value",100).trigger("slide")})},value:t.alpha,step:1,min:0,max:100})}}}(jQuery),function(e,d){var h=function(e,t){return this instanceof h?this._init(e,t):new h(e,t)};h.fn=h.prototype={_color:0,_alpha:1,error:!1,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:"hsl",_init:function(e){var t="noop";switch(typeof e){case"object":return e.a!==d&&this.a(e.a),this[t=e.r!==d?"fromRgb":e.l!==d?"fromHsl":e.v!==d?"fromHsv":t](e);case"string":return this.fromCSS(e);case"number":return this.fromInt(parseInt(e,10))}return this},_error:function(){return this.error=!0,this},clone:function(){for(var e=new h(this.toInt()),t=["_alpha","_hSpace","_hsl","_hsv","error"],a=t.length-1;0<=a;a--)e[t[a]]=this[t[a]];return e},setHSpace:function(e){return this._hSpace="hsv"===e?e:"hsl",this},noop:function(){return this},fromCSS:function(e){var t,a=/^(rgb|hs(l|v))a?\(/;if(this.error=!1,(e=e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/;$/,"")).match(a)&&e.match(/\)$/)){if((t=e.replace(/(\s|%)/g,"").replace(a,"").replace(/,?\);?$/,"").split(",")).length<3)return this._error();if(4===t.length&&(this.a(parseFloat(t.pop())),this.error))return this;for(var i=t.length-1;0<=i;i--)if(t[i]=parseInt(t[i],10),isNaN(t[i]))return this._error();return e.match(/^rgb/)?this.fromRgb({r:t[0],g:t[1],b:t[2]}):e.match(/^hsv/)?this.fromHsv({h:t[0],s:t[1],v:t[2]}):this.fromHsl({h:t[0],s:t[1],l:t[2]})}return this.fromHex(e)},fromRgb:function(e,t){return"object"!=typeof e||e.r===d||e.g===d||e.b===d?this._error():(this.error=!1,this.fromInt(parseInt((e.r<<16)+(e.g<<8)+e.b,10),t))},fromHex:function(e){return 3===(e=e.replace(/^#/,"").replace(/^0x/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),this.error=!/^[0-9A-F]{6}$/i.test(e),this.fromInt(parseInt(e,16))},fromHsl:function(e){var t,a,i,o,h;return"object"!=typeof e||e.h===d||e.s===d||e.l===d?this._error():(this._hsl=e,this._hSpace="hsl",o=e.h/360,h=e.s/100,e=e.l/100,0==h?t=a=i=e:(t=this.hue2rgb(h=2*e-(e=e<.5?e*(1+h):e+h-e*h),e,o+1/3),a=this.hue2rgb(h,e,o),i=this.hue2rgb(h,e,o-1/3)),this.fromRgb({r:255*t,g:255*a,b:255*i},!0))},fromHsv:function(e){var t,a,i,o,h,s,n,l,r;if("object"!=typeof e||e.h===d||e.s===d||e.v===d)return this._error();switch(this._hsv=e,this._hSpace="hsv",s=e.h/360,t=e.s/100,n=(a=e.v/100)*(1-t),l=a*(1-(s=6*s-(e=Math.floor(6*s)))*t),r=a*(1-(1-s)*t),e%6){case 0:i=a,o=r,h=n;break;case 1:i=l,o=a,h=n;break;case 2:i=n,o=a,h=r;break;case 3:i=n,o=l,h=a;break;case 4:i=r,o=n,h=a;break;case 5:i=a,o=n,h=l}return this.fromRgb({r:255*i,g:255*o,b:255*h},!0)},fromInt:function(e,t){return this._color=parseInt(e,10),isNaN(this._color)&&(this._color=0),16777215<this._color?this._color=16777215:this._color<0&&(this._color=0),t===d&&(this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0),this},hue2rgb:function(e,t,a){return a<0&&(a+=1),1<a&&--a,a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e},toString:function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;0<=t;t--)e="0"+e;return"#"+e},toCSS:function(e,t){switch(e=e||"hex",t=parseFloat(t||this._alpha),e){case"rgb":case"rgba":var a=this.toRgb();return t<1?"rgba( "+a.r+", "+a.g+", "+a.b+", "+t+" )":"rgb( "+a.r+", "+a.g+", "+a.b+" )";case"hsl":case"hsla":a=this.toHsl();return t<1?"hsla( "+a.h+", "+a.s+"%, "+a.l+"%, "+t+" )":"hsl( "+a.h+", "+a.s+"%, "+a.l+"% )";default:return this.toString()}},toRgb:function(){return{r:255&this._color>>16,g:255&this._color>>8,b:255&this._color}},toHsl:function(){var e,t=this.toRgb(),a=t.r/255,i=t.g/255,o=t.b/255,h=Math.max(a,i,o),s=Math.min(a,i,o),t=(h+s)/2;if(h===s)e=l=0;else{var n=h-s,l=.5<t?n/(2-h-s):n/(h+s);switch(h){case a:e=(i-o)/n+(i<o?6:0);break;case i:e=(o-a)/n+2;break;case o:e=(a-i)/n+4}e/=6}return{h:e=0===(e=Math.round(360*e))&&this._hsl.h!==e?this._hsl.h:e,s:l=0===(l=Math.round(100*l))&&this._hsl.s?this._hsl.s:l,l:Math.round(100*t)}},toHsv:function(){var e,t=this.toRgb(),a=t.r/255,i=t.g/255,o=t.b/255,h=Math.max(a,i,o),s=Math.min(a,i,o),n=h,l=h-s,t=0===h?0:l/h;if(h===s)e=t=0;else{switch(h){case a:e=(i-o)/l+(i<o?6:0);break;case i:e=(o-a)/l+2;break;case o:e=(a-i)/l+4}e/=6}return{h:e=0===(e=Math.round(360*e))&&this._hsv.h!==e?this._hsv.h:e,s:t=0===(t=Math.round(100*t))&&this._hsv.s?this._hsv.s:t,v:Math.round(100*n)}},toInt:function(){return this._color},toIEOctoHex:function(){var e=this.toString(),t=parseInt(255*this._alpha,10).toString(16);return"#"+(t=1===t.length?"0"+t:t)+e.replace(/^#/,"")},toLuminosity:function(){var e=this.toRgb();return.2126*Math.pow(e.r/255,2.2)+.7152*Math.pow(e.g/255,2.2)+.0722*Math.pow(e.b/255,2.2)},getDistanceLuminosityFrom:function(e){if(!(e instanceof h))throw"getDistanceLuminosityFrom requires a Color object";var t=this.toLuminosity(),e=e.toLuminosity();return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)},getMaxContrastColor:function(){var e=this.toLuminosity();return new h(.5<=e?"000000":"ffffff")},getReadableContrastingColor:function(e,t){if(!(e instanceof h))return this;var a=t===d?5:t,i=e.getDistanceLuminosityFrom(this),t=e.getMaxContrastColor();if(t.getDistanceLuminosityFrom(e)<=a)return t;if(a<=i)return this;for(var o=0===t.toInt()?-1:1;i<a&&(this.l(o,!0),i=this.getDistanceLuminosityFrom(e),0!==this._color&&16777215!==this._color););return this},a:function(e){if(e===d)return this._alpha;e=parseFloat(e);return isNaN(e)?this._error():(this._alpha=e,this)},darken:function(e){return this.l(-(e=e||5),!0)},lighten:function(e){return this.l(e=e||5,!0)},saturate:function(e){return this.s(e=e||15,!0)},desaturate:function(e){return this.s(-(e=e||15),!0)},toGrayscale:function(){return this.setHSpace("hsl").s(0)},getComplement:function(){return this.h(180,!0)},getSplitComplement:function(e){return this.h(180+30*(e=e||1),!0)},getAnalog:function(e){return this.h(30*(e=e||1),!0)},getTetrad:function(e){return this.h(60*(e=e||1),!0)},getTriad:function(e){return this.h(120*(e=e||1),!0)},_partial:function(i){var o=a[i];return function(e,t){var a=this._spaceFunc("to",o.space);return e===d?a[i]:(!0===t&&(e=a[i]+e),o.mod&&(e%=o.mod),o.range&&(e=e<o.range[0]?o.range[0]:e>o.range[1]?o.range[1]:e),a[i]=e,this._spaceFunc("from",o.space,a))}},_spaceFunc:function(e,t,a){t=t||this._hSpace;return this[e+t.charAt(0).toUpperCase()+t.substr(1)](a)}};var t,a={h:{mod:360},s:{range:[0,100]},l:{space:"hsl",range:[0,100]},v:{space:"hsv",range:[0,100]},r:{space:"rgb",range:[0,255]},g:{space:"rgb",range:[0,255]},b:{space:"rgb",range:[0,255]}};for(t in a)a.hasOwnProperty(t)&&(h.fn[t]=h.fn._partial(t));"object"==typeof exports?module.exports=h:(e.BACheetahColor=h,e.Color=h)}(this),function(l){BACheetahLightbox=function(e){this._init(e)},BACheetahLightbox.closeParent=function(e){e=l(e).closest(".ba-cheetah-lightbox-wrap").attr("data-instance-id");_.isUndefined(e)||BACheetahLightbox._instances[e].close()},BACheetahLightbox.getResizableControlClass=function(){var e=l(".ba-cheetah-lightbox-resizable").eq(0),t="far fa-window-maximize";return t=e.length&&e.hasClass("ba-cheetah-lightbox-width-full")?"far fa-window-minimize":t},BACheetahLightbox.unbindAll=function(){for(var e in BACheetahLightbox._instances)BACheetahLightbox._instances[e]._unbind()},BACheetahLightbox.bindAll=function(){for(var e in BACheetahLightbox._instances)BACheetahLightbox._instances[e]._bind()},BACheetahLightbox.closeAll=function(){for(var e in BACheetahLightbox._instances)BACheetahLightbox._instances[e].close()},BACheetahLightbox._instances={},BACheetahLightbox.prototype={_id:null,_node:null,_visible:!1,_allowClosing:!0,_resizeTimer:null,_defaults:{className:"",destroyOnClose:!1,resizable:!1},open:function(e){var t=this._node.find(".bal-cheetah-lightbox"),a=t.closest(".ba-cheetah-ui-pinned").length,i=this._getPositionSettings();!a&&i&&this._defaults.resizable&&t.css(i),this._bind(),this._node.show(),this._visible=!0,void 0!==e?this.setContent(e):this._resize(),this.trigger("open"),BACheetah.triggerHook("didShowLightbox",this)},close:function(){var e=this._node.data("parent");this._allowClosing&&(this.trigger("beforeCloseLightbox"),this._unbind(),this._node.hide(),this._visible=!1,this.trigger("close"),BACheetah.triggerHook("didHideLightbox"),this._defaults.resizable&&_.isUndefined(e)&&BACheetah.triggerHook("didHideAllLightboxes"),this._defaults.destroyOnClose&&this.destroy())},disableClose:function(){this._allowClosing=!1},enableClose:function(){this._allowClosing=!0},setContent:function(e){this._node.find(".ba-cheetah-lightbox-content").html(e),this._resize()},empty:function(){this._node.find(".ba-cheetah-lightbox-content").empty()},on:function(e,t){this._node.on(e,t)},off:function(e,t){this._node.off(e,t)},trigger:function(e,t){this._node.trigger(e,t)},destroy:function(){this._node.empty(),this._node.remove(),BACheetahLightbox._instances[this._id]="undefined";try{delete BACheetahLightbox._instances[this._id]}catch(e){}},_init:function(e){var t=0,a=null;for(a in BACheetahLightbox._instances)t++;this._defaults=l.extend({},this._defaults,e),this._id=(new Date).getTime()+t,(BACheetahLightbox._instances[this._id]=this)._render(),this._resizable()},_render:function(){this._node=l('<div class="ba-cheetah-lightbox-wrap" data-instance-id="'+this._id+'"><div class="ba-cheetah-lightbox-mask"></div><div class="bal-cheetah-lightbox"><div class="ba-cheetah-lightbox-content-wrap"><div class="ba-cheetah-lightbox-content"></div></div></div></div>'),this._node.addClass(this._defaults.className),l("body").append(this._node)},_bind:function(){l(window).on("resize.ba-cheetah-lightbox-"+this._id,this._delayedResize.bind(this))},_unbind:function(){l(window).off("resize.ba-cheetah-lightbox-"+this._id)},_resizable:function(){l("body");var e=this._node.find(".ba-cheetah-lightbox-mask"),t=this._node.find(".bal-cheetah-lightbox"),a=l(".ba-cheetah-lightbox-resizable").eq(0);this._defaults.resizable?(e.hide(),t.addClass("ba-cheetah-lightbox-resizable"),t.delegate(".ba-cheetah-lightbox-resize-toggle","click",this._resizeClicked.bind(this)),t.draggable({cursor:"move",handle:".ba-cheetah-lightbox-header"}).resizable({handles:"all",minHeight:500,minWidth:380,start:this._resizeStart.bind(this),stop:this._resizeStop.bind(this)}),a.length&&a.hasClass("ba-cheetah-lightbox-width-full")?(t.addClass("ba-cheetah-lightbox-width-full"),t.draggable("disable")):this._restorePosition()):e.show(),this._resize()},_delayedResize:function(){clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(this._resize.bind(this),250)},_resize:function(){var e=this._node.find(".bal-cheetah-lightbox"),t=parseInt(this._node.css("padding-top")),a=parseInt(this._node.css("padding-bottom")),i=parseInt(this._node.css("padding-left")),o=parseInt(this._node.css("padding-right")),h=e.height(),s=e.width(),n=l(window),a=n.height()-t-a,o=(n.width(),"0px");this._defaults.resizable?(s<600?e.addClass("ba-cheetah-lightbox-width-slim"):e.removeClass("ba-cheetah-lightbox-width-slim"),s<450?e.addClass("ba-cheetah-lightbox-width-micro"):e.removeClass("ba-cheetah-lightbox-width-micro"),this._resizeEditors()):(h<a&&(o="150px"),e.attr("style","").css("margin",o+" auto 0")),this.trigger("resized")},_resizeStart:function(){l("body").addClass("ba-cheetah-resizable-is-resizing"),l(".ba-cheetah-lightbox:visible").append('<div class="ba-cheetah-resizable-iframe-fix"></div>'),BACheetah._destroyOverlayEvents(),BACheetah._removeAllOverlays()},_resizeStop:function(e,t){var a=l(".ba-cheetah-lightbox-resizable:visible");parseInt(a.css("top"))<0&&a.css("top","0"),this._savePosition(),l("body").removeClass("ba-cheetah-resizable-is-resizing"),l(".ba-cheetah-resizable-iframe-fix").remove(),BACheetah._bindOverlayEvents()},_resizeClicked:function(){l(".ba-cheetah-lightbox-resizable").find(".ba-cheetah-lightbox-resize-toggle");this._node.find(".bal-cheetah-lightbox").hasClass("ba-cheetah-lightbox-width-full")?this._resizeExitFull():this._resizeEnterFull(),this._resize()},_resizeEnterFull:function(){var e=l(".ba-cheetah-lightbox-resizable"),t=e.find(".ba-cheetah-lightbox-resize-toggle");this._node.find(".bal-cheetah-lightbox");t.removeClass("fa-window-maximize").addClass("fa-window-minimize"),e.addClass("ba-cheetah-lightbox-width-full"),e.draggable("disable"),e.resizable("disable")},_resizeExitFull:function(){var e=l(".ba-cheetah-lightbox-resizable"),t=e.find(".ba-cheetah-lightbox-resize-toggle");this._node.find(".bal-cheetah-lightbox");t.removeClass("fa-window-minimize").addClass("fa-window-maximize"),e.removeClass("ba-cheetah-lightbox-width-full"),e.draggable("enable"),e.resizable("enable")},_resizeEditors:function(){l(".ba-cheetah-lightbox-resizable").each(function(){var e=l(this),t=e.find(".ba-cheetah-settings-fields").height(),e=e.find(".mce-edit-area > iframe, textarea.wp-editor-area, .ace_editor"),a=null;t<350&&(t=350),e.each(function(){(a=l(this)).hasClass("ace_editor")?(a.height(t-60),a.closest(".ba-cheetah-field").data("editor").resize()):a.closest(".mce-container-body").find(".mce-toolbar-grp .mce-toolbar.mce-last").is(":visible")?a.height(t-175):a.height(t-150)})})},_savePosition:function(){var e=this._node.find(".bal-cheetah-lightbox"),t={width:e.width(),height:e.height(),top:parseInt(e.css("top"))<0?"0px":e.css("top"),left:e.css("left")};e.closest(".ba-cheetah-ui-pinned").length||(BACheetahConfig.userSettings.lightbox=t,BACheetah.ajax({action:"save_lightbox_position",data:t}))},_restorePosition:function(){var e=this._node.find(".bal-cheetah-lightbox"),t=this._getPositionSettings();t?e.css(t):e.css({top:25,left:BACheetahConfig.isRtl?"-25":25})},_getPositionSettings:function(){var e=BACheetahConfig.userSettings.lightbox;if(!e)return!1;var t=window.innerHeight,a=parseInt(e.height),i=parseInt(e.top),o=parseInt(e.left),h=(parseInt(e.top),parseInt(e.width));return o+h+100>screen.width&&(e.left=screen.width-h-250),o<0&&(e.left=50),(t<a&&546<t||t<i+a)&&(t<a&&(e.height=t-50),e.top=0),e}}}(jQuery),function(a){BACheetahIconSelector={_content:null,_lightbox:null,_rendered:!1,_filterText:"",open:function(a){BACheetahIconSelector._rendered||BACheetahIconSelector._render(),null===BACheetahIconSelector._content?(BACheetahIconSelector._lightbox.open('<div class="ba-cheetah-lightbox-loading"></div>'),BACheetah.ajax({action:"render_icon_selector"},BACheetahIconSelector._getContentComplete)):BACheetahIconSelector._lightbox.open(),BACheetahIconSelector._lightbox.on("icon-selected",function(e,t){BACheetahIconSelector._lightbox.off("icon-selected"),BACheetahIconSelector._lightbox.close(),a(t)})},_render:function(){BACheetahIconSelector._lightbox=new BACheetahLightbox({className:"ba-cheetah-icon-selector"}),BACheetahIconSelector._rendered=!0,BACheetah.addHook("endEditingSession",function(){BACheetahIconSelector._lightbox.close()})},_getContentComplete:function(e){e=BACheetah._jsonParse(e);BACheetahIconSelector._content=e.html,BACheetahIconSelector._lightbox.setContent(e.html),a(".ba-cheetah-icons-filter-select").on("change",BACheetahIconSelector._filter),a(".ba-cheetah-icons-filter-text").on("keyup",BACheetahIconSelector._filter),a(".ba-cheetah-icons-list i").on("click",BACheetahIconSelector._select),a(".ba-cheetah-icon-selector-cancel").on("click",a.proxy(BACheetahIconSelector._lightbox.close,BACheetahIconSelector._lightbox))},_filter:function(){var e=a(".ba-cheetah-icons-filter-select").val(),t=a(".ba-cheetah-icons-filter-text").val();"all"==e?a(".ba-cheetah-icons-section").show():(a(".ba-cheetah-icons-section").hide(),a(".ba-cheetah-"+e).show()),""!==(BACheetahIconSelector._filterText=t)?a(".ba-cheetah-icons-list i").each(BACheetahIconSelector._filterIcon):a(".ba-cheetah-icons-list i").show()},_filterIcon:function(){var e=a(this);-1==e.attr("class").indexOf(BACheetahIconSelector._filterText)?e.hide():e.show()},_select:function(){var e=a(this).attr("class");BACheetahIconSelector._lightbox.trigger("icon-selected",e)}}}(jQuery),function(a){BACheetahStyleSheet=function(e){"object"==typeof e&&a.extend(this,e),this._createSheet()},BACheetahStyleSheet.prototype={id:null,_sheet:null,_sheetElement:null,updateRule:function(e,t,a){for(var i=this._sheet.cssRules||this._sheet.rules,o=null,h=0;h<i.length;h++)i[h].selectorText.toLowerCase().replace(/\s/g,"")==e.toLowerCase().replace(/\s/g,"")&&(o=i[h]);if(o)if("object"==typeof t)for(h in t)this.setProperty(o,h,t[h]);else this.setProperty(o,t,a);else this.addRule(e,t,a)},setProperty:function(e,t,a){var i="";e.style.setProperty?(-1<a.indexOf("!important")&&(i="important",a=a.replace("!important","").trim()),e.style.setProperty(t,a,i)):e.style[this._toCamelCase(t)]=a},addRule:function(e,t,a){var i="",o="";if("object"==typeof t)for(o in t)i+=o+":"+t[o]+";";else i=t+":"+a+";";this._sheet.insertRule?this._sheet.insertRule(e+" { "+i+" }",this._sheet.cssRules.length):this._sheet.addRule(e,i)},destroy:function(){this._sheetElement&&(this._sheetElement.remove(),this._sheetElement=null),this._sheet&&(this._sheet=null)},disable:function(){this._sheet.disabled=!0},enable:function(){this._sheet.disabled=!1},_createSheet:function(){var e=this.id?' id="'+this.id+'"':"",t=this.className?' class="'+this.className+'"':"";this._sheet||(this._sheetElement=a('<style type="text/css"'+e+t+"></style>"),a("body").append(this._sheetElement),this._sheet=this._sheetElement[0].sheet)},_toCamelCase:function(e){return e.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()})}}}(jQuery),function(x){BACheetah={preview:null,_actionsLightbox:null,_ajaxQueue:[],_ajaxRequest:null,_disabledModules:[],_disabledModulesFull:[],_colResizeData:null,_colResizing:!1,_contentClass:!1,_dragEnabled:!1,_dragging:!1,_dragInitialScrollTop:0,_exitUrl:null,_layout:null,_layoutQueue:[],_layoutSettingsCSSCache:null,_layoutSettingsCSSTimeout:null,_lightbox:null,_lightboxScrollbarTimeout:null,_loadedModuleAssets:[],_moduleHelpers:{},_multiplePhotoSelector:null,_newColParent:null,_newColPosition:0,_newColGroupParent:null,_newColGroupPosition:0,_newModuleParent:null,_newModulePosition:0,_newRowPosition:0,_selectedTemplateId:null,_selectedTemplateType:null,_selectedTemplateContentCentralId:0,_singlePhotoSelector:null,_singleVideoSelector:null,_multipleAudiosSelector:null,_codeDisabled:!1,_init:function(){BACheetah._initJQueryReadyFix(),BACheetah._initGlobalErrorHandling(),BACheetah._initPostLock(),BACheetah._initClassNames(),BACheetah._initMediaUploader(),BACheetah._initOverflowFix(),BACheetah._initScrollbars(),BACheetah._initLightboxes(),BACheetah._initDropTargets(),BACheetah._initSortables(),BACheetah._initStrings(),BACheetah._initTipTips(),BACheetah._initTinyMCE(),BACheetah._bindEvents(),BACheetah._bindOverlayEvents(),BACheetah._setupEmptyLayout(),BACheetah._highlightEmptyCols(),BACheetah._fillDisabledModules(),BACheetah.addHook("didInitUI",BACheetah._showTourOrTemplates.bind(BACheetah)),BACheetah.addHook("endEditingSession",BACheetah._doStats.bind(this)),BACheetah.triggerHook("init")},_initJQueryReadyFix:function(){BACheetahConfig.debug||(jQuery.fn.oldReady=jQuery.fn.ready,jQuery.fn.ready=function(e){return jQuery.fn.oldReady(function(){try{"function"==typeof e&&e(x)}catch(e){BACheetah.logError(e)}})})},_initGlobalErrorHandling:function(){BACheetahConfig.debug||(window.onerror=function(e,t,a,i,o){return BACheetah.logGlobalError(e,t,a,i,o),!0})},_initPostLock:function(){void 0!==wp.heartbeat&&(wp.heartbeat.interval(30),wp.heartbeat.enqueue("ba_cheetah_post_lock",{post_id:BACheetahConfig.postId}))},_initClassNames:function(){var e=x("html"),t=x("body");e.addClass("ba-cheetah-edit"),t.addClass("ba-cheetah"),BACheetahConfig.simpleUi&&t.addClass("ba-cheetah-simple"),BACheetah._contentClass=".ba-cheetah-content-"+BACheetahConfig.postId,x(BACheetah._contentClass).addClass("ba-cheetah-content-editing")},_initMediaUploader:function(){wp.media.model.settings.post.id=BACheetahConfig.postId},_initOverflowFix:function(){x(BACheetah._contentClass).parents().css("overflow","visible")},_initScrollbars:function(){var e=x(".ba-cheetah-nanoscroller").nanoScroller({alwaysVisible:!0,preventPageScrolling:!0,paneClass:"ba-cheetah-nanoscroller-pane",sliderClass:"ba-cheetah-nanoscroller-slider",contentClass:"ba-cheetah-nanoscroller-content"}).filter(".ba-cheetah-settings-fields"),t=e.find(".ba-cheetah-nanoscroller-pane");t.length&&(t=t.get(0).style.display,e=e.find(".ba-cheetah-nanoscroller-content"),"none"===t?e.removeClass("has-scrollbar"):e.addClass("has-scrollbar"))},_initSortables:function(){var e={appendTo:BACheetah._contentClass,cursor:"move",cursorAt:{left:85,top:20},distance:1,helper:BACheetah._blockDragHelper,start:BACheetah._blockDragStart,sort:BACheetah._blockDragSort,change:BACheetah._blockDragChange,stop:BACheetah._blockDragStop,placeholder:"ba-cheetah-drop-zone",tolerance:"intersect"},t="",a="",i="",i="row"==BACheetahConfig.userTemplateType?BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-content":"column"==BACheetahConfig.userTemplateType?BACheetah._contentClass+" .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-col-drop-target, "+BACheetah._contentClass+" .ba-cheetah-col-content":BACheetah._contentClass+" .ba-cheetah-row-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col:not(.ba-cheetah-node-loading):not(.ba-cheetah-node-global) .ba-cheetah-col-content",a="row"==BACheetahConfig.userTemplateType?BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target":BACheetah._contentClass+" .ba-cheetah-row-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target",t=BACheetahConfig.nestedColumns?i:"row"==BACheetahConfig.userTemplateType?BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target":BACheetah._contentClass+" .ba-cheetah-row-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-group-drop-target, "+BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-node-loading) .ba-cheetah-col-drop-target";x(".ba-cheetah-rows").sortable(x.extend({},e,{connectWith:t,items:".ba-cheetah-block-row",stop:BACheetah._rowDragStop})),x(".ba-cheetah-row-templates").sortable(x.extend({},e,{cancel:'.ba-cheetah-block-row-template[data-compatible="false"], .ba-cheetah-button, .ba-cheetah--template-incompatible',connectWith:BACheetah._contentClass+" .ba-cheetah-row-drop-target",items:".ba-cheetah-block-row-template:not(.ba-cheetah-block-disabled)",stop:BACheetah._nodeTemplateDragStop})),x(".ba-cheetah-saved-rows").sortable(x.extend({},e,{cancel:".ba-cheetah-node-template-actions, .ba-cheetah-node-template-edit, .ba-cheetah-node-template-delete",connectWith:BACheetah._contentClass+" .ba-cheetah-row-drop-target",items:".ba-cheetah-block-saved-row",stop:BACheetah._nodeTemplateDragStop})),x(".ba-cheetah-saved-columns").sortable(x.extend({},e,{cancel:".ba-cheetah-node-template-actions, .ba-cheetah-node-template-edit, .ba-cheetah-node-template-delete",connectWith:a,items:".ba-cheetah-block-saved-column",stop:BACheetah._nodeTemplateDragStop})),x(".ba-cheetah-modules, .ba-cheetah-widgets").sortable(x.extend({},e,{connectWith:i,items:".ba-cheetah-block-module:not(.ba-cheetah-block-disabled)",stop:BACheetah._moduleDragStop})),x(".ba-cheetah-module-templates").sortable(x.extend({},e,{connectWith:i,items:".ba-cheetah-block-module-template",stop:BACheetah._nodeTemplateDragStop})),x(".ba-cheetah-saved-modules").sortable(x.extend({},e,{cancel:".ba-cheetah-node-template-actions, .ba-cheetah-node-template-edit, .ba-cheetah-node-template-delete",connectWith:i,items:".ba-cheetah-block-saved-module",stop:BACheetah._nodeTemplateDragStop})),x(".ba-cheetah-row-sortable-proxy").sortable(x.extend({},e,{connectWith:BACheetah._contentClass+" .ba-cheetah-row-drop-target",helper:BACheetah._rowDragHelper,start:BACheetah._rowDragStart,stop:BACheetah._rowDragStop})),x(".ba-cheetah-col-sortable-proxy").sortable(x.extend({},e,{connectWith:i,helper:BACheetah._colDragHelper,start:BACheetah._colDragStart,stop:BACheetah._colDragStop})),x(BACheetah._contentClass+" .ba-cheetah-col-content").sortable(x.extend({},e,{connectWith:i,handle:".ba-cheetah-module-sortable-proxy",helper:BACheetah._moduleDragHelper,items:".ba-cheetah-module, .ba-cheetah-col-group",start:BACheetah._moduleDragStart,stop:BACheetah._moduleDragStop})),x(BACheetah._contentClass+" .ba-cheetah-row-drop-target").sortable(e),x(BACheetah._contentClass+" .ba-cheetah-col-group-drop-target").sortable(e),x(BACheetah._contentClass+" .ba-cheetah-col-drop-target").sortable(e)},_refreshSortables:function(){x(".ui-sortable").sortable("refresh")},_initStrings:function(){x.validator.messages.required=BACheetahStrings.validateRequiredMessage},_fillDisabledModules:function(){var e=BACheetahConfig.contentItems.builderall,t=Object.keys(e),a=BACheetahConfig.contentItems.pro,i=Object.keys(a);if(BACheetahConfig.isBuilderallUser){if(!BACheetahConfig.isProUser)for(var o in a)-1===x.inArray(o,t)&&(BACheetah._disabledModules.push(o),BACheetah._disabledModulesFull[o]=a[o])}else if(BACheetahConfig.isProUser)for(var o in e)-1===x.inArray(o,i)&&(BACheetah._disabledModules.push(o),BACheetah._disabledModulesFull[o]=e[o]);else for(var o in BACheetah._disabledModules=t,BACheetah._disabledModulesFull=e,a)-1===x.inArray(o,BACheetah._disabledModules)&&(BACheetah._disabledModules.push(o),BACheetah._disabledModulesFull[o]=a[o])},_bindEvents:function(){var e=BACheetahLayout._isTouch();$excludedLinks=x(".ba-cheetah-bar a, .ba-cheetah--content-library-panel a, .ba-cheetah-page-nav .nav a"),x("a").not($excludedLinks).on("click",BACheetah._preventDefault),x(".ba-cheetah-page-nav .nav a").on("click",BACheetah._headerLinkClicked),x("body").delegate(".ba-cheetah-content a","click",BACheetah._preventDefault),x("body").delegate("button.ba-cheetah-button","mouseup",this._buttonMouseUp.bind(this)),x(document).on("heartbeat-tick",BACheetah._initPostLock),x(window).on("beforeunload",BACheetah._warnBeforeUnload),x("body").delegate(".ba-cheetah-has-submenu","click touchend",BACheetah._submenuParentClicked),x("body").delegate(".ba-cheetah-has-submenu a","click touchend",BACheetah._submenuChildClicked),x("body").delegate(".ba-cheetah-submenu","mouseenter",BACheetah._submenuMouseenter),x("body").delegate(".ba-cheetah-submenu","mouseleave",BACheetah._submenuMouseleave),x("body").delegate(".ba-cheetah-submenu .ba-cheetah-has-submenu","mouseenter",BACheetah._submenuNestedParentMouseenter),x(".ba-cheetah-panel-actions .ba-cheetah-panel-close").on("click",BACheetah._closePanel),x(".ba-cheetah-blocks-section-title").on("click",BACheetah._blockSectionTitleClicked),x("body").delegate(".ba-cheetah-node-template-actions","mousedown",BACheetah._stopPropagation),x("body").delegate(".ba-cheetah-node-template-edit","mousedown",BACheetah._stopPropagation),x("body").delegate(".ba-cheetah-node-template-delete","mousedown",BACheetah._stopPropagation),x("body").delegate(".ba-cheetah-node-template-edit","click",BACheetah._editNodeTemplateClicked),x("body").delegate(".ba-cheetah-node-template-delete","click",BACheetah._deleteNodeTemplateClicked),x("body").delegate(".ba-cheetah-block:not(.ba-cheetah-block-disabled)","mousedown",BACheetah._blockDragInit),x("body").on("mouseup",BACheetah._blockDragCancel),x("body").delegate(".ba-cheetah-actions .ba-cheetah-cancel-button","click",BACheetah._cancelButtonClicked),x("body").delegate(".ba-cheetah-save-user-template-button","click",BACheetah._saveUserTemplateClicked),x("body").delegate(".ba-cheetah-duplicate-layout-button","click",BACheetah._duplicateLayoutClicked),x("body").delegate(".ba-cheetah-layout-settings-button","click",BACheetah._layoutSettingsClicked),x("body").delegate(".ba-cheetah-layout-settings .ba-cheetah-settings-save","click",BACheetah._saveLayoutSettingsClicked),x("body").delegate(".ba-cheetah-layout-settings .ba-cheetah-settings-cancel","click",BACheetah._cancelLayoutSettingsClicked),x("body").delegate(".ba-cheetah-global-settings-button","click",BACheetah._globalSettingsClicked),x("body").delegate(".ba-cheetah-set-page-template-button","click",BACheetah._pageSettingsClicked),x("body").delegate(".ba-cheetah-global-settings .ba-cheetah-settings-save","click",BACheetah._saveGlobalSettingsClicked),x("body").delegate(".ba-cheetah-page-settings .ba-cheetah-settings-save","click",BACheetah._savePageSettingsClicked),x("body").delegate(".ba-cheetah-global-settings .ba-cheetah-settings-cancel","click",BACheetah._cancelLayoutSettingsClicked),x("body").delegate(".ba-cheetah-user-template","click",BACheetah._userTemplateClicked),x("body").delegate(".ba-cheetah-user-template-edit","click",BACheetah._editUserTemplateClicked),x("body").delegate(".ba-cheetah-user-template-delete","click",BACheetah._deleteUserTemplateClicked),x("body").delegate(".ba-cheetah-template-replace-button","click",BACheetah._templateReplaceClicked),x("body").delegate(".ba-cheetah-template-append-button","click",BACheetah._templateAppendClicked),x("body").delegate(".ba-cheetah-template-actions .ba-cheetah-cancel-button","click",BACheetah._templateCancelClicked),x("body").delegate(".ba-cheetah-user-template-settings .ba-cheetah-settings-save","click",BACheetah._saveUserTemplateSettings),x("body").delegate(".ba-cheetah-help-tour-button","click",BACheetah._startHelpTour),x("body").delegate(".ba-cheetah-knowledge-base-button","click",BACheetah._viewKnowledgeBaseClicked),x("body").delegate(".ba-cheetah-forums-button","click",BACheetah._visitForumsClicked),x("body").delegate(".ba-cheetah-alert-close","click",BACheetah._alertClose),x("body").delegate(".ba-cheetah-feedback-close","click",BACheetah._closeFeedback),x("body").delegate(".ba-cheetah-block-overlay","contextmenu",BACheetah._onContextmenu),x("body").delegate(".ba-cheetah-row-overlay .ba-cheetah-block-remove","click touchend",BACheetah._deleteRowClicked),x("body").delegate(".ba-cheetah-row-overlay .ba-cheetah-block-copy","click touchend",BACheetah._rowCopyClicked),x("body").delegate(".ba-cheetah-row-overlay .ba-cheetah-block-move","mousedown",BACheetah._rowDragInit),x("body").delegate(".ba-cheetah-row-overlay .ba-cheetah-block-move","touchstart",BACheetah._rowDragInitTouch),x("body").delegate(".ba-cheetah-row-overlay .ba-cheetah-block-settings","click touchend",BACheetah._rowSettingsClicked),x("body").delegate(".ba-cheetah-row-settings .ba-cheetah-settings-save","click",BACheetah._saveSettings),e?x("body").delegate(".ba-cheetah-row-overlay","touchend",BACheetah._rowSettingsClicked):x("body").delegate(".ba-cheetah-row-overlay","click",BACheetah._rowSettingsClicked),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-row-reset","click touchend",BACheetah._resetRowWidthClicked),x("body").delegate(".ba-cheetah-col-overlay .ba-cheetah-block-move","mousedown",BACheetah._colDragInit),x("body").delegate(".ba-cheetah-col-overlay .ba-cheetah-block-move","touchstart",BACheetah._colDragInitTouch),x("body").delegate(".ba-cheetah-block-col-copy","click touchend",BACheetah._copyColClicked),x("body").delegate(".ba-cheetah-col-overlay .ba-cheetah-block-remove","click touchend",BACheetah._deleteColClicked),x("body").delegate(".ba-cheetah-col-overlay .ba-cheetah-block-settings","click touchend",BACheetah._colSettingsClicked),x("body").delegate(".ba-cheetah-col-settings .ba-cheetah-settings-save","click",BACheetah._saveSettings),e?x("body").delegate(".ba-cheetah-col-overlay","touchend",BACheetah._colSettingsClicked):x("body").delegate(".ba-cheetah-col-overlay","click",BACheetah._colSettingsClicked),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-move","mousedown",BACheetah._colDragInit),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-move","touchstart",BACheetah._colDragInitTouch),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-edit","click touchend",BACheetah._colSettingsClicked),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-delete","click touchend",BACheetah._deleteColClicked),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-reset","click touchend",BACheetah._resetColumnWidthsClicked),x("body").delegate(".ba-cheetah-block-col-submenu li","mouseenter",BACheetah._showColHighlightGuide),x("body").delegate(".ba-cheetah-block-col-submenu li","mouseleave",BACheetah._removeColHighlightGuides),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-move-parent","mousedown",BACheetah._colDragInit),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-move-parent","touchstart",BACheetah._colDragInitTouch),x("body").delegate(".ba-cheetah-block-col-submenu .ba-cheetah-block-col-edit-parent","click touchend",BACheetah._colSettingsClicked),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-remove","click touchend",BACheetah._deleteModuleClicked),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-copy","click touchend",BACheetah._moduleCopyClicked),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-move","mousedown",BACheetah._moduleDragInit),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-move","touchstart",BACheetah._moduleDragInitTouch),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-settings","click touchend",BACheetah._moduleSettingsClicked),x("body").delegate(".ba-cheetah-module-settings .ba-cheetah-settings-save","click",BACheetah._saveModuleClicked),x("body").delegate(".ba-cheetah-module-overlay .ba-cheetah-block-col-settings","click touchend",BACheetah._colSettingsClicked),e?x("body").delegate(".ba-cheetah-module-overlay","touchend",BACheetah._moduleSettingsClicked):x("body").delegate(".ba-cheetah-module-overlay","click",BACheetah._moduleSettingsClicked),x("body").delegate(".ba-cheetah-settings-save-as","click",BACheetah._showNodeTemplateSettings),x("body").delegate(".ba-cheetah-node-template-settings .ba-cheetah-settings-save","click",BACheetah._saveNodeTemplate),x("body").delegate(".ba-cheetah-content-panel-saved-view .ba-cheetah-settings-section-header","click",BACheetah._collapseSavedTemplates),x("body").delegate(".ba-cheetah-settings-tabs a","click",BACheetah._settingsTabClicked),x("body").delegate(".ba-cheetah-settings-tabs a","show",BACheetah._calculateSettingsTabsOverflow),x("body").delegate(".ba-cheetah-settings-tabs a","hide",BACheetah._calculateSettingsTabsOverflow),x("body").delegate(".ba-cheetah-settings-cancel","click",BACheetah._settingsCancelClicked),x("body").delegate(".ba-cheetah-settings-tabs-overflow-menu > a","click",BACheetah._settingsTabsToOverflowMenuItemClicked.bind(this)),x("body").delegate(".ba-cheetah-settings-tabs-more","click",BACheetah._toggleTabsOverflowMenu.bind(this)),x("body").delegate(".ba-cheetah-settings-tabs-overflow-click-mask","click",BACheetah._hideTabsOverflowMenu.bind(this)),x("body").delegate(".ba-cheetah-field-add","click",BACheetah._addFieldClicked),x("body").delegate(".ba-cheetah-field-copy","click",BACheetah._copyFieldClicked),x("body").delegate(".ba-cheetah-field-delete","click",BACheetah._deleteFieldClicked),x("body").delegate(".ba-cheetah-photo-field .ba-cheetah-photo-select","click",BACheetah._selectSinglePhoto),x("body").delegate(".ba-cheetah-photo-field .ba-cheetah-photo-edit","click",BACheetah._selectSinglePhoto),x("body").delegate(".ba-cheetah-photo-field .ba-cheetah-photo-replace","click",BACheetah._selectSinglePhoto),x("body").delegate(".ba-cheetah-photo-field .ba-cheetah-photo-remove","click",BACheetah._singlePhotoRemoved),x("body").delegate(".ba-cheetah-multiple-photos-field .ba-cheetah-multiple-photos-select","click",BACheetah._selectMultiplePhotos),x("body").delegate(".ba-cheetah-multiple-photos-field .ba-cheetah-multiple-photos-edit","click",BACheetah._selectMultiplePhotos),x("body").delegate(".ba-cheetah-multiple-photos-field .ba-cheetah-multiple-photos-add","click",BACheetah._selectMultiplePhotos),x("body").delegate(".ba-cheetah-video-field .ba-cheetah-video-select","click",BACheetah._selectSingleVideo),x("body").delegate(".ba-cheetah-video-field .ba-cheetah-video-replace","click",BACheetah._selectSingleVideo),x("body").delegate(".ba-cheetah-video-field .ba-cheetah-video-remove","click",BACheetah._singleVideoRemoved),x("body").delegate(".ba-cheetah-multiple-audios-field .ba-cheetah-multiple-audios-select","click",BACheetah._selectMultipleAudios),x("body").delegate(".ba-cheetah-multiple-audios-field .ba-cheetah-multiple-audios-edit","click",BACheetah._selectMultipleAudios),x("body").delegate(".ba-cheetah-multiple-audios-field .ba-cheetah-multiple-audios-add","click",BACheetah._selectMultipleAudios),x("body").delegate(".ba-cheetah-icon-field .ba-cheetah-icon-select","click",BACheetah._selectIcon),x("body").delegate(".ba-cheetah-icon-field .ba-cheetah-icon-replace","click",BACheetah._selectIcon),x("body").delegate(".ba-cheetah-icon-field .ba-cheetah-icon-remove","click",BACheetah._removeIcon),x("body").delegate(".ba-cheetah-form-field .ba-cheetah-form-field-edit","click",BACheetah._formFieldClicked),x("body").delegate(".ba-cheetah-form-field-settings .ba-cheetah-settings-save","click",BACheetah._saveFormFieldClicked),x("body").delegate(".ba-cheetah-layout-field-option","click",BACheetah._layoutFieldClicked),x("body").delegate(".ba-cheetah-link-field-select","click",BACheetah._linkFieldSelectClicked),x("body").delegate(".ba-cheetah-link-field-search-cancel","click",BACheetah._linkFieldSelectCancelClicked),x("body").delegate(".ba-cheetah-custom-query select[name=post_type]","change",BACheetah._customQueryPostTypeChange),x("body").delegate(".ba-cheetah-text-field-add-value","change",BACheetah._textFieldAddValueSelectChange),x("body").delegate(".ba-cheetah-field input[type=number]","focus",BACheetah._onNumberFieldFocus),x("body").delegate(".ba-cheetah-field input[type=number]","blur",BACheetah._onNumberFieldBlur),BACheetah.addHook("didCompleteAJAX",BACheetah._refreshSettingsPreviewReference),BACheetah.addHook("didRenderLayoutComplete",BACheetah._refreshSettingsPreviewReference)},_unbindEvents:function(){x("a").off("click",BACheetah._preventDefault),x(".ba-cheetah-page-nav .nav a").off("click",BACheetah._headerLinkClicked),x("body").undelegate(".ba-cheetah-content a","click",BACheetah._preventDefault)},_rebindEvents:function(){x("a").on("click",BACheetah._preventDefault),x(".ba-cheetah-page-nav .nav a").on("click",BACheetah._headerLinkClicked),x("body").delegate(".ba-cheetah-content a","click",BACheetah._preventDefault)},_bindOverlayEvents:function(){var e=x(BACheetah._contentClass);e.delegate(".ba-cheetah-row","mouseenter touchstart",BACheetah._rowMouseenter),e.delegate(".ba-cheetah-row","mouseleave",BACheetah._rowMouseleave),e.delegate(".ba-cheetah-col","mouseenter touchstart",BACheetah._colMouseenter),e.delegate(".ba-cheetah-col","mouseleave",BACheetah._colMouseleave),e.delegate(".ba-cheetah-module","mouseenter touchstart",BACheetah._moduleMouseenter),e.delegate(".ba-cheetah-row-type-row-inside .ba-cheetah-module","mousemove touchstart",BACheetah._moduleMouseenter),e.delegate(".ba-cheetah-module","mouseleave",BACheetah._moduleMouseleave)},_destroyOverlayEvents:function(){var e=x(BACheetah._contentClass);e.undelegate(".ba-cheetah-row","mouseenter touchstart",BACheetah._rowMouseenter),e.undelegate(".ba-cheetah-row","mouseleave",BACheetah._rowMouseleave),e.undelegate(".ba-cheetah-col","mouseenter touchstart",BACheetah._colMouseenter),e.undelegate(".ba-cheetah-col","mouseleave",BACheetah._colMouseleave),e.undelegate(".ba-cheetah-module","mouseenter touchstart mousemove",BACheetah._moduleMouseenter),e.undelegate(".ba-cheetah-module","mouseleave",BACheetah._moduleMouseleave)},_onContextmenu:function(e){x(this).hide()},_preventDefault:function(e){e.preventDefault()},_stopPropagation:function(e){e.stopPropagation()},_headerLinkClicked:function(e){var t=x(this).attr("href");this.hash||(e.preventDefault(),BACheetahConfig.isUserTemplate||(BACheetah._exitUrl=-1<t.indexOf("?")?t:t+"?ba_builder",BACheetah.triggerHook("triggerDone")))},_warnBeforeUnload:function(){var e=0<x(".ba-cheetah-row-settings").length,t=0<x(".ba-cheetah-col-settings").length,a=0<x(".ba-cheetah-module-settings").length;if(e||t||a)return BACheetahStrings.unloadWarning},_proClicked:function(){window.open(BACheetahConfig.landingpageUrl)},_upgradeClicked:function(){window.open(BACheetahConfig.upgradeUrl)},_showProMessage:function(e){var t=new BACheetahLightbox({className:"ba-cheetah-pro-lightbox",destroyOnClose:!0}),a=wp.template("ba-cheetah-pro-lightbox");t.open(a({feature:e}))},_showFeedbackMessage:function(){var e=new BACheetahLightbox({className:"ba-cheetah-feedback-alert",destroyOnClose:!1}),t=wp.template("ba-cheetah-feedback-alert");e.open(t())},_initTipTips:function(){var e=x(".ba-cheetah-tip:not(.ba-cheetah-has-tip)");e.each(function(){var e=x(this);e.addClass("ba-cheetah-has-tip"),null==e.attr("data-title")&&e.attr("data-title",e.attr("title"))}),BACheetahLayout._isTouch()||e.tipTip({defaultPosition:"top",delay:300,maxWidth:"auto"})},_hideTipTips:function(){x("#tiptip_holder").stop().hide()},_submenuParentClicked:function(e){var t=x("body"),a=x(this),i=a.find(".ba-cheetah-submenu");a.hasClass("ba-cheetah-submenu-open")?(t.removeClass("ba-cheetah-submenu-open"),a.removeClass("ba-cheetah-submenu-open"),a.removeClass("ba-cheetah-submenu-right")):(a.offset().left+i.width()>x(window).width()&&a.addClass("ba-cheetah-submenu-right"),t.addClass("ba-cheetah-submenu-open"),a.addClass("ba-cheetah-submenu-open")),i.closest(".ba-cheetah-row-overlay").addClass("ba-cheetah-row-menu-active"),BACheetah._hideTipTips(),e.preventDefault(),e.stopPropagation()},_submenuChildClicked:function(e){var t=x("body"),a=x(this).parents(".ba-cheetah-has-submenu");a.parents(".ba-cheetah-has-submenu").length||(t.removeClass("ba-cheetah-submenu-open"),a.removeClass("ba-cheetah-submenu-open"))},_submenuMouseenter:function(e){var t=x(this).data("timeout");void 0!==t&&clearTimeout(t)},_submenuMouseleave:function(e){var t=x("body"),a=x(this),i=setTimeout(function(){t.removeClass("ba-cheetah-submenu-open"),a.closest(".ba-cheetah-has-submenu").removeClass("ba-cheetah-submenu-open z-index-up")},500);a.closest(".ba-cheetah-row-overlay").removeClass("ba-cheetah-row-menu-active"),a.data("timeout",i)},_submenuNestedParentMouseenter:function(e){var t=x(this),a=t.find(".ba-cheetah-submenu");t.width()+t.offset().left+a.width()>x(window).width()&&t.addClass("ba-cheetah-submenu-right")},_closeAllSubmenus:function(){x(".ba-cheetah-submenu-open").removeClass("ba-cheetah-submenu-open")},_buttonMouseUp:function(e){x(e.currentTarget).blur()},_closePanel:function(){BACheetah.triggerHook("hideContentPanel")},_showPanel:function(){BACheetah.triggerHook("showContentPanel")},_togglePanel:function(){BACheetah.triggerHook("toggleContentPanel")},_blockSectionTitleClicked:function(){var e=x(this).parent();e.hasClass("ba-cheetah-active")?e.removeClass("ba-cheetah-active"):(x(".ba-cheetah-blocks-section").removeClass("ba-cheetah-active"),e.addClass("ba-cheetah-active")),BACheetah._initScrollbars()},_publishLayout:function(e,t){BACheetah._triggerSettingsSave(t,!0)&&(_.isUndefined(e)&&(e=!0),BACheetah.ajax({action:"save_layout",publish:!0,exit:e?1:0},this._onPublishComplete.bind(this,e)))},_publishButtonClicked:function(e){BACheetah._publishLayout(e)},_onPublishComplete:function(e){e&&(BACheetahConfig.shouldRefreshOnPublish?BACheetah._exit():BACheetah._exitWithoutRefresh()),x("#wp-admin-bar-ba-cheetah-frontend-edit-link .ba-cheetah-admin-bar-status-dot").css("color","#6bc373"),BACheetah.triggerHook("didPublishLayout",{shouldExit:e}),"page"!=BACheetahConfig.postType&&"post"!=BACheetahConfig.postType||BACheetah._displaySurvey()||BACheetah._exit()},_displaySurvey:function(){let e=!1,t=localStorage.getItem("_ba_cheetah_feedback_expires"),a=new Date;var i;return t?"forever"==t?e=!1:(t=new Date(parseInt(t)),console.log(t,a),t<a&&(e=!0)):e=!0,e&&(i=a.setDate(a.getDate()+60),localStorage.setItem("_ba_cheetah_feedback_expires",i),BACheetah._showFeedbackMessage()),e},_closeFeedback:function(){x(".ba-cheetah-feedback-alert #ba-cheetah-feedback").prop("checked")&&localStorage.setItem("_ba_cheetah_feedback_expires","forever"),setTimeout(function(){BACheetah._exit()},1e3)},_draftButtonClicked:function(){BACheetah.showAjaxLoader(),BACheetah.ajax({action:"save_draft"},BACheetah._exit)},_discardButtonClicked:function(){confirm(BACheetahStrings.discardMessage)?(BACheetah.showAjaxLoader(),BACheetah.ajax({action:"clear_draft_layout"},function(){BACheetah.triggerHook("didDiscardChanges"),BACheetah._exit()})):BACheetah.triggerHook("didCancelDiscard")},_cancelButtonClicked:function(){BACheetah._exitUrl=null,BACheetah._actionsLightbox.close()},_exit:function(){var e=window.location.href;try{var t=void 0!==window.opener.BACheetah}catch(e){t=!1}BACheetahConfig.isUserTemplate&&void 0!==window.opener&&window.opener?(t&&("undefined"==typeof BACheetahGlobalNodeId?window.opener.BACheetah._updateLayout():window.opener.BACheetah._updateNode(BACheetahGlobalNodeId)),window.close()):(e=BACheetah._exitUrl||(e=(e=(e=(e=(e=e.replace("?ba_cheetah&","?")).replace("?ba_cheetah","")).replace("&ba_cheetah","")).replace("?ba_builder&","?")).replace("?ba_builder","")).replace("&ba_builder",""),window.location.href=e)},_exitWithoutRefresh:function(){window.location.href;try{var t=void 0!==window.opener.BACheetah}catch(e){t=!1}BACheetahConfig.isUserTemplate&&t&&window.opener?(t&&("undefined"==typeof BACheetahGlobalNodeId?window.opener.BACheetah._updateLayout():window.opener.BACheetah._updateNode(BACheetahGlobalNodeId)),window.close()):BACheetah.triggerHook("endEditingSession")},_duplicateLayoutClicked:function(){BACheetah.showAjaxLoader(),BACheetah.ajax({action:"duplicate_post"},BACheetah._duplicateLayoutComplete)},_duplicateLayoutComplete:function(e){var t=BACheetahConfig.adminUrl;window.location.href=t+"post.php?post="+e+"&action=edit"},_layoutSettingsClicked:function(){BACheetahSettingsForms.render({id:"layout",className:"ba-cheetah-layout-settings",settings:BACheetahSettingsConfig.settings.layout},function(){BACheetah._layoutSettingsInitCSS()})},_layoutSettingsInitCSS:function(){var e=x(".ba-cheetah-settings #ba-cheetah-field-css textarea:not(.ace_text-input)");e.on("change",BACheetah._layoutSettingsCSSChanged),BACheetah._layoutSettingsCSSCache=e.val()},_layoutSettingsCSSChanged:function(){BACheetah._layoutSettingsCSSTimeout&&clearTimeout(BACheetah._layoutSettingsCSSTimeout),BACheetah._layoutSettingsCSSTimeout=setTimeout(x.proxy(BACheetah._layoutSettingsCSSDoChange,this),600)},_layoutSettingsCSSDoChange:function(){var e=x(".ba-cheetah-settings"),t=x(this);0<t.parents("#ba-cheetah-field-css").find(".ace_error").length||((e.hasClass("ba-cheetah-layout-settings")?x("#ba-cheetah-layout-css"):x("#ba-cheetah-global-css")).html(t.val()),BACheetah._layoutSettingsCSSTimeout=null)},_saveLayoutSettingsClicked:function(){for(var e=x(this).closest(".ba-cheetah-settings").serializeArray(),t={},a=0;a<e.length;a++)t[e[a].name]=e[a].value;BACheetah.showAjaxLoader(),BACheetah._lightbox.close(),BACheetah._layoutSettingsCSSCache=null,BACheetah.ajax({action:"save_layout_settings",settings:t},function(){BACheetah.triggerHook("didSaveLayoutSettingsComplete",t),BACheetah._updateLayout()})},_cancelLayoutSettingsClicked:function(){(x(".ba-cheetah-settings").hasClass("ba-cheetah-layout-settings")?x("#ba-cheetah-layout-css"):x("#ba-cheetah-global-css")).html(BACheetah._layoutSettingsCSSCache),BACheetah._layoutSettingsCSSCache=null},_globalSettingsClicked:function(){BACheetahSettingsForms.render({id:"global",className:"ba-cheetah-global-settings",settings:BACheetahSettingsConfig.settings.global},function(){BACheetah.preview=new BACheetahPreview({type:"global"}),BACheetah._layoutSettingsInitCSS()})},_pageSettingsClicked:function(){BACheetahSettingsForms.render({id:"page",className:"ba-cheetah-page-settings",settings:BACheetahSettingsConfig.settings.page},function(){BACheetah.preview=new BACheetahPreview({type:"page"}),BACheetah._initLayoutPartsSelect(),BACheetah._layoutSettingsInitCSS()})},_initLayoutPartsSelect:function(){BACheetah.getSelectOptions("get_popups","popup"),BACheetah.getSelectOptions("get_headers_for_select","ba-cheetah-custom-header-id"),BACheetah.getSelectOptions("get_footers_for_select","ba-cheetah-custom-footer-id")},_savePageSettingsClicked:function(){const e=x(this).closest(".ba-cheetah-settings"),t=e.validate().form(),a=BACheetah._getSettings(e),i=BACheetah._getOriginalSettings(e);const o=["layout","ba-cheetah-custom-footer-id","ba-cheetah-custom-header-id","ba-cheetah-footer-option","ba-cheetah-header-option"].some(e=>a[e]!=i[e]);o&&!confirm(BACheetahStrings.confirmLayoutSave)||t&&(BACheetah.showAjaxLoader(),BACheetah._layoutSettingsCSSCache=null,BACheetahSettingsConfig.settings.page=a,BACheetah.ajax({action:"save_page_settings",settings:a},function(){BACheetah._savePageSettingsComplete(o)}),BACheetah._lightbox.close())},_saveGlobalSettingsClicked:function(){var e=x(this).closest(".ba-cheetah-settings"),t=e.validate().form(),e=BACheetah._getSettings(e);t&&(BACheetah.showAjaxLoader(),BACheetah._layoutSettingsCSSCache=null,BACheetah.ajax({action:"save_global_settings",settings:e},BACheetah._saveGlobalSettingsComplete),BACheetah._lightbox.close())},_saveGlobalSettingsComplete:function(e){BACheetah.triggerHook("didSaveGlobalSettingsComplete",BACheetah._jsonParse(e)),BACheetah._updateLayout()},_savePageSettingsComplete:function(e=!1){e&&location.reload()},_initTemplateSelector:function(){0<x(BACheetah._contentClass).find(".ba-cheetah-row").length||BACheetah.ContentPanel.show("modules")},_confirmReplaceTemplate(e){const t=new BACheetahLightbox({className:"ba-cheetah-lightbox-confirm-icon",destroyOnClose:!0}),a=wp.template("ba-cheetah-lightbox-confirm-icon");t.open(a({message:BACheetahStrings.changeTemplateMessage,title:BACheetahStrings.areYouSure,icon:"important-warning.svg",cancelable:!0})),t._node.find(".ba-cheetah-alert-confirm").on("click",e)},_requestTemplateInsert:function(e,t,a){BACheetah.layoutHasContent()?0==e?BACheetah._confirmReplaceTemplate(function(){BACheetah._lightbox._node.hide(),BACheetah._applyTemplate(0,!1,t,a)}):(BACheetah._selectedTemplateId=e,BACheetah._selectedTemplateType=t,BACheetah._selectedTemplateContentCentralId=a,BACheetah._showTemplateActions(),BACheetah._lightbox._node.hide()):BACheetah._applyTemplate(e,!1,t,a)},_showTemplateActions:function(){var e=[];e[10]={key:"template-replace",label:BACheetahStrings.templateReplace},e[20]={key:"template-append",label:BACheetahStrings.templateAppend},BACheetah._showActionsLightbox({className:"ba-cheetah-template-actions",title:BACheetahStrings.actionsLightboxTitle,buttons:e})},_templateReplaceClicked:function(){BACheetah._confirmReplaceTemplate(function(){BACheetah._actionsLightbox.close(),BACheetah._applyTemplate(BACheetah._selectedTemplateId,!1,BACheetah._selectedTemplateType,BACheetah._selectedTemplateContentCentralId)})},_templateAppendClicked:function(){BACheetah._actionsLightbox.close(),BACheetah._applyTemplate(BACheetah._selectedTemplateId,!0,BACheetah._selectedTemplateType,BACheetah._selectedTemplateContentCentralId)},_templateCancelClicked:function(){BACheetah.triggerHook("showContentPanel")},_applyTemplate:function(e,t,a,i=0){t=void 0!==t&&t?"1":"0",a=void 0===a?"core":a,BACheetah._lightbox.close(),BACheetah.showAjaxLoader(),"core"==a?BACheetah.ajax({action:"apply_template",template_id:e,append:t,content_central_id:i},BACheetah._applyTemplateComplete):BACheetah.ajax({action:"apply_user_template",template_id:e,append:t},BACheetah._applyUserTemplateComplete),BACheetah.triggerHook("didApplyTemplate")},_applyTemplateComplete:function(e){e=BACheetah._jsonParse(e);BACheetah._hasBaCheetahError(e)?BACheetah.hideAjaxLoader():(BACheetah._renderLayout(e.layout),BACheetah.triggerHook("didApplyTemplateComplete",e.config))},_applyUserTemplateComplete:function(e){e=BACheetah._jsonParse(e);null!==e.layout_css&&x("#ba-cheetah-layout-css").html(e.layout_css),BACheetah._renderLayout(e.layout),BACheetah.triggerHook("didApplyTemplateComplete",e.config)},_saveUserTemplateClicked:function(){BACheetahSettingsForms.render({id:"user_template",className:"ba-cheetah-user-template-settings",rules:{name:{required:!0}}})},_saveUserTemplateSettings:function(){var e=x(this).closest(".ba-cheetah-settings"),t=e.validate().form(),e=BACheetah._getSettings(e);t&&(BACheetah.ajax({action:"save_user_template",settings:e},BACheetah._saveUserTemplateSettingsComplete),BACheetah._lightbox.close())},_saveUserTemplateSettingsComplete:function(e){e&&(e=BACheetah._jsonParse(e),BACheetahConfig.contentItems.template.push(e),BACheetah.triggerHook("contentItemsChanged"))},_userTemplateClicked:function(){var e=x(this).attr("data-id");0<x(BACheetah._contentClass).children(".ba-cheetah-row").length?"blank"==e?BACheetah._confirmReplaceTemplate(function(){BACheetah._lightbox._node.hide(),BACheetah._applyTemplate("blank",!1,"user")}):(BACheetah._selectedTemplateId=e,BACheetah._selectedTemplateType="user",BACheetah._showTemplateActions(),BACheetah._lightbox._node.hide()):BACheetah._applyTemplate(e,!1,"user")},_editUserTemplateClicked:function(e){e.preventDefault(),e.stopPropagation(),window.open(x(this).attr("href"))},_deleteUserTemplateClicked:function(e){var t=x(this).closest(".ba-cheetah-user-template").attr("data-id"),a=(x(".ba-cheetah-user-template[data-id="+t+"]"),null),i=null;if(confirm(BACheetahStrings.deleteTemplate)){for(i in BACheetah.ajax({action:"delete_user_template",template_id:t}),BACheetahConfig.contentItems.template)BACheetahConfig.contentItems.template[i].postId==t&&(a=i);_.isNull(a)||(BACheetahConfig.contentItems.template.splice(a,1),BACheetah.triggerHook("contentItemsChanged"))}e.stopPropagation()},_viewKnowledgeBaseClicked:function(){window.open(BACheetahConfig.help.knowledge_base_url)},_visitForumsClicked:function(){window.open(BACheetahConfig.help.forums_url)},_showTourOrTemplates:function(){BACheetahConfig.simpleUi||BACheetahConfig.isUserTemplate||(BACheetah._initTemplateSelector(),BACheetahConfig.help.tour&&BACheetahConfig.newUser&&BACheetah._showTourLightbox())},_doStats:function(){1==BACheetahConfig.statsEnabled&&(args={"screen-width":screen.width,"screen-height":screen.height,"pixel-ratio":window.devicePixelRatio,"user-agent":window.navigator.userAgent,isrtl:BACheetahConfig.isRtl},BACheetah.ajax({action:"save_browser_stats",browser_data:args}))},_showTourLightbox:function(){const e=new BACheetahLightbox({className:"ba-cheetah-lightbox-confirm-icon",destroyOnClose:!0});template=wp.template("ba-cheetah-lightbox-confirm-icon"),e.open(template({message:BACheetahStrings.welcomeMessage,title:BACheetahStrings.welcome,icon:"welcome.svg",confirmText:BACheetahStrings.start,cancelable:!1})),e._node.find(".ba-cheetah-alert-confirm").on("click",BACheetahTour.start)},_startHelpTour:function(){BACheetah._actionsLightbox.close(),BACheetahTour.start()},_setupEmptyLayout:function(){var e=x(BACheetah._contentClass);BACheetahConfig.isUserTemplate&&"module"==BACheetahConfig.userTemplateType||BACheetahConfig.isUserTemplate&&"column"==BACheetahConfig.userTemplateType||(e.removeClass("ba-cheetah-empty"),e.find(".ba-cheetah-empty-message").remove(),e.find(".ba-cheetah-row, .ba-cheetah-block").length||(e.addClass("ba-cheetah-empty"),e.append('<span class="ba-cheetah-empty-message">'+BACheetahStrings.emptyMessage+"</span>"),BACheetah._initSortables()))},_updateNode:function(e,t){x(".ba-cheetah-node-"+e).length&&(BACheetah._showNodeLoading(e),BACheetah.ajax({action:"render_node",node_id:e},function(e){BACheetah._renderLayout(BACheetah._jsonParse(e),t)}.bind(this)))},_updateLayout:function(){BACheetah.showAjaxLoader(),BACheetah.ajax({action:"render_layout"},BACheetah._renderLayout)},_renderLayout:function(e,t){BACheetah._layout?BACheetah._layoutQueue.push({data:e,callback:t}):BACheetah._layout=new BACheetahAJAXLayout(e,t)},_renderLayoutComplete:function(){var e;BACheetah._layout&&(BACheetah._layout._complete(),BACheetah._layout=null),BACheetah._layoutQueue.length&&(e=BACheetah._layoutQueue.shift(),BACheetah._layout=new BACheetahAJAXLayout(e.data,e.callback))},_resizeLayout:function(){x(window).trigger("resize"),"undefined"!=typeof YUI&&YUI().use("node-event-simulate",function(e){e.one(window).simulate("resize")})},layoutHasContent:function(){return 0<x(BACheetah._contentClass).children(".ba-cheetah-row").length},_initMediaElements:function(){var e={};void 0!==x.fn.mediaelementplayer&&("undefined"!=typeof _wpmejsSettings&&(e.pluginPath=_wpmejsSettings.pluginPath),x(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").mediaelementplayer(e))},_initDropTargets:function(){var e="row"==BACheetahConfig.userTemplateType?"":":not(.ba-cheetah-node-global)",t=x(BACheetah._contentClass+" .ba-cheetah-row:not(.ba-cheetah-row-type-row-inside)"),a=null,i=x(BACheetah._contentClass+" .ba-cheetah-row"+e).find(".ba-cheetah-col-group"),o=null,h=null,e="column"==BACheetahConfig.userTemplateType?x(BACheetah._contentClass+"> .ba-cheetah-col").eq(0):null,s=0;for(x(".ba-cheetah-col-drop-target").remove(),x(".ba-cheetah-col-group-drop-target").remove(),x(".ba-cheetah-row-drop-target").remove(),x(BACheetah._contentClass).append('<div class="ba-cheetah-drop-target ba-cheetah-row-drop-target"></div>'),t.prepend('<div class="ba-cheetah-drop-target ba-cheetah-row-drop-target"></div>'),t.append('<div class="ba-cheetah-drop-target ba-cheetah-drop-target-last ba-cheetah-row-drop-target ba-cheetah-row-drop-target-last"></div>');s<t.length;s++)0===(a=t.eq(s)).find(".ba-cheetah-col-group").length&&a.find(".ba-cheetah-row-content").prepend('<div class="ba-cheetah-drop-target ba-cheetah-col-group-drop-target"></div>');for(e&&0===i.length&&(i=e.find(".ba-cheetah-col-group"),e.append('<div class="ba-cheetah-drop-target ba-cheetah-col-drop-target"></div>'),e.append('<div class="ba-cheetah-drop-target ba-cheetah-drop-target-last ba-cheetah-col-drop-target ba-cheetah-col-drop-target-last"></div>')),s=0;s<i.length;s++)h=(o=i.eq(s)).find("> .ba-cheetah-col"),o.hasClass("ba-cheetah-col-group-nested")||(o.append('<div class="ba-cheetah-drop-target ba-cheetah-col-group-drop-target"></div>'),o.append('<div class="ba-cheetah-drop-target ba-cheetah-drop-target-last ba-cheetah-col-group-drop-target ba-cheetah-col-group-drop-target-last"></div>')),h.append('<div class="ba-cheetah-drop-target ba-cheetah-col-drop-target"></div>'),h.append('<div class="ba-cheetah-drop-target ba-cheetah-drop-target-last ba-cheetah-col-drop-target ba-cheetah-col-drop-target-last"></div>')},_blockDragHelper:function(e,t){var a=t.clone();return t.clone().insertAfter(t),a.addClass("ba-cheetah-block-drag-helper"),a},_blockDragInit:function(e){var t=x(e.currentTarget),a=null,i=x(window).scrollTop(),o=0;BACheetah._dragEnabled=!0,BACheetah._dragInitialScrollTop=i,0<t.closest("[data-node]").length?(a=t.closest("[data-node]")).addClass("ba-cheetah-node-drag-init"):t.hasClass("ba-cheetah-block")&&x(".ba-cheetah-row").each(function(){null===a&&0<x(this).offset().top-i&&(a=x(this))}),null!==a&&(o=a.offset().top-i),BACheetah._highlightRowsAndColsForDrag(t),BACheetah._adjustColHeightsForDrag(),BACheetah._disableGlobalRows(),BACheetah._disableGlobalCols(),BACheetah._destroyOverlayEvents(),BACheetah._initSortables(),x("body").addClass("ba-cheetah-dragging"),x(".ba-cheetah-empty-message").hide(),x(".ba-cheetah-sortable-disabled").removeClass("ba-cheetah-sortable-disabled"),"touchstart"===e.type||x(e.target).hasClass("ba-cheetah-sortable-proxy-item ")||BACheetah._removeAllOverlays(),0<o&&scrollTo(0,a.offset().top-o),BACheetah.triggerHook("didInitDrag")},_blockDragStart:function(e,t){BACheetah._dragging=!0,x(".ba-cheetah-node-drag-init").removeClass("ba-cheetah-node-drag-init"),BACheetah.triggerHook("didStartDrag")},_blockDragSort:function(e,t){var a=t.placeholder.parent(),i=BACheetahStrings.insert;BACheetah._blockPreventSort(t.item,a)||(a.hasClass("ba-cheetah-col-content")?i=t.item.hasClass("ba-cheetah-block-row")?t.item.find(".ba-cheetah-block-title").text():t.item.hasClass("ba-cheetah-col-sortable-proxy-item")?BACheetahStrings.column:t.item.hasClass("ba-cheetah-block-module")||t.item.hasClass("ba-cheetah-block-saved-module")||t.item.hasClass("ba-cheetah-block-module-template")?t.item.find(".ba-cheetah-block-title").text():t.item.attr("data-name"):a.hasClass("ba-cheetah-col-drop-target")||a.hasClass("ba-cheetah-col-group-drop-target")?i="":a.hasClass("ba-cheetah-row-drop-target")&&(i=t.item.hasClass("ba-cheetah-block-row")||t.item.hasClass("ba-cheetah-block-saved-row")||t.item.hasClass("ba-cheetah-block-saved-column")?t.item.find(".ba-cheetah-block-title").text():t.item.hasClass("ba-cheetah-row-sortable-proxy-item")?BACheetahStrings.row:BACheetahStrings.newRow),t.placeholder.html(i),t.item.hasClass("ba-cheetah-node-global")||t.item.hasClass("ba-cheetah-block-global")||x(".ba-cheetah-node-dragging").hasClass("ba-cheetah-node-global")?t.placeholder.addClass("ba-cheetah-drop-zone-global"):t.placeholder.removeClass("ba-cheetah-drop-zone-global"))},_blockDragChange:function(e,t){t.placeholder.css("opacity","0"),t.placeholder.animate({opacity:"1"},100)},_blockPreventSort:function(e,t){var a=!1,i=e.hasClass("ba-cheetah-block-row"),o=e.hasClass("ba-cheetah-col-sortable-proxy-item"),h=t.hasClass("ba-cheetah-col-content"),s=t.hasClass("ba-cheetah-col-drop-target"),n=t.parents(".ba-cheetah-col-group:not(.ba-cheetah-col-group-nested)"),l=t.parents(".ba-cheetah-col-group-nested");return isInsideRow=t.hasClass("ba-cheetah-row-content")&&t.closest(".ba-cheetah-row-type-row-inside"),(i||o)&&h&&0<l.length&&(a=!0),h&&!t.find(".ba-cheetah-module, .ba-cheetah-col").length&&(i&&"1-col"==e.data("cols")||o)&&(a=!0),i&&h&&-1<x.inArray(e.data("cols"),["5-cols","6-cols"])&&(a=!0),o&&0<x(".ba-cheetah-node-dragging").find(".ba-cheetah-col-group-nested").length&&(h||s&&0<l.length)&&(a=!0),s&&0<n.length&&0===l.length&&11<n.find("> .ba-cheetah-col:visible").length&&(a=!0),s&&0<l.length&&3<l.find(".ba-cheetah-col:visible").length&&(a=!0),(a=isInsideRow?!0:a)&&t.addClass("ba-cheetah-sortable-disabled"),a},_blockDragStop:function(e,t){var a=x(window).scrollTop(),i=t.item.parent(),t=null,t=i.hasClass("ba-cheetah-drop-target")&&i.closest("[data-node]").length?(i=i.closest("[data-node]")).offset().top-a:i.offset().top-a;i.hasClass("ba-cheetah-blocks-section-content")&&BACheetah._showPanel(),BACheetah._dragEnabled=!1,BACheetah._dragging=!1,BACheetah._bindOverlayEvents(),BACheetah._removeEmptyRowAndColHighlights(),BACheetah._highlightEmptyCols(),BACheetah._enableGlobalRows(),BACheetah._enableGlobalCols(),BACheetah._setupEmptyLayout(),x("body").removeClass("ba-cheetah-dragging"),scrollTo(0,i.offset().top-t),BACheetah.triggerHook("didStopDrag")},_blockDragCancel:function(){BACheetah._dragEnabled&&!BACheetah._dragging&&(BACheetah._dragEnabled=!1,BACheetah._dragging=!1,BACheetah._bindOverlayEvents(),BACheetah._removeEmptyRowAndColHighlights(),BACheetah._highlightEmptyCols(),BACheetah._enableGlobalRows(),BACheetah._setupEmptyLayout(),x("body").removeClass("ba-cheetah-dragging"),x(".ba-cheetah-node-drag-init").removeClass("ba-cheetah-node-drag-init"),x(".ba-cheetah-node-dragging").removeClass("ba-cheetah-node-dragging"),scrollTo(0,BACheetah._dragInitialScrollTop))},_reorderNode:function(e,t){BACheetah.ajax({action:"reorder_node",node_id:e,position:t},function(e){var t=JSON.parse(e),e="didMove"+t.nodeType.charAt(0).toUpperCase()+t.nodeType.slice(1);BACheetah.triggerHook("didMoveNode",t),BACheetah.triggerHook(e,t)})},_moveNode:function(e,t,a){BACheetah.ajax({action:"move_node",new_parent:e,node_id:t,position:a},function(e){var t=JSON.parse(e),e="didMove"+t.nodeType.charAt(0).toUpperCase()+t.nodeType.slice(1);BACheetah.triggerHook("didMoveNode",t),BACheetah.triggerHook(e,t)})},_removeAllOverlays:function(){BACheetah._removeRowOverlays(),BACheetah._removeColOverlays(),BACheetah._removeColHighlightGuides(),BACheetah._removeModuleOverlays(),BACheetah._hideTipTips(),BACheetah._closeAllSubmenus()},_appendOverlay:function(e,t){var a=0,i=null,o=e.hasClass("ba-cheetah-row")?e.find("> .ba-cheetah-row-content-wrap"):e.find("> .ba-cheetah-node-content"),h=parseInt(o.css("margin-top"),10),o=parseInt(o.css("margin-bottom"),10);return e.append(t),e.addClass("ba-cheetah-block-overlay-active"),BACheetah._initTipTips(),i=e.find("> .ba-cheetah-block-overlay"),h<0&&(a=parseInt(i.css("top"),10),a=isNaN(a)?0:a,i.css("top",h+a+"px")),o<0&&(a=parseInt(i.css("bottom"),10),a=isNaN(a)?0:a,i.css("bottom",o+a+"px")),i},_buildOverlayOverflowMenu:function(e){var t,a=e.find(".ba-cheetah-block-overlay-header"),i=e.find(".ba-cheetah-block-overlay-actions"),o=e.find(".ba-cheetah-block-has-rules"),h=i.data("original"),s=null,n=0,l=null,r=0,d=[],c=[],u=[],e=wp.template("ba-cheetah-overlay-overflow-menu");for(null!=h&&(i.after(h),i.remove(),i=h),i.data("original",i.clone()),t=Math.floor(i[0].getBoundingClientRect().width)-8,s=i.find(" > i, > span.ba-cheetah-has-submenu"),o.length&&t+o.outerWidth()>a.outerWidth()&&(n+=o.outerWidth());r<s.length;r++)l=s.eq(r),t<(n+=Math.floor(l[0].getBoundingClientRect().width))?(c.push(l),l.remove()):d.push(l);if(0<c.length){for(0<d.length&&c.unshift(d.pop().remove()),r=0;r<c.length;r++)c[r].is(".ba-cheetah-has-submenu")?u.push({type:"submenu",label:c[r].find(".fa, .fas, .far").data("title"),submenu:c[r].find(".ba-cheetah-submenu")[0].outerHTML}):u.push({type:"action",label:c[r].data("title"),className:c[r].removeClass(function(e,t){return t.replace(/ba-cheetah-block-([^\s]+)/,"")}).attr("class")});i.append(e(u)),BACheetah._initTipTips()}},_removeRowOverlays:function(){x(".ba-cheetah-row").removeClass("ba-cheetah-block-overlay-active"),x(".ba-cheetah-row-overlay").remove(),x(".ba-cheetah-module").removeClass("ba-cheetah-module-adjust-height"),x("body").removeClass("ba-cheetah-row-resizing"),BACheetah._closeAllSubmenus()},_disableGlobalRows:function(){"row"!=BACheetahConfig.userTemplateType&&x(".ba-cheetah-row.ba-cheetah-node-global").addClass("ba-cheetah-node-disabled")},_disableGlobalCols:function(){"column"!=BACheetahConfig.userTemplateType&&x(".ba-cheetah-row:not(.ba-cheetah-node-global) .ba-cheetah-col.ba-cheetah-node-global").addClass("ba-cheetah-node-disabled")},_enableGlobalRows:function(){"row"!=BACheetahConfig.userTemplateType&&x(".ba-cheetah-node-disabled").removeClass("ba-cheetah-node-disabled")},_enableGlobalCols:function(){"column"!=BACheetahConfig.userTemplateType&&x(".ba-cheetah-node-disabled").removeClass("ba-cheetah-node-disabled")},_rowMouseenter:function(){var e=x(this),t=e.offset().top,a=null,i=null,o=wp.template("ba-cheetah-row-overlay"),h=BACheetahResponsiveEditing._mode;e.closest(".ba-cheetah-node-loading").length||e.hasClass("ba-cheetah-block-overlay-active")||(e.hasClass("ba-cheetah-row-type-row-inside")||BACheetah._removeRowOverlays(),i=BACheetah._appendOverlay(e,o({node:e.attr("data-node"),global:e.hasClass("ba-cheetah-node-global"),hasRules:e.hasClass("ba-cheetah-node-has-rules"),rulesTextRow:e.attr("data-rules-text"),rulesTypeRow:e.attr("data-rules-type"),inside:e.hasClass("ba-cheetah-row-type-row-inside")})),e.find(".ba-cheetah-node-content:visible").each(function(){var e=x(this).offset().top;a=null===a||e<a?e:a}),null!==a&&a<t&&i.css("top",a-t-30+"px"),("default"===h&&i.offset().top<43||"default"!==h&&0===e.index())&&i.addClass("ba-cheetah-row-overlay-header-bottom"),e.find(".ba-cheetah-module").each(function(){var e=x(this);e.outerHeight(!0)<20&&e.addClass("ba-cheetah-module-adjust-height")}),BACheetah._buildOverlayOverflowMenu(i))},_rowMouseleave:function(e){var t=x(e.target),a=x(e.toElement)||x(e.relatedTarget),i=a.hasClass("ba-cheetah-row-overlay"),o=0<a.closest(".ba-cheetah-row-overlay").length,e=a.is("#tiptip_holder"),a=0<a.closest("#tiptip_holder").length;t.closest(".ba-cheetah-block-col-resize").length||i||o||e||a||BACheetah._removeRowOverlays()},_rowDragHelper:function(){return x('<div class="ba-cheetah-block-drag-helper">'+BACheetahStrings.row+"</div>")},_rowDragInit:function(e){var t=x(e.target),a=x(".ba-cheetah-row-sortable-proxy-item");t.closest(".ba-cheetah-row").addClass("ba-cheetah-node-dragging"),BACheetah._blockDragInit(e),e.target=a[0],a.trigger(e)},_rowDragInitTouch:function(t){var e=x(t.target),a=x(".ba-cheetah-row-sortable-proxy-item"),i=e.closest(".ba-cheetah-row"),o=!1;e.on("touchmove",function(e){o||(t.currentTarget=i[0],BACheetah._rowDragInit(t),o=!0),a.trigger(e)}),e.on("touchend",function(e){a.trigger(e)})},_rowDragStart:function(e,t){var a=x(BACheetah._contentClass+" .ba-cheetah-row"),i=x(".ba-cheetah-node-dragging");1===a.length&&x(BACheetah._contentClass).addClass("ba-cheetah-empty"),i.hide(),BACheetah._blockDragStart(e,t)},_rowDragStop:function(e,t){var a,i=t.item,o=i.parent(),h=null,s=0;if(BACheetah._blockDragStop(e,t),o.hasClass("ba-cheetah-rows"))i.remove();else if(o.hasClass("ba-cheetah-row-sortable-proxy"))x(".ba-cheetah-node-dragging").removeClass("ba-cheetah-node-dragging").show();else if(i.hasClass("ba-cheetah-block")){if(o.hasClass("ba-cheetah-sortable-disabled"))return i.remove(),void BACheetah._showPanel();o.hasClass("ba-cheetah-col-content")?BACheetah._addColGroup(i.closest(".ba-cheetah-col").attr("data-node"),i.attr("data-cols"),o.find("> .ba-cheetah-module, .ba-cheetah-col-group, .ba-cheetah-block").index(i)):o.hasClass("ba-cheetah-col-drop-target")?BACheetah._addCols(o.closest(".ba-cheetah-col"),o.hasClass("ba-cheetah-col-drop-target-last")?"after":"before",i.attr("data-cols"),0<o.closest(".ba-cheetah-col-group-nested").length):o.hasClass("ba-cheetah-col-group-drop-target")?(a=i.closest(".ba-cheetah-col-group"),s=i.closest(".ba-cheetah-row").find(".ba-cheetah-row-content > .ba-cheetah-col-group").index(a),BACheetah._addColGroup(i.closest(".ba-cheetah-row").attr("data-node"),i.attr("data-cols"),o.hasClass("ba-cheetah-drop-target-last")?s+1:s)):(s=(h=i.closest(".ba-cheetah-row")).length?x(BACheetah._contentClass+" > .ba-cheetah-row").index(h):0,BACheetah._addRow(i.attr("data-cols"),o.hasClass("ba-cheetah-drop-target-last")?s+1:s)),i.remove(),BACheetah._showPanel(),x(".ba-cheetah-modules").siblings(".ba-cheetah-blocks-section-title").eq(0).trigger("click")}else h=x(".ba-cheetah-node-dragging").removeClass("ba-cheetah-node-dragging").show(),o.parent().hasClass("ba-cheetah-content")||(o.hasClass("ba-cheetah-drop-target-last")?o.parent().after(h):o.parent().before(h),BACheetah._reorderNode(h.attr("data-node"),h.index())),x(".ba-cheetah-row-sortable-proxy").append(t.item)},_addRow:function(e,t,a){BACheetah._showNodeLoadingPlaceholder(x(BACheetah._contentClass),t),BACheetah._newRowPosition=t,BACheetah.ajax({action:"render_new_row",cols:e,position:t,module:a},BACheetah._addRowComplete)},_addRowComplete:function(e){var t="object"==typeof e?e:BACheetah._jsonParse(e),e=x(BACheetah._contentClass),a=x(t.html).data("node");t.nodeParent=e,t.nodePosition=BACheetah._newRowPosition,BACheetah._renderLayout(t,function(){BACheetah._removeNodeLoadingPlaceholder(x(".ba-cheetah-node-"+a)),BACheetah.triggerHook("didAddRow",a)})},_deleteRowClicked:function(e){var t=x(this).closest(".ba-cheetah-row");t.find(".ba-cheetah-module").length&&!confirm(BACheetahStrings.deleteRowMessage)||BACheetah._deleteRow(t),BACheetah._removeAllOverlays(),e.stopPropagation()},_deleteRow:function(e){var t=e.attr("data-node");BACheetah.ajax({action:"delete_node",node_id:t}),e.empty(),e.remove(),BACheetah._setupEmptyLayout(),BACheetah._removeRowOverlays(),BACheetah.triggerHook("didDeleteRow",t)},_rowCopyClicked:function(e){var t=x(window),a=x(this).closest(".ba-cheetah-row"),i=a.attr("data-node"),o=a.clone(),h=x(".ba-cheetah-settings[data-node]"),s=h.attr("data-node"),n=s===i?a:a.find('[data-node="'+s+'"]'),l=null;h.length&&n.length&&(l=BACheetah._getSettings(h),BACheetahSettingsConfig.nodes[s]=l),o.addClass("ba-cheetah-node-"+i+"-clone ba-cheetah-node-clone"),o.find(".ba-cheetah-block-overlay").remove(),a.after(o),BACheetah._showNodeLoading(i+"-clone"),t.scrollTop()+t.height()<o.offset().top&&x("html, body").animate({scrollTop:o.offset().top+o.height()-t.height()},500),BACheetah.ajax({action:"copy_row",node_id:i,settings:l,settings_id:s},function(e){e=BACheetah._jsonParse(e);e.nodeParent=x(BACheetah._contentClass),e.nodePosition=x(BACheetah._contentClass+" > .ba-cheetah-row").index(o),e.duplicatedRow=i,e.onAddNewHTML=function(){o.remove()},BACheetah._rowCopyComplete(e)}),e.stopPropagation()},_rowCopyComplete:function(e){BACheetah._renderLayout(e,function(){BACheetah.triggerHook("didDuplicateRow",{newNodeId:e.nodeId,oldNodeId:e.duplicatedRow})})},_rowSettingsClicked:function(e){var t=x(this),a=t.closest(".ba-cheetah-row").attr("data-node"),i=0<t.closest(".ba-cheetah-block-overlay-global").length;i&&"row"!=BACheetahConfig.userTemplateType?BACheetahConfig.userCanEditGlobalTemplates&&(window.open(x('.ba-cheetah-row[data-node="'+a+'"]').attr("data-template-url")).BACheetahGlobalNodeId=a):t.hasClass("ba-cheetah-block-settings")&&BACheetahSettingsForms.render({id:"row",nodeId:a,className:"ba-cheetah-row-settings",attrs:'data-node="'+a+'"',buttons:i||BACheetahConfig.simpleUi?[]:["save-as"],badges:i?[BACheetahStrings.global]:[],settings:BACheetahSettingsConfig.nodes[a],preview:{type:"row"}},function(){x("#ba-cheetah-field-width select").on("change",BACheetah._rowWidthChanged),x("#ba-cheetah-field-content_width select").on("change",BACheetah._rowWidthChanged)}),e.stopPropagation()},_rowWidthChanged:function(){var e=x("#ba-cheetah-field-width select").val(),t=x("#ba-cheetah-field-content_width select").val(),a=x("#ba-cheetah-field-max_content_width");"fixed"==e||"full"==e&&"fixed"==t?a.show():a.hide()},_resetRowWidthClicked:function(e){var t=x(this).closest(".ba-cheetah-row"),a=t.attr("data-node"),i=t.find(".ba-cheetah-row-content"),o=BACheetahConfig.global.row_width+"px",h=x(".ba-cheetah-row-settings");t.hasClass("ba-cheetah-row-fixed-width")&&t.css("max-width",o),i.css("max-width",o),h.length&&h.find("[name=max_content_width]").val(""),BACheetah.ajax({action:"resize_row_content",node:a,width:""}),BACheetah._closeAllSubmenus(),BACheetah.triggerHook("didResetRowWidth",a),e.stopPropagation()},_highlightEmptyCols:function(){var e="row"==BACheetahConfig.userTemplateType||"column"==BACheetahConfig.userTemplateType?"":":not(.ba-cheetah-node-global)",e=(x(BACheetah._contentClass+" .ba-cheetah-row"+e),x(BACheetah._contentClass+" .ba-cheetah-col"+e));e.removeClass("ba-cheetah-col-highlight").find(".ba-cheetah-col-content").css("height",""),e.each(function(){var e=x(this);0===e.find(".ba-cheetah-module, .ba-cheetah-col").length&&e.addClass("ba-cheetah-col-highlight")})},_highlightRowsAndColsForDrag:function(e){var t="row"==BACheetahConfig.userTemplateType?"":":not(.ba-cheetah-node-global)";"column"==BACheetahConfig.userTemplateType&&(t=":not(:first)"),x(BACheetah._contentClass+" .ba-cheetah-row").addClass("ba-cheetah-row-highlight"),e&&e.closest(".ba-cheetah-row-overlay").length||x(BACheetah._contentClass+" .ba-cheetah-col"+t).addClass("ba-cheetah-col-highlight")},_removeEmptyRowAndColHighlights:function(){x(".ba-cheetah-row-highlight").removeClass("ba-cheetah-row-highlight"),x(".ba-cheetah-col-highlight").removeClass("ba-cheetah-col-highlight")},_adjustColHeightsForDrag:function(){var e="row"==BACheetahConfig.userTemplateType?"":".ba-cheetah-row:not(.ba-cheetah-node-global) ",t="column"==BACheetahConfig.userTemplateType?"":".ba-cheetah-col:not(.ba-cheetah-node-global) ",a=x(BACheetah._contentClass),i=a.find(e+".ba-cheetah-col-group:not(.ba-cheetah-col-group-nested) > "+t+"> .ba-cheetah-col-content"),o=a.find(e+".ba-cheetah-col-group-nested "+t+".ba-cheetah-col-content"),h=0;for(x(".ba-cheetah-node-drag-init").hide();h<o.length;h++)BACheetah._adjustColHeightForDrag(o.eq(h));for(h=0;h<i.length;h++)BACheetah._adjustColHeightForDrag(i.eq(h));x(".ba-cheetah-node-drag-init").show()},_adjustColHeightForDrag:function(e){e.find(".ba-cheetah-module:visible, .ba-cheetah-col:visible").length&&e.height(e.height()+45)},_showColHighlightGuide:function(){var e,t=x(this),a=t.find("a"),i=t.closest(".ba-cheetah-col"),o=i.parents(".ba-cheetah-col"),h=x('<div class="ba-cheetah-col-highlight-guide"></div>'),t=t.closest(".ba-cheetah-block-overlay").offset().top;(i=a.hasClass("ba-cheetah-block-col-move-parent")||a.hasClass("ba-cheetah-block-col-edit-parent")?o:i).hasClass("ba-cheetah-col-highlight")||(i.find("> .ba-cheetah-col-content").append(h),i.addClass("ba-cheetah-col-has-highlight-guide"),t<(e=h.offset().top)&&h.css("top",t-e+4+"px"))},_removeColHighlightGuides:function(){x(".ba-cheetah-col-has-highlight-guide").removeClass("ba-cheetah-col-has-highlight-guide"),x(".ba-cheetah-col-highlight-guide").remove()},_colMouseenter:function(){var e=x(this),t=e.closest(".ba-cheetah-col-group"),a=t.hasClass("ba-cheetah-col-group-has-child-loading"),i=e.hasClass("ba-cheetah-node-global"),o=0<e.parents(".ba-cheetah-node-global").length,h=e.closest(".ba-cheetah-col-group").find("> .ba-cheetah-col").length,s=t.find("> .ba-cheetah-col").index(e),n=0===s,l=h===s+1,r=0<e.find(".ba-cheetah-col").length,d=0<e.find(".ba-cheetah-module").length,c=e.parents(".ba-cheetah-col"),u=c.closest(".ba-cheetah-col-group"),p=0<c.length,t=void 0!==e.data("template-url"),s="column"==BACheetahConfig.userTemplateType&&!p;numParentCols=p?u.find("> .ba-cheetah-col").length:0,parentIndex=u.find("> .ba-cheetah-col").index(c),parentFirst=p&&0===parentIndex,parentLast=p&&numParentCols===parentIndex+1,row=e.closest(".ba-cheetah-row"),rowIsFixedWidth=!!row.find(".ba-cheetah-row-fixed-width").addBack(".ba-cheetah-row-fixed-width").length,userCanResizeRows=BACheetahConfig.rowResize.userCanResizeRows,hasRules=e.hasClass("ba-cheetah-node-has-rules"),template=wp.template("ba-cheetah-col-overlay"),overlay=null,BACheetahConfig.simpleUi&&!i||i&&o&&d&&!t||i&&"column"==BACheetahConfig.userTemplateType&&d||!i&&0<e.find(".ba-cheetah-module").length||0<e.find(".ba-cheetah-node-loading-placeholder").length||!d&&r||o&&r&&!t||e.closest(".ba-cheetah-node-loading").length||(e.hasClass("ba-cheetah-block-overlay-active")||(BACheetah._removeColOverlays(),BACheetah._removeModuleOverlays(),overlay=BACheetah._appendOverlay(e,template({global:i,groupLoading:a,numCols:h,first:n,last:l,isRootCol:s,hasChildCols:r,hasParentCol:p,parentFirst:parentFirst,parentLast:parentLast,numParentCols:numParentCols,rowIsFixedWidth:rowIsFixedWidth,userCanResizeRows:userCanResizeRows,hasRules:hasRules})),BACheetah._buildOverlayOverflowMenu(overlay),BACheetah._initColDragResizing()),x("body").addClass("ba-cheetah-block-overlay-muted"))},_colMouseleave:function(e){var t=x(this),a=x(e.target),i=x(e.toElement)||x(e.relatedTarget),o=0<t.find(".ba-cheetah-module").length,e=(t.hasClass("ba-cheetah-node-global"),void 0!==t.data("template-url")),t=i.is("#tiptip_holder"),i=0<i.closest("#tiptip_holder").length;a.closest(".ba-cheetah-block-col-resize").length||t||i||o&&!e||(BACheetah._removeColOverlays(),BACheetah._removeColHighlightGuides(),BACheetah._closeAllSubmenus())},_removeColOverlays:function(){var e=x(".ba-cheetah-col");e.removeClass("ba-cheetah-block-overlay-active"),e.find(".ba-cheetah-col-overlay").remove(),x("body").removeClass("ba-cheetah-block-overlay-muted"),BACheetah._closeAllSubmenus()},_colDragHelper:function(){return x('<div class="ba-cheetah-block-drag-helper">'+BACheetahStrings.column+"</div>")},_colDragInit:function(e){var t=x(e.target),a=x(".ba-cheetah-col-sortable-proxy-item"),i=t.closest(".ba-cheetah-col");(i=t.hasClass("ba-cheetah-block-col-move-parent")?i.parents(".ba-cheetah-col"):i).addClass("ba-cheetah-node-dragging"),BACheetah._blockDragInit(e),BACheetah._removeColHighlightGuides(),e.target=a[0],a.trigger(e)},_colDragInitTouch:function(t){var e=x(t.target),a=x(".ba-cheetah-col-sortable-proxy-item"),i=e.closest(".ba-cheetah-col"),o=(e.closest(".ba-cheetah-module"),!1);e.on("touchmove",function(e){o||(t.currentTarget=i[0],BACheetah._colDragInit(t),o=!0),a.trigger(e)}),e.on("touchend",function(e){a.trigger(e)})},_colDragStart:function(e,t){var a=x(".ba-cheetah-node-dragging");a.hide(),BACheetah._resetColumnWidths(a.parent()),BACheetah._blockDragStart(e,t)},_colDragStop:function(e,t){BACheetah._blockDragStop(e,t);var a=x(".ba-cheetah-node-dragging").removeClass("ba-cheetah-node-dragging").show(),i=a.attr("data-node"),o=t.item.parent(),h=a.parent(),e=h.attr("data-node");newGroup=o.closest(".ba-cheetah-col-group"),newGroupId=newGroup.attr("data-node"),newRow=o.closest(".ba-cheetah-row"),position=0,o.closest('[data-node="'+i+'"]').length||o.hasClass("ba-cheetah-sortable-disabled")||o.hasClass("ba-cheetah-col-sortable-proxy")?BACheetah._resetColumnWidths(h):o.hasClass("ba-cheetah-col-content")?(a.remove(),0===h.find(".ba-cheetah-col").length&&h.remove(),position=o.find("> .ba-cheetah-module, .ba-cheetah-col-group, .ba-cheetah-col-sortable-proxy-item").index(t.item),BACheetah._addColGroup(o.closest(".ba-cheetah-col").attr("data-node"),i,position)):o.hasClass("ba-cheetah-col-drop-target")?(o.hasClass("ba-cheetah-col-drop-target-last")?o.parent().after(a):o.parent().before(a),BACheetah._resetColumnWidths(newGroup),e==newGroupId?BACheetah.ajax({action:"reorder_col",node_id:i,position:a.index()},function(){BACheetah.triggerHook("didMoveColumn")}):BACheetah.ajax({action:"move_col",node_id:i,new_parent:newGroupId,position:a.index(),resize:[e,newGroupId]},function(){BACheetah.triggerHook("didMoveColumn")}),BACheetah._resizeLayout()):o.hasClass("ba-cheetah-col-group-drop-target")?(a.remove(),0===h.find(".ba-cheetah-col").length&&h.remove(),position=newRow.find(".ba-cheetah-row-content > .ba-cheetah-col-group").index(newGroup),position=o.hasClass("ba-cheetah-drop-target-last")?position+1:position,BACheetah._addColGroup(newRow.attr("data-node"),i,position)):o.hasClass("ba-cheetah-row-drop-target")&&(a.remove(),position=o.closest(".ba-cheetah-content").find(".ba-cheetah-row").index(newRow),position=o.hasClass("ba-cheetah-drop-target-last")?position+1:position,BACheetah._addRow(i,position)),0===h.find(".ba-cheetah-col").length&&h.remove(),x(".ba-cheetah-col-sortable-proxy").append(t.item),BACheetah._highlightEmptyCols(),BACheetah._initDropTargets(),BACheetah._initSortables(),BACheetah._closeAllSubmenus()},_colSettingsClicked:function(e){var t=x(this),a=t.parent().closest(".ba-cheetah-module-inside-overlay");col=t.closest(".ba-cheetah-col"),content=col.find("> .ba-cheetah-col-content"),hasSubmenu=0<t.parent().find("ul.ba-cheetah-submenu").length,global=0<t.closest(".ba-cheetah-block-overlay-global").length,isGlobalCol=t.closest(".ba-cheetah-block-overlay-global").hasClass("ba-cheetah-col-overlay"),isColTemplate="column"!=BACheetahConfig.userTemplateType&&void 0!==col.attr("data-template-url"),nodeId=null,0<a.length&&a.addClass("z-index-up"),BACheetah._colResizing||global&&!BACheetahConfig.userCanEditGlobalTemplates||hasSubmenu&&!t.hasClass("ba-cheetah-col-overlay")||(t.hasClass("ba-cheetah-block-col-edit-parent")&&(col=col.parents(".ba-cheetah-col")),nodeId=col.attr("data-node"),global&&isGlobalCol&&isColTemplate?BACheetahConfig.userCanEditGlobalTemplates&&(win=window.open(x('.ba-cheetah-col[data-node="'+nodeId+'"]').attr("data-template-url")),win.BACheetahGlobalNodeId=nodeId):BACheetahSettingsForms.render({id:"col",nodeId:nodeId,className:"ba-cheetah-col-settings",attrs:'data-node="'+nodeId+'"',buttons:global||BACheetahConfig.simpleUi?[]:["save-as"],badges:global?[BACheetahStrings.global]:[],settings:BACheetahSettingsConfig.nodes[nodeId],preview:{type:"col"}},function(){0===col.siblings(".ba-cheetah-col").length&&x("#ba-cheetah-field-size, #ba-cheetah-field-equal_height, #ba-cheetah-field-content_alignment").hide()}),e.stopPropagation())},_copyColClicked:function(e){var t=x(this).closest(".ba-cheetah-col"),a=t.attr("data-node"),i=t.clone(),o=t.parent(),h=x(".ba-cheetah-settings[data-node]"),s=h.attr("data-node"),n=s===a?t:t.find('[data-node="'+s+'"]'),l=null;h.length&&n.length&&(l=BACheetah._getSettings(h),BACheetahSettingsConfig.nodes[s]=l),i.addClass("ba-cheetah-node-"+a+"-clone ba-cheetah-node-clone"),i.find(".ba-cheetah-block-overlay").remove(),t.after(i),BACheetah._showNodeLoading(a+"-clone"),BACheetah._resetColumnWidths(o),BACheetah.ajax({action:"copy_col",node_id:a,settings:l,settings_id:s},function(e){e=BACheetah._jsonParse(e);e.nodeParent=o,e.nodePosition=i.index(),e.duplicatedColumn=a,e.onAddNewHTML=function(){i.remove()},BACheetah._copyColComplete(e)}),e.stopPropagation()},_copyColComplete:function(e){BACheetah._renderLayout(e,function(){BACheetah._resetColumnWidths(e.nodeParent),BACheetah.triggerHook("didDuplicateColumn",{newNodeId:e.nodeId,oldNodeId:e.duplicatedColumn})})},_deleteColClicked:function(e){var t=x(this).closest(".ba-cheetah-col"),a=t.closest(".ba-cheetah-col-group"),i=t.parents(".ba-cheetah-col"),o=0<i.length,h=i.find("> .ba-cheetah-col-content > .ba-cheetah-module, > .ba-cheetah-col-content > .ba-cheetah-col-group"),s=t.siblings(".ba-cheetah-col"),n=t.closest(".ba-cheetah-row-type-row-inside").find(".ba-cheetah-col").length,l=0<t.closest(".ba-cheetah-module").length,r=!0;if(1==n)return BACheetah.alert(BACheetahStrings.cantDeleteLastRowInside),void e.stopPropagation();0<t.find(".ba-cheetah-module").length&&(r=confirm(BACheetahStrings.deleteColumnMessage)),o&&1===h.length&&!l&&(0===s.length?t=i:1!==s.length||s.find(".ba-cheetah-module").length||(t=a)),r&&(BACheetah._deleteCol(t),BACheetah._removeAllOverlays(),BACheetah._highlightEmptyCols(),BACheetah._resizeLayout()),e.stopPropagation()},_deleteCol:function(e){var t=e.attr("data-node"),a=e.closest(".ba-cheetah-row"),i=e.closest(".ba-cheetah-col-group"),o=0;e.remove(),rowCols=a.find(".ba-cheetah-row-content > .ba-cheetah-col-group > .ba-cheetah-col"),groupCols=i.find(" > .ba-cheetah-col"),0===rowCols.length&&"row"!=BACheetahConfig.userTemplateType&&"column"!=BACheetahConfig.userTemplateType?BACheetah._deleteRow(a):(0===groupCols.length?i.remove():(o=6===groupCols.length?16.65:7===groupCols.length?14.28:Math.round(100/groupCols.length*100)/100,groupCols.css("width",o+"%"),BACheetah.triggerHook("didResetColumnWidths",{cols:groupCols})),BACheetah.ajax({action:"delete_col",node_id:t,new_width:o}),BACheetah._initDropTargets(),BACheetah._initSortables(),BACheetah.triggerHook("didDeleteColumn",t))},_addCols:function(e,t,a,i,o){var h=e.closest(".ba-cheetah-col-group"),s=h.find(".ba-cheetah-col").index(e);a=void 0===a?"1-col":a,i=void 0!==i&&i,"after"==t&&s++,BACheetah._showNodeLoadingPlaceholder(h,s),BACheetah._removeAllOverlays(),BACheetah.ajax({action:"render_new_columns",node_id:e.attr("data-node"),insert:t,type:a,nested:i?1:0,module:o},BACheetah._addColsComplete)},_addColsComplete:function(e){var t="object"==typeof e?e:BACheetah._jsonParse(e);t.nodeParent=BACheetah._newColParent,t.nodePosition=BACheetah._newColPosition,BACheetah._renderLayout(t,function(){BACheetah._removeNodeLoadingPlaceholder(x(".ba-cheetah-node-"+t.nodeId)),BACheetah.triggerHook("didAddColumn",t.nodeId),BACheetah.triggerHook("didResetColumnWidths",{cols:x(".ba-cheetah-node-"+t.nodeId).find("> .ba-cheetah-col")})})},_addColGroup:function(e,t,a,i){var o=x(".ba-cheetah-node-"+e);BACheetah._newColGroupPosition=a,o.hasClass("ba-cheetah-col")?BACheetah._newColGroupParent=o.find(" > .ba-cheetah-col-content"):BACheetah._newColGroupParent=o.find(".ba-cheetah-row-content"),BACheetah._showNodeLoadingPlaceholder(BACheetah._newColGroupParent,a),BACheetah.ajax({action:"render_new_column_group",cols:t,node_id:e,position:a,module:i},BACheetah._addColGroupComplete)},_addColGroupComplete:function(e){var t=BACheetah._jsonParse(e),e=x(t.html),a=e.data("node");e.find(".ba-cheetah-col").data("node");t.nodeParent=BACheetah._newColGroupParent,t.nodePosition=BACheetah._newColGroupPosition,BACheetah._renderLayout(t,function(){t.nodeParent.hasClass("ba-cheetah-col-content")&&t.nodeParent.parents(".ba-cheetah-col").addClass("ba-cheetah-col-has-cols"),BACheetah._removeNodeLoadingPlaceholder(x(".ba-cheetah-node-"+a)),BACheetah.triggerHook("didAddColumnGroup",a)})},_initColDragResizing:function(){x(".ba-cheetah-block-col-resize").not(".ba-cheetah-block-row-resize").draggable({axis:"x",start:BACheetah._colDragResizeStart,drag:BACheetah._colDragResize,stop:BACheetah._colDragResizeStop})},_colDragResizeStart:function(e,t){for(var a=x(t.helper),i="",o=a.hasClass("ba-cheetah-block-col-resize-parent"),h=o?a.closest(".ba-cheetah-col").parents(".ba-cheetah-col"):null,s=o?h.parents(".ba-cheetah-col-group"):a.closest(".ba-cheetah-col-group"),n=s.find("> .ba-cheetah-col"),l=o?h:a.closest(".ba-cheetah-col"),r=l.attr("data-node"),d=x("[data-node="+r+"] #ba-cheetah-field-size input"),c=null,u=100,p=0,h=null,r=null,g=(c=a.hasClass("ba-cheetah-block-col-resize-e")?(i="e",l.nextAll(".ba-cheetah-col").first()):(i="w",l.prevAll(".ba-cheetah-col").first())).attr("data-node"),o=x("[data-node="+g+"] #ba-cheetah-field-size input");p<n.length;p++)n.eq(p).data("node")!=l.data("node")&&n.eq(p).data("node")!=c.data("node")&&(u-=parseFloat(n.eq(p)[0].style.width));d.length?(h=d,r="col"):o.length&&(h=o,r="sibling"),BACheetah._colResizeData={handle:a,feedbackLeft:a.find(".ba-cheetah-block-col-resize-feedback-left"),feedbackRight:a.find(".ba-cheetah-block-col-resize-feedback-right"),direction:i,groupWidth:s.outerWidth(),col:l,colWidth:parseFloat(l[0].style.width)/100,sibling:c,offset:t.position.left,availWidth:u,setting:h,settingType:r},BACheetah._colResizing=!0,x("body").addClass("ba-cheetah-col-resizing"),BACheetah._closePanel(),BACheetah._destroyOverlayEvents(),BACheetah.triggerHook("col-resize-start")},_colDragResize:function(e,t){var a=BACheetah._colResizeData,i=BACheetahConfig.isRtl?"w":"e",o=a.handle.closest(".ba-cheetah-block-overlay"),h=(a.offset-t.position.left)/a.groupWidth,s=i==a.direction?100*(a.colWidth-h):100*(a.colWidth+h),t=Math.round(100*s)/100,h=a.availWidth-s,s=Math.round(100*h)/100,h=Math.round(100*(a.availWidth-8))/100;t<8?(t=8,s=h):s<8&&(t=h,s=8),i==a.direction?(a.feedbackLeft.html(t.toFixed(1)+"%").show(),a.feedbackRight.html(s.toFixed(1)+"%").show()):(a.feedbackLeft.html(s.toFixed(1)+"%").show(),a.feedbackRight.html(t.toFixed(1)+"%").show()),a.col.css("width",t+"%"),a.sibling.css("width",s+"%"),a.setting&&("col"===a.settingType?a.setting.val(parseFloat(a.col[0].style.width)):"sibling"===a.settingType&&a.setting.val(parseFloat(a.sibling[0].style.width))),BACheetah._buildOverlayOverflowMenu(o),BACheetah.triggerHook("col-resize-drag")},_colDragResizeStop:function(e,t){var a=BACheetah._colResizeData,i=BACheetah._colResizeData.handle.closest(".ba-cheetah-block-overlay"),o=a.col.data("node"),h=parseFloat(a.col[0].style.width),s=a.sibling.data("node"),a=parseFloat(a.sibling[0].style.width);BACheetah._colResizeData.feedbackLeft.hide(),BACheetah._colResizeData.feedbackRight.hide(),BACheetah.ajax({action:"resize_cols",col_id:o,col_width:h,sibling_id:s,sibling_width:a}),BACheetah._buildOverlayOverflowMenu(i),BACheetah._colResizeData=null,x("body").removeClass("ba-cheetah-col-resizing"),BACheetah._bindOverlayEvents(),setTimeout(function(){BACheetah._colResizing=!1},50),BACheetah.triggerHook("col-resize-stop"),BACheetah.triggerHook("didResizeColumn",{colId:o,colWidth:h,siblingId:s,siblingWidth:a})},_resetColumnWidthsClicked:function(e){var t,a=x(this),i=!!a.closest(".ba-cheetah-row-overlay").length,o=null,h=[],s=null,n=0,l=x(".ba-cheetah-col-settings");(i?a.closest(".ba-cheetah-row").find(".ba-cheetah-row-content > .ba-cheetah-col-group"):a.parents(".ba-cheetah-col-group").last()).each(function(){for(o=x(this),s=o.find(".ba-cheetah-col-group"),h.push(o.data("node")),BACheetah._resetColumnWidths(o),n=0;n<s.length;n++)BACheetah._resetColumnWidths(s.eq(n)),h.push(s.eq(n).data("node"))}),l.length&&(t=x(".ba-cheetah-node-"+l.attr("data-node")),l.find("#ba-cheetah-field-size input").val(parseFloat(t[0].style.width))),BACheetah.ajax({action:"reset_col_widths",group_id:h},function(){BACheetah.triggerHook("didResetColumnWidthsComplete")}),BACheetah.triggerHook("col-reset-widths"),BACheetah._closeAllSubmenus(),e.stopPropagation()},_resetColumnWidths:function(e){var t=e.find(" > .ba-cheetah-col:visible"),e=0,e=6===t.length?16.65:7===t.length?14.28:Math.round(100/t.length*100)/100;t.css("width",e+"%"),BACheetah.triggerHook("didResetColumnWidths",{cols:t})},_moduleMouseenter:function(e){var t=x(this),a=t.attr("data-name"),i=t.hasClass("ba-cheetah-node-global"),o=0<t.parents(".ba-cheetah-node-global").length,h=t.parents(".ba-cheetah-col-group").last(),s=(t.parents(".ba-cheetah-module"),h.hasClass("ba-cheetah-col-group-has-child-loading")),n=t.closest(".ba-cheetah-col-group").find("> .ba-cheetah-col").length,l=t.closest(".ba-cheetah-col"),r=0===l.index(),d=n===l.index()+1,c=l.parents(".ba-cheetah-col"),u=0<t.find(".ba-cheetah-row-type-row-inside").length,p=0<t.parent().closest(".ba-cheetah-module").length,g=0<c.length,b=g?c.closest(".ba-cheetah-col-group").find("> .ba-cheetah-col").length:0,f=g&&0===c.index(),C=g&&b===c.index()+1,m="column"==BACheetahConfig.userTemplateType&&!g,v=t.closest(".ba-cheetah-row"),_=v.hasClass("ba-cheetah-node-global"),w=!!v.find(".ba-cheetah-row-fixed-width").addBack(".ba-cheetah-row-fixed-width").length,A=BACheetahConfig.rowResize.userCanResizeRows,y=t.hasClass("ba-cheetah-node-has-rules"),B=t.attr("data-rules-text"),S=t.attr("data-rules-type"),k=l.attr("data-rules-text"),h=l.attr("data-rules-type"),c=l.hasClass("ba-cheetah-node-has-rules"),v=wp.template("ba-cheetah-module-overlay"),l=null;"mouseenter"==e.type&&p||i&&o&&"row"!=BACheetahConfig.userTemplateType&&_||i&&o&&"column"!=BACheetahConfig.userTemplateType&&!_||t.closest(".ba-cheetah-node-loading").length||t.find(".ba-cheetah-inline-editor:visible").length||(t.hasClass("ba-cheetah-block-overlay-active")||(BACheetah._removeColOverlays(),BACheetah._removeModuleOverlays(),l=BACheetah._appendOverlay(t,v({global:i,moduleName:a,groupLoading:s,numCols:n,colFirst:r,colLast:d,isRootCol:m,hasParentCol:g,numParentCols:b,parentFirst:f,parentLast:C,rowIsFixedWidth:w,userCanResizeRows:A,hasRules:y,rulesTextModule:B,rulesTypeModule:S,rulesTextCol:k,rulesTypeCol:h,colHasRules:c,hasRowInside:u})),BACheetah._buildOverlayOverflowMenu(l),BACheetah._initColDragResizing()),x("body").addClass("ba-cheetah-block-overlay-muted"))},_moduleHeaderMouseenter:function(e){console.log("***header")},_moduleMouseleave:function(e){var t=x(this),a=(t.find(".ba-cheetah-module").length,0<t.parent().closest(".ba-cheetah-module").length),i=x(e.target),t=x(e.toElement)||x(e.relatedTarget),e=t.is("#tiptip_holder"),t=0<t.closest("#tiptip_holder").length;i.closest(".ba-cheetah-block-col-resize").length||e||t||(BACheetah._removeModuleOverlays(a),BACheetah._removeColHighlightGuides())},_removeModuleOverlays:function(e){var t=x(".ba-cheetah-module");t.removeClass("ba-cheetah-block-overlay-active"),t.find(".ba-cheetah-module-overlay").remove(),x("body").removeClass("ba-cheetah-block-overlay-muted"),BACheetah._closeAllSubmenus()},_moduleDragHelper:function(e,t){return x('<div class="ba-cheetah-block-drag-helper">'+t.attr("data-name")+"</div>")},_moduleDragInit:function(e){var t=x(e.target).closest(".ba-cheetah-module");BACheetah._blockDragInit(e),t.append('<div class="ba-cheetah-module-sortable-proxy"></div>'),e.target=t.find(".ba-cheetah-module-sortable-proxy")[0],t.trigger(e)},_moduleDragInitTouch:function(t){var e=x(t.target),a=e.closest(".ba-cheetah-module"),i=!1;e.on("touchmove",function(e){i||(t.currentTarget=a[0],BACheetah._moduleDragInit(t),i=!0),e.target=a.find(".ba-cheetah-module-sortable-proxy")[0],x(e.target).trigger(e)}),e.on("touchend",function(e){e.target=a.find(".ba-cheetah-module-sortable-proxy")[0],x(e.target).trigger(e),e.stopPropagation(),a.find(".ba-cheetah-module-sortable-proxy").remove()})},_moduleDragStart:function(e,t){x(t.item).data("original-position",t.item.index()),BACheetah._removeRowOverlays(),BACheetah._blockDragStart(e,t)},_moduleDragStop:function(e,t){BACheetah._blockDragStop(e,t);var a=t.item,i=a.parent(),o=null,h=0,s=0;if(x(".ba-cheetah-module-sortable-proxy").remove(),0<=x.inArray(a.attr("data-type"),BACheetah._disabledModules))return a.remove(),void BACheetah._showProMessage(BACheetah._disabledModulesFull[a.attr("data-type")].name);if(a.parent().closest(".ba-cheetah-module").length&&BACheetahConfig.modulesRowInsideEnabled.includes(a.attr("data-type")))return a.remove(),void BACheetah.alert(BACheetahStrings.dropModuleRecursivellyMessage);if(i.hasClass("ba-cheetah-modules")||i.hasClass("ba-cheetah-widgets"))a.remove();else{if(a.hasClass("ba-cheetah-block")){if(i.hasClass("ba-cheetah-sortable-disabled"))return a.remove(),void BACheetah._showPanel();i.hasClass("ba-cheetah-row-drop-target")?(i=a.closest(".ba-cheetah-content"),s=0,o=a.closest(".ba-cheetah-row"),h=i.find(".ba-cheetah-row").index(o)):i.hasClass("ba-cheetah-col-group-drop-target")?(s=(i=a.closest(".ba-cheetah-row-content")).closest(".ba-cheetah-row").attr("data-node"),o=a.closest(".ba-cheetah-col-group"),h=i.find(" > .ba-cheetah-col-group").index(o)):i.hasClass("ba-cheetah-col-drop-target")?(s=(i=a.closest(".ba-cheetah-col-group")).attr("data-node"),o=a.closest(".ba-cheetah-col"),h=i.find(" > .ba-cheetah-col").index(o)):(h=i.find("> .ba-cheetah-module, .ba-cheetah-col-group, .ba-cheetah-block").index(a),s=a.closest(".ba-cheetah-col").attr("data-node")),a.closest(".ba-cheetah-drop-target-last").length&&(h+=1),BACheetah._addModule(i,s,a.attr("data-type"),h,a.attr("data-widget"),a.attr("data-alias")),a.remove()}else{if(i.hasClass("ba-cheetah-sortable-disabled"))return x(e.target).append(t.item),x(e.target).children().eq(t.item.data("original-position")).before(t.item),void BACheetah._highlightEmptyCols();i.hasClass("ba-cheetah-row-drop-target")?(o=a.closest(".ba-cheetah-row"),h=a.closest(".ba-cheetah-content").children(".ba-cheetah-row").index(o),h=a.closest(".ba-cheetah-drop-target-last").length?h+1:h,BACheetah._addRow("1-col",h,a.attr("data-node")),a.remove()):i.hasClass("ba-cheetah-col-group-drop-target")?(o=a.closest(".ba-cheetah-col-group"),h=a.closest(".ba-cheetah-row-content ").find(" > .ba-cheetah-col-group").index(o),h=a.closest(".ba-cheetah-drop-target-last").length?h+1:h,BACheetah._addColGroup(a.closest(".ba-cheetah-row").attr("data-node"),"1-col",h,a.attr("data-node")),a.remove()):i.hasClass("ba-cheetah-col-drop-target")?(o=a.closest(".ba-cheetah-col"),h=a.closest(".ba-cheetah-col-drop-target-last").length?"after":"before",BACheetah._addCols(o,h,"1-col",0<a.closest(".ba-cheetah-col-group-nested").length,a.attr("data-node")),a.remove()):BACheetah._reorderModule(a)}BACheetah._resizeLayout()}},_reorderModule:function(e){var t=e.closest(".ba-cheetah-col").attr("data-node"),a=e.attr("data-parent"),i=e.attr("data-node"),o=e.index();t==a?BACheetah._reorderNode(i,o):(e.attr("data-parent",t),BACheetah._moveNode(t,i,o))},_deleteModuleClicked:function(e){var t=x(this).closest(".ba-cheetah-module");confirm(BACheetahStrings.deleteModuleMessage)&&(BACheetah._deleteModule(t),BACheetah._removeAllOverlays()),e.stopPropagation()},_deleteModule:function(e){var t=e.closest(".ba-cheetah-row"),a=e.attr("data-node");BACheetah.ajax({action:"delete_node",node_id:a}),e.empty(),e.remove(),t.removeClass("ba-cheetah-block-overlay-muted"),BACheetah._highlightEmptyCols(),BACheetah._removeAllOverlays(),BACheetah.triggerHook("didDeleteModule",{nodeId:a,moduleType:e.attr("data-type")})},_moduleCopyClicked:function(e){var t=x(window),a=x(this).closest(".ba-cheetah-module"),i=a.attr("data-node"),o=a.parent(),h=a.clone(),s=x(".ba-cheetah-module-settings[data-node="+i+"]"),n=null;s.length&&(n=BACheetah._getSettings(s),BACheetahSettingsConfig.nodes[i]=n),h.addClass("ba-cheetah-node-"+i+"-clone ba-cheetah-node-clone"),h.find(".ba-cheetah-block-overlay").remove(),a.after(h),BACheetah._showNodeLoading(i+"-clone"),t.scrollTop()+t.height()<h.offset().top&&x("html, body").animate({scrollTop:h.offset().top+h.height()-t.height()},500),BACheetah.ajax({action:"copy_module",node_id:i,settings:n},function(e){e=BACheetah._jsonParse(e);e.nodeParent=o,e.nodePosition=o.find(" > .ba-cheetah-col-group, > .ba-cheetah-module").index(h),e.duplicatedModule=i,e.onAddNewHTML=function(){h.remove()},BACheetah._moduleCopyComplete(e)}),e.stopPropagation()},_moduleCopyComplete:function(e){BACheetah._renderLayout(e,function(){BACheetah.triggerHook("didDuplicateModule",{newNodeId:e.nodeId,oldNodeId:e.duplicatedModule,moduleType:e.moduleType})})},_moduleSettingsClicked:function(e){var t=x(this),a=t.closest(".ba-cheetah-module").attr("data-type"),i=t.closest(".ba-cheetah-module").attr("data-name"),o=t.closest(".ba-cheetah-module").attr("data-node"),h=t.closest(".ba-cheetah-col").attr("data-node"),t=0<t.closest(".ba-cheetah-block-overlay-global").length;e.stopPropagation(),-1==jQuery.inArray(a,BACheetah._disabledModules)?BACheetah._colResizing||t&&!BACheetahConfig.userCanEditGlobalTemplates||BACheetah._showModuleSettings({type:a,nodeId:o,parentId:h,global:t}):BACheetah._showProMessage(i)},_showModuleSettings:function(e,t){if(BACheetahSettingsConfig.modules){var a=BACheetahSettingsConfig.modules[e.type],i=e.settings||BACheetahSettingsConfig.nodes[e.nodeId],o=x("head");if(-1===x.inArray(e.type,BACheetah._loadedModuleAssets)){if(""!==a.assets.cssurl){let e=document.createElement("link");e.href=a.assets.cssurl,e.rel="stylesheet",o.append(e)}if(""!==a.assets.jsurl){let e=document.createElement("script");e.src=a.assets.jsurl,o.append(e)}BACheetah._loadedModuleAssets.push(e.type)}BACheetahSettingsForms.render({type:"module",id:e.type,nodeId:e.nodeId,className:"ba-cheetah-module-settings ba-cheetah-"+e.type+"-settings",attrs:'data-node="'+e.nodeId+'" data-parent="'+e.parentId+'" data-type="'+e.type+'"',buttons:e.global||BACheetahConfig.simpleUi?[]:["save-as"],badges:e.global?[BACheetahStrings.global]:[],settings:i,legacy:e.legacy,helper:BACheetah._moduleHelpers[e.type],rules:BACheetah._moduleHelpers[e.type]?BACheetah._moduleHelpers[e.type].rules:null,messages:BACheetah._moduleHelpers[e.type]?BACheetah._moduleHelpers[e.type].messages:null,hide:!(BACheetahConfig.userCanEditGlobalTemplates||!e.global),preview:{type:"module",layout:e.layout,callback:function(){BACheetah.triggerHook("didAddModule",{nodeId:e.nodeId,moduleType:i.type})}}},t)}},_saveModuleClicked:function(){var e=x(this).closest(".ba-cheetah-settings"),t=e.attr("data-type"),a=(e.attr("data-node"),BACheetah._moduleHelpers[t]),t=!0;void 0!==a&&(e.find("label.error").remove(),e.validate().hideErrors(),t=(t=e.validate().form())&&a.submit()),t?BACheetah._saveSettings():BACheetah._toggleSettingsTabErrors()},_addModule:function(e,t,a,i,o,h){BACheetah._showNodeLoadingPlaceholder(e,i),e.hasClass("ba-cheetah-col-group")?(BACheetah._newModuleParent=null,BACheetah._newModulePosition=0):(BACheetah._newModuleParent=e,BACheetah._newModulePosition=i),BACheetah.ajax({action:"render_new_module",parent_id:t,type:a,position:i,node_preview:1,widget:void 0===o?"":o,alias:void 0===h?"":h},BACheetah._addModuleComplete)},_addModuleComplete:function(e){var t=BACheetah._jsonParse(e);t.layout&&(BACheetah._newModuleParent&&BACheetah._newModuleParent.find(".ba-cheetah-node-loading-placeholder").hide(),t.layout.nodeParent=BACheetah._newModuleParent,t.layout.nodePosition=BACheetah._newModulePosition),t.settings||(t.settings=BACheetahSettingsConfig.defaults.modules[t.type]),x("form.ba-cheetah-settings").length?t.layout&&BACheetah._renderLayout(t.layout):BACheetah._showModuleSettings(t,function(){x(".ba-cheetah-module-settings").data("new-module","1"),"widget"==t.type&&BACheetahConfig.userSettings.pinned.position&&BACheetah._saveSettings()})},registerModuleHelper:function(e,t){BACheetah._moduleHelpers[e]=x.extend({},{rules:{},init:function(){},submit:function(){return!0},preview:function(){}},t)},_registerModuleHelper:function(e,t){BACheetah.registerModuleHelper(e,t)},_showNodeTemplateSettings:function(e){var t=x(".ba-cheetah-settings-lightbox .ba-cheetah-settings"),a=t.attr("data-node"),i=BACheetahStrings.saveModule;if(t.hasClass("ba-cheetah-row-settings")?i=BACheetahStrings.saveRow:t.hasClass("ba-cheetah-col-settings")&&(i=BACheetahStrings.saveColumn),!BACheetah._triggerSettingsSave(!1,!1,!1))return!1;BACheetahSettingsForms.render({id:"node_template",nodeId:a,title:i,attrs:'data-node="'+a+'"',className:"ba-cheetah-node-template-settings",rules:{name:{required:!0}}},function(){BACheetahConfig.userCanEditGlobalTemplates||x("#ba-cheetah-field-global").hide()})},_saveNodeTemplate:function(){var e=x(".ba-cheetah-node-template-settings"),t=e.attr("data-node");e.validate().form()&&(BACheetah._showNodeLoading(t),BACheetah.ajax({action:"save_node_template",node_id:t,settings:BACheetah._getSettings(e)},function(e){BACheetah._saveNodeTemplateComplete(e),BACheetah._hideNodeLoading(t)}),BACheetah._lightbox.close())},_saveNodeTemplateComplete:function(e){var t,a=BACheetah._jsonParse(e),i=x(".ba-cheetah-saved-"+a.type+"s"),o=i.find(".ba-cheetah-block"),h=null,s=a.name.toLowerCase(),n=0,l=wp.template("ba-cheetah-node-template-block"),e={name:a.name,isGlobal:a.global,content:a.type,id:a.id,postID:a.postID,kind:"template",type:"user",link:a.link,category:{uncategorized:BACheetahStrings.uncategorized}};if(BACheetahConfig.contentItems.template.push(e),BACheetah.triggerHook("contentItemsChanged"),a.layout&&(BACheetah._renderLayout(a.layout),BACheetah.triggerHook("didSaveGlobalNodeTemplate",a.config)),0===o.length)i.append(l(a));else for(;n<o.length;n++){if(t=(h=o.eq(n)).text().toLowerCase().trim(),0===n&&s<t){i.prepend(l(a));break}if(s<t){h.before(l(a));break}if(o.length-1===n){i.append(l(a));break}}i.find(".ba-cheetah-block-no-node-templates").remove()},_collapseSavedTemplates:function(e){const t=x(e.target).closest(".ba-cheetah-settings-section");t.find(".ba-cheetah-blocks-section-content").slideToggle(300,function(e){t.toggleClass("ba-cheetah-settings-section-collapsed")})},_nodeTemplateDragStop:function(a,e){BACheetah._blockDragStop(a,e);var t=e.item,i=t.parent(),o=null,h=0,e=null,s="",n=null;if(content_central_id=0,i.hasClass("ba-cheetah-blocks-section-content"))t.remove();else{if(t.hasClass("ba-cheetah-block-saved-row")||t.hasClass("ba-cheetah-block-row-template"))h=(e=t.closest(".ba-cheetah-row")).length?x(BACheetah._contentClass+" .ba-cheetah-row").index(e):0,h=i.hasClass("ba-cheetah-drop-target-last")?h+1:h,o=null,s="render_new_row_template",n=BACheetah._addRowComplete,BACheetah._newRowPosition=h,BACheetah._showNodeLoadingPlaceholder(x(BACheetah._contentClass),h);else if(t.hasClass("ba-cheetah-block-saved-column")){if(e=t.closest(".ba-cheetah-col"),colGroup=i.closest(".ba-cheetah-col-group"),colGroupId=colGroup.attr("data-node"),s="render_new_col_template",n=BACheetah._addColsComplete,i.hasClass("ba-cheetah-sortable-disabled"))return t.remove(),void BACheetah._showPanel();i.hasClass("ba-cheetah-row-drop-target")?(e=t.closest(".ba-cheetah-row"),o=0,i=x(BACheetah._contentClass),h=e.length?i.find(".ba-cheetah-row").index(e):0):i.hasClass("ba-cheetah-col-group-drop-target")?(i=t.closest(".ba-cheetah-row-content"),o=t.closest(".ba-cheetah-row").attr("data-node"),h=t.closest(".ba-cheetah-row").find(".ba-cheetah-row-content > .ba-cheetah-col-group").index(t.closest(".ba-cheetah-col-group"))):i.hasClass("ba-cheetah-col-drop-target")&&(h=(i=t.closest(".ba-cheetah-col-group")).children(".ba-cheetah-col").index(t.closest(".ba-cheetah-col")),o=i.attr("data-node")),t.closest(".ba-cheetah-drop-target-last").length&&(h+=1),i.hasClass("ba-cheetah-col-group")?BACheetah._newColParent=null:BACheetah._newColParent=i,BACheetah._newColPosition=h,BACheetah._showNodeLoadingPlaceholder(i,h)}else if(t.hasClass("ba-cheetah-block-saved-module")||t.hasClass("ba-cheetah-block-module-template")){if(s="render_new_module",n=BACheetah._addModuleComplete,i.hasClass("ba-cheetah-sortable-disabled"))return t.remove(),void BACheetah._showPanel();i.hasClass("ba-cheetah-row-drop-target")?(o=0,h=(i=t.closest(".ba-cheetah-content")).find(".ba-cheetah-row").index(t.closest(".ba-cheetah-row"))):i.hasClass("ba-cheetah-col-group-drop-target")?(o=(i=t.closest(".ba-cheetah-row-content")).closest(".ba-cheetah-row").attr("data-node"),h=i.find(" > .ba-cheetah-col-group").index(t.closest(".ba-cheetah-col-group"))):o=i.hasClass("ba-cheetah-col-drop-target")?(h=(i=t.closest(".ba-cheetah-col-group")).children(".ba-cheetah-col").index(t.closest(".ba-cheetah-col")),i.attr("data-node")):(h=i.children(".ba-cheetah-module, .ba-cheetah-block").index(t),t.closest(".ba-cheetah-col").attr("data-node")),t.closest(".ba-cheetah-drop-target-last").length&&(h+=1),i.hasClass("ba-cheetah-col-group")?(BACheetah._newModuleParent=null,BACheetah._newModulePosition=0):(BACheetah._newModuleParent=i,BACheetah._newModulePosition=h),BACheetah._showNodeLoadingPlaceholder(i,h)}BACheetah.ajax({action:s,template_id:t.attr("data-id"),template_type:t.attr("data-type"),parent_id:o,position:h,content_central_id:t.attr("data-content-central-id")},function(e){var t;-1<s.indexOf("row")||-1<s.indexOf("col")?(t=BACheetah._jsonParse(e),BACheetah._hasBaCheetahError(t)?(x(".ba-cheetah-node-loading-placeholder").remove(),BACheetah._rowDragInit(a)):(-1<s.indexOf("row")?BACheetah.triggerHook("didApplyRowTemplateComplete",t.config):BACheetah.triggerHook("didApplyColTemplateComplete",t.config),n(t.layout))):n(e)}),t.remove()}},_hasBaCheetahError:function(e){return!!e.ba_cheetah_error&&(BACheetah.alert(e.ba_cheetah_error),!0)},_editNodeTemplateClicked:function(e){e.preventDefault(),e.stopPropagation(),window.open(x(this).attr("href"))},_deleteNodeTemplateClicked:function(e){var t=x(e.target),a=t.closest(".ba-cheetah-blocks-section").find(".ba-cheetah-blocks-section-content"),i=a.find(".ba-cheetah-block"),o=t.closest(".ba-cheetah-block"),h=o.hasClass("ba-cheetah-block-global"),e=h?BACheetah._updateLayout:void 0,t=h?BACheetahStrings.deleteGlobalTemplate:BACheetahStrings.deleteTemplate;confirm(t)&&(o.remove(),1===i.length&&(o.hasClass("ba-cheetah-block-saved-row")?a.append('<span class="ba-cheetah-block-no-node-templates">'+BACheetahStrings.noSavedRows+"</span>"):a.append('<span class="ba-cheetah-block-no-node-templates">'+BACheetahStrings.noSavedModules+"</span>")),o.hasClass("ba-cheetah-block-global")&&BACheetah.showAjaxLoader(),BACheetah.ajax({action:"delete_node_template",template_id:o.attr("data-id")},e),h=_.findIndex(BACheetahConfig.contentItems.template,{id:o.attr("data-id"),type:"user"}),BACheetahConfig.contentItems.template.splice(h,1),BACheetah.triggerHook("contentItemsChanged"))},_initSettingsForms:function(){BACheetah._initSettingsSections(),BACheetah._initButtonGroupFields(),BACheetah._initCompoundFields(),BACheetah._CodeFieldSSLCheck(),BACheetah._initCodeFields(),BACheetah._initColorPickers(),BACheetah._initGradientPickers(),BACheetah._initIconFields(),BACheetah._initPhotoFields(),BACheetah._initSelectFields(),BACheetah._initEditorFields(),BACheetah._initMultipleFields(),BACheetah._initAutoSuggestFields(),BACheetah._initLinkFields(),BACheetah._initFontFields(),BACheetah._initOrderingFields(),BACheetah._initTimezoneFields(),BACheetah._initDimensionFields(),BACheetah._initFieldPopupSliders(),BACheetah._initPresetFields(),BACheetah._initDragDropFields(),BACheetah._calculateSettingsTabsOverflow(),BACheetah._lightbox._resizeEditors(),x(".ba-cheetah-settings-fields").css("visibility","visible"),x(".ba-cheetah-settings button").on("click",function(e){e.preventDefault()}),BACheetah.triggerHook("settings-form-init")},_destroySettingsForms:function(){BACheetah._destroyEditorFields()},_setSettingsFormContent:function(e){x(".ba-cheetah-legacy-settings").remove(),x("body").append(e)},_settingsTabClicked:function(e){var t=x(this),a=t.closest(".ba-cheetah-settings"),t=t.attr("href").split("#").pop();BACheetah._resetSettingsTabsState(),a.find(".ba-cheetah-settings-tab").removeClass("ba-cheetah-active"),a.find("#"+t).addClass("ba-cheetah-active"),a.find(".ba-cheetah-settings-tabs .ba-cheetah-active").removeClass("ba-cheetah-active"),a.find("a[href*="+t+"]").addClass("ba-cheetah-active"),BACheetahConfig.rememberTab?localStorage.setItem("ba-cheetah-settings-tab",t):localStorage.setItem("ba-cheetah-settings-tab",""),BACheetah._focusFirstSettingsControl(),e.preventDefault()},_resetSettingsTabsState:function(){var e=x(".bal-cheetah-lightbox:visible");BACheetah._hideTabsOverflowMenu(),e.find(".ba-cheetah-settings-tabs .ba-cheetah-active").removeClass("ba-cheetah-active"),e.find(".ba-cheetah-settings-tabs-overflow-menu .ba-cheetah-active").removeClass("ba-cheetah-active"),e.find(".ba-cheetah-contains-active").removeClass("ba-cheetah-contains-active")},_calculateSettingsTabsOverflow:function(){var e=x(".bal-cheetah-lightbox:visible"),t=e.outerWidth(),a=e.hasClass("ba-cheetah-lightbox-width-slim"),i=e.find(".ba-cheetah-settings-tabs"),o=e.find(".ba-cheetah-settings-tabs-overflow-menu"),h=e.find(".ba-cheetah-settings-tabs-more"),i=i.find("a"),s=!1,n=t-60,l=0,r=a?16:30;o.html(""),BACheetah._hideTabsOverflowMenu(),i.removeClass("ba-cheetah-overflowed"),i.each(function(){return!x(this).is(":visible")||(s||(t=x(this).textWidth()+r+12,n<=(l+=t)&&(s=!0)),void(s?(a=x(this).html(),e=x(this).attr("href"),t="",x(this).hasClass("ba-cheetah-active")&&(t="ba-cheetah-active"),x(this).hasClass("error")&&(t+=" error"),a=x('<a href="'+e+'" '+(t=""!==t?'class="'+t+'"':t)+">"+a+"</a>"),o.append(a),x(this).addClass("ba-cheetah-overflowed")):x(this).removeClass("ba-cheetah-overflowed")));var e,t,a}),s?e.addClass("ba-cheetah-lightbox-has-tab-overflow"):e.removeClass("ba-cheetah-lightbox-has-tab-overflow"),0<o.find(".ba-cheetah-active").length?h.addClass("ba-cheetah-contains-active"):h.removeClass("ba-cheetah-contains-active"),0<o.find(".error").length?h.addClass("ba-cheetah-contains-errors"):h.removeClass("ba-cheetah-contains-errors")},_settingsTabsToOverflowMenuItemClicked:function(e){var t=x(e.currentTarget),a=t.attr("href"),i=t.closest(".ba-cheetah-lightbox-header-wrap").find(".ba-cheetah-settings-tabs"),a=i.find('a[href="'+a+'"]'),i=i.find(".ba-cheetah-settings-tabs-more");BACheetah._resetSettingsTabsState(),a.trigger("click"),t.addClass("ba-cheetah-active"),i.addClass("ba-cheetah-contains-active"),BACheetah._hideTabsOverflowMenu(),e.preventDefault()},_hasOverflowTabs:function(){return 0<x(".bal-cheetah-lightbox:visible").find(".ba-cheetah-settings-tabs-overflow-menu a").length},_showTabsOverflowMenu:function(){var e;BACheetah._hasOverflowTabs()&&((e=x(".bal-cheetah-lightbox:visible")).find(".ba-cheetah-settings-tabs-overflow-menu").css("display","flex"),e.find(".ba-cheetah-settings-tabs-overflow-click-mask").show(),this.isShowingSettingsTabsOverflowMenu=!0)},_hideTabsOverflowMenu:function(){var e=x(".bal-cheetah-lightbox:visible");e.find(".ba-cheetah-settings-tabs-overflow-menu").css("display","none"),e.find(".ba-cheetah-settings-tabs-overflow-click-mask").hide(),this.isShowingSettingsTabsOverflowMenu=!1},_toggleTabsOverflowMenu:function(e){BACheetah.isShowingSettingsTabsOverflowMenu?BACheetah._hideTabsOverflowMenu():BACheetah._showTabsOverflowMenu(),e.stopPropagation()},_initSettingsSections:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-settings-section").each(BACheetah._initSection)},_settingsCancelClicked:function(e){var t=x(".ba-cheetah-lightbox[data-parent]"),a=x(".ba-cheetah-module-settings"),i=null,o=null,h=null,s="column"==BACheetahConfig.userTemplateType;0<t.length?BACheetah._closeNestedSettings():(0<a.length&&void 0!==a.data("new-module")?(i=x(BACheetah.preview.state.html),h=(o=x(".ba-cheetah-node-"+a.data("node"))).closest(".ba-cheetah-col"),0<i.find(".ba-cheetah-node-"+h.data("node")).length||s?BACheetah._deleteModule(o):BACheetah._deleteCol(h)):BACheetah.preview&&BACheetah.preview.type&&"global"==BACheetah.preview.type||"page"==BACheetah.preview.type?BACheetah.preview.revertGlobalPagePreview():BACheetah.preview&&BACheetah.preview.revert(),BACheetah.preview=null,BACheetahLightbox.closeParent(this),BACheetah.triggerHook("didCancelNodeSettings"))},_focusFirstSettingsControl:function(){var e=x(".ba-cheetah-settings:visible"),t=e.find(".ba-cheetah-settings-tab.ba-cheetah-active"),e=e.data("node"),a=t.find(".ba-cheetah-field").first(),t=a.find('input:not([type="hidden"]), textarea, select, button, a, .ba-cheetah-editor-field').first();e&&x(".ba-cheetah-node-"+e+" .ba-cheetah-inline-editor").length||("undefined"!=typeof tinyMCE&&t.hasClass("ba-cheetah-editor-field")&&(t=t.find("textarea.wp-editor-area").attr("id"),tinyMCE.get(t).focus()),a.on("animationend",function(){a.css("animation-name","")}))},_initSettingsValidation:function(e,t){x(".ba-cheetah-settings").last().validate({ignore:".ba-cheetah-ignore-validation",rules:e,messages:t=t||{},errorPlacement:BACheetah._settingsErrorPlacement})},_settingsErrorPlacement:function(e,t){e.appendTo(t.parent())},_toggleSettingsTabErrors:function(){for(var e,t=x(".ba-cheetah-settings:visible"),a=t.find(".ba-cheetah-settings-tab"),i=null,o=0;o<a.length;o++)e=(i=a.eq(o)).find("label.error"),tabLink=t.find(".ba-cheetah-settings-tabs a[href*="+i.attr("id")+"]"),tabLink.find(".ba-cheetah-error-icon").remove(),tabLink.removeClass("error"),0<e.length&&(tabLink.append('<span class="ba-cheetah-error-icon"></span>'),tabLink.addClass("error"));BACheetah._calculateSettingsTabsOverflow()},_getSettings:function(e){BACheetah._updateEditorFields();for(var t,a,i=e.serializeArray(),o=0,h=0,s="",n=[],l=[],r={},o=0;o<i.length;o++)if(t=i[o].value.replace(/\r/gm,"").replace(/&#39;/g,"'"),!(-1<i[o].name.indexOf("flrich")))if(-1<i[o].name.indexOf("[")){for(a=i[o].name.replace(/\[(.*)\]/,""),n=[],l=(s=i[o].name.replace(a,"")).match(/\[[^\]]*\]/g),h=0;h<l.length;h++)"[]"!=l[h]&&n.push(l[h].replace(/\[|\]/g,""));s.match(/\[\]\[[^\]]*\]\[[^\]]+\]/)||s.match(/\[\]\[[^\]]*\]\[\]\[[^\]]+\]/)?(void 0===r[a]&&(r[a]={}),void 0===r[a][n[0]]&&(r[a][n[0]]={}),r[a][n[0]][n[1]]=t):s.match(/\[\]\[[^\]]*\]\[\]/)?(void 0===r[a]&&(r[a]={}),void 0===r[a][n[0]]&&(r[a][n[0]]=[]),r[a][n[0]].push(t)):s.match(/\[\]\[[^\]]*\]/)?(void 0===r[a]&&(r[a]={}),r[a][n[0]]=t):s.match(/\[\]/)&&(void 0===r[a]&&(r[a]=[]),r[a].push(t))}else r[i[o].name]=t;for(s in r)if(void 0!==r["as_values_"+s]){r[s]=x.grep(r["as_values_"+s].split(","),function(e){return""!==e}).join(",");try{delete r["as_values_"+s]}catch(e){}}return x.each(e.find("[name]"),function(e,t){t=x(t).attr("name").replace(/\[(.*)\]/,"");t in r||(r[t]="")}),r=x.extend({},BACheetah._getOriginalSettings(e),r)},_getSettingsJSONForHTML:function(e){return JSON.stringify(e).replace(/\'/g,"&#39;").replace("<wbr />","<wbr>")},_getOriginalSettings:function(e,t){var a=e.find(".ba-cheetah-settings-json"),i=e.data("node"),e=BACheetahSettingsConfig.nodes,o=null,h={};if(i&&e[i]?o=e[i]:a.length&&(o=BACheetah._jsonParse(a.val().replace(/&#39;/g,"'"))),o)for(key in o)(x("#ba-cheetah-field-"+key).length||t)&&(h[key]=o[key]);return h},_getSettingsForChangedCheck:function(e,t){var a=BACheetah._getSettings(t);if(e){t=x(".ba-cheetah-node-"+e);if(t.hasClass("ba-cheetah-module")){t=t.data("type"),t=BACheetahSettingsConfig.editables[t];if(t&&BACheetahSettingsConfig.nodes[e])for(var i in t)a[i]=BACheetahSettingsConfig.nodes[e][i]}}return a},_saveSettings:function(e){var t=x(".ba-cheetah-settings-lightbox .ba-cheetah-settings"),a=t.data("new-module"),i=t.attr("data-node"),o=BACheetah._getSettings(t),h=BACheetah.preview;function s(){BACheetah._showNodeLoading(i),BACheetahSettingsConfig.nodes[i]=o,BACheetah.ajax({action:"save_settings",node_id:i,settings:o},BACheetah._saveSettingsComplete.bind(this,e,h)),BACheetah.triggerHook("didSaveNodeSettings",{nodeId:i,settings:o}),BACheetah._lightbox.close()}!BACheetah.isUndefined(e)&&BACheetah.isBoolean(e)||(e=!0),h&&!h._settingsHaveChanged()&&BACheetah.isUndefined(a)?BACheetah._lightbox.close():BACheetahConfig.userCaps.unfiltered_html?s():(BACheetahSettingsForms.showLightboxLoader(),BACheetah.ajax({action:"verify_settings",settings:o},function(e){"true"===e?s():(msg='<p style="font-weight:bold;text-align:center;">'+BACheetahStrings.noScriptWarn.heading+"</p>",BACheetahConfig.userCaps.global_unfiltered_html?msg+="<p>"+BACheetahStrings.noScriptWarn.global+"</p>":msg+="<p>"+BACheetahStrings.noScriptWarn.message+"</p>",msg+='<p><div class="ba-cheetah-diff"></div></p>',BACheetahSettingsForms.hideLightboxLoader(),BACheetah.alert(msg),data=x.parseJSON(e),""!==data.diff&&(x(".ba-cheetah-diff").html(data.diff),x(".ba-cheetah-diff").prepend("<p>"+BACheetahStrings.codeErrorDetected+"</p>"),x(".ba-cheetah-diff .diff-deletedline").each(function(){(x(this).find("del").length<1?x(this).css("background-color","rgb(255, 192, 203, 0.7)").css("padding","10px"):x(this).find("del").css("background-color","rgb(255, 192, 203, 0.7)")).css("border","1px solid pink")}),console.log("============"),console.log("key: "+data.key),console.log("value: "+data.value),console.log("parsed: "+data.parsed),console.log("============")))}))},_saveSettingsComplete:function(e,t,a){var i=BACheetah._jsonParse(a),o=i.layout.nodeType,h=i.layout.moduleType,s="didSave"+o.charAt(0).toUpperCase()+o.slice(1)+"SettingsComplete",a=function(){t&&i.layout.partial&&i.layout.nodeId===t.nodeId&&(t.clear(),t=null)};!0===e?BACheetah._renderLayout(i.layout,a):a(),BACheetah.triggerHook("didSaveNodeSettingsComplete",{nodeId:i.node_id,nodeType:o,moduleType:h,settings:i.settings}),BACheetah.triggerHook(s,{nodeId:i.node_id,nodeType:o,moduleType:h,settings:i.settings})},_triggerSettingsSave:function(e,t,a){var i,o=BACheetah._lightbox._node.find("form.ba-cheetah-settings"),h=BACheetah._lightbox._node.data("instance-id"),s=BACheetahLightbox._instances[h],n=x(".ba-cheetah-lightbox-wrap[data-parent]:visible"),h=!0;return e=!_.isUndefined(e)&&e,t=!_.isUndefined(t)&&t,a=!!_.isUndefined(a)||a,o.length&&(n.length&&(n.find(".ba-cheetah-settings-save").trigger("click"),(n.find("label.error").length||x(".ba-cheetah-alert-lightbox:visible").length)&&(h=!1)),h&&!o.validate().form()&&(h=!1),i=BACheetahSettingsForms.settingsHaveChanged(),h&&i&&(e&&s.disableClose(),o.find(".ba-cheetah-settings-save").trigger("click"),e&&s.enableClose(),(o.find("label.error").length||x(".ba-cheetah-alert-lightbox:visible").length)&&(h=!1)),a&&(BACheetah._destroySettingsForms(),!i&&BACheetah.preview&&(BACheetah.preview.clear(),BACheetah.preview=null)),i||e||s.close()),h?BACheetah.triggerHook("didTriggerSettingsSave"):(BACheetah.triggerHook("didFailSettingsSave"),BACheetah._toggleSettingsTabErrors(),t&&!x(".ba-cheetah-alert-lightbox:visible").length&&BACheetah.alert(BACheetahStrings.settingsHaveErrorsCorrect,BACheetahStrings.settingsHaveErrors,"ba-cheetah-lightbox-confirm-icon","validation-error.svg")),h},_refreshSettingsPreviewReference:function(){BACheetah.preview&&BACheetah.preview._initElementsAndClasses()},_openNestedSettings:function(e){e.className&&-1===e.className.indexOf("ba-cheetah-settings-lightbox")&&(e.className+=" ba-cheetah-settings-lightbox"),e=x.extend({className:"ba-cheetah-lightbox  ba-cheetah-settings-lightbox",destroyOnClose:!0,resizable:!0},e);var t=x(".ba-cheetah-lightbox-wrap:visible"),a=t.find(".bal-cheetah-lightbox"),i=new BACheetahLightbox(e),o=i._node,e=o.find(".bal-cheetah-lightbox");return t.hide(),o.attr("data-parent",t.attr("data-instance-id")),e.attr("style",a.attr("style")),i.on("resized",BACheetah._calculateSettingsTabsOverflow),i.open('<div class="ba-cheetah-lightbox-loading"></div>'),i},_closeNestedSettings:function(){var e=x(".ba-cheetah-lightbox[data-parent]:visible"),t=e.find(".bal-cheetah-lightbox"),a=e.attr("data-instance-id"),a=BACheetahLightbox._instances[a],e=e.attr("data-parent"),i=x('[data-instance-id="'+e+'"]'),o=i.find(".bal-cheetah-lightbox"),h=i.find("form"),s=BACheetahLightbox._instances[e];a&&(a.on("close",function(){o.attr("style",t.attr("style")),i.show(),s._resize(),i.find("label.error").remove(),h.validate().hideErrors(),BACheetah._toggleSettingsTabErrors(),BACheetah._initMultipleFields()}),a.close())},_showHelpTooltip:function(){x(this).siblings(".ba-cheetah-help-tooltip-text").fadeIn()},_hideHelpTooltip:function(){x(this).siblings(".ba-cheetah-help-tooltip-text").fadeOut()},_initSection:function(){var t=x(this);t.find(".ba-cheetah-settings-section-header").on("click",function(){t.siblings().has(".ba-cheetah-settings-section-header").addClass("ba-cheetah-settings-section-collapsed").find(".ba-cheetah-settings-section-content").slideUp(300),t.find(".ba-cheetah-settings-section-content").slideToggle(300,function(e){t.toggleClass("ba-cheetah-settings-section-collapsed")})})},_initButtonGroupFields:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-button-group-field").each(BACheetah._initButtonGroupField)},_initButtonGroupField:function(){var e=x(this),a=e.find(".ba-cheetah-button-group-field-option"),i=e.find("input"),t="true"==i.attr("data-unselectable");a.on("click",function(){var e=x(this);"1"==e.attr("data-selected")?t&&(e.attr("data-selected","0"),i.val("").trigger("change")):(a.attr("data-selected","0"),e.attr("data-selected","1"),i.val(e.data("value")).trigger("change"))}),i.on("change",function(e){var t=i.val(),t=a.filter('[data-value="'+t+'"]');a.attr("data-selected","0"),t.attr("data-selected","1")})},_initCompoundFields:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-compound-field").each(BACheetah._initCompoundField)},_initCompoundField:function(){var e=x(this),t=e.find(".ba-cheetah-compound-field-section"),a=e.find(".ba-cheetah-compound-field-section-toggle"),e=e.find(".ba-cheetah-compound-field-setting").has(".ba-cheetah-dimension-field-units");t.each(function(){var e=x(this);e.find(".ba-cheetah-compound-field-section-toggle").length||e.addClass("ba-cheetah-compound-field-section-visible")}),a.on("click",function(){var e=x(this),t=e.closest(".ba-cheetah-field"),e="."+e.closest(".ba-cheetah-compound-field-section").attr("class").split(" ").join(".");t.find(e).toggleClass("ba-cheetah-compound-field-section-visible")}),e.each(function(){var e=x(this),t=e.find(".ba-cheetah-compound-field-label");t.length&&!e.find(".ba-cheetah-shadow-field").length&&t.append('<i class="ba-cheetah-dimension-field-link ba-cheetah-tip dashicons dashicons-admin-links" title="Link Values"></i>')})},_initAutoSuggestFields:function(){var t,a=x(".ba-cheetah-settings:visible .ba-cheetah-suggest-field"),e=null,i=null,o=[];a.each(function(){""!==(e=x(this)).attr("data-value")&&(BACheetahSettingsForms.showFieldLoader(e),o.push({name:e.attr("name"),value:e.attr("data-value"),action:e.attr("data-action"),data:e.attr("data-action-data")}))}),o.length?BACheetah.ajax({action:"get_autosuggest_values",fields:o},function(e){for(i in t=BACheetah._jsonParse(e))x('.ba-cheetah-suggest-field[name="'+i+'"]').attr("data-value",t[i]);a.each(BACheetah._initAutoSuggestField)}):a.each(BACheetah._initAutoSuggestField)},_initAutoSuggestField:function(){var e=x(this);e.autoSuggest(BACheetah._ajaxUrl({ba_cheetah_action:"ba_cheetah_autosuggest",ba_cheetah_as_action:e.data("action"),ba_cheetah_as_action_data:e.data("action-data"),_wpnonce:BACheetahConfig.ajaxNonce}),x.extend({},{asHtmlID:e.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:2,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:BACheetahStrings.noResultsFound,showResultListWhenNoMatch:!0,preFill:e.data("value"),queryParam:"ba_cheetah_as_query",afterSelectionAdd:BACheetah._updateAutoSuggestField,afterSelectionRemove:BACheetah._updateAutoSuggestField,selectionLimit:e.data("limit"),canGenerateNewSelections:!1},e.data("args"))),BACheetahSettingsForms.hideFieldLoader(e)},_updateAutoSuggestField:function(e,t,a){x(this).siblings(".as-values").val(a.join(",")).trigger("change")},_CodeFieldSSLCheck:function(){x("body").append('<div class="sg-test" style="display:none"><svg xmlns="http://www.w3.org/2000/svg"></svg></div>'),"https://www.w3.org/2000/svg"===x(".sg-test").find("svg").attr("xmlns")&&(BACheetah._codeDisabled=!0),x(".sg-test").remove()},_initCodeFields:function(){BACheetah._codeDisabled||x(".ba-cheetah-settings:visible").find(".ba-cheetah-code-field").each(BACheetah._initCodeField)},_initCodeField:function(){var e=x(this),h=e.closest(".ba-cheetah-settings"),t=e.find("textarea"),a=(t.attr("id"),t.data("editor")),i=t.data("wrap"),e=x("<div>",{position:"absolute",height:20*parseInt(t.attr("rows"),10)}),s=null,n=!(!h.hasClass("ba-cheetah-global-settings")&&!h.hasClass("ba-cheetah-layout-settings"));e.insertBefore(t),t.css("display","none"),ace.require("ace/ext/language_tools"),(s=ace.edit(e[0])).$blockScrolling=1/0,s.getSession().setValue(t.val()),s.getSession().setMode("ace/mode/"+a),i&&s.getSession().setUseWrapMode(!0),s.setOptions(BACheetahConfig.AceEditorSettings),s.getSession().on("change",function(e){t.val(s.getSession().getValue()).trigger("change")}),s.getSession().on("changeAnnotation",function(){for(var e=s.getSession().getAnnotations(),t=h.find(".ba-cheetah-settings-save"),a=h.find(".ba-cheetah-settings-error"),i=!1,o=0;o<e.length;o++)if(!(-1<e[o].text.indexOf("DOCTYPE")||-1<e[o].text.indexOf("Named entity expected")||-1<e[o].text.indexOf("@supports")||"error"!==e[o].type)){i=!0;break}val=s.getSession().getValue(),n&&i&&null!==val.match(/<\/iframe>|<\/script>/gm)&&(t.addClass("ba-cheetah-settings-error"),t.on("click",BACheetah._showCodeFieldCriticalError)),i&&!t.hasClass("ba-cheetah-settings-error")&&a.length&&BACheetahConfig.CheckCodeErrors&&(t.addClass("ba-cheetah-settings-error"),t.on("click",BACheetah._showCodeFieldError)),i||(a.removeClass("ba-cheetah-settings-error"),a.off("click",BACheetah._showCodeFieldError),a.off("click",BACheetah._showCodeFieldCriticalError))}),t.closest(".ba-cheetah-field").data("editor",s)},_showCodeFieldError:function(e){e.stopImmediatePropagation(),BACheetah.confirm({message:BACheetahStrings.codeError,cancel:function(){var e=x(".ba-cheetah-settings:visible .ba-cheetah-settings-save");e.removeClass("ba-cheetah-settings-error"),e.off("click",BACheetah._showCodeFieldError),e.trigger("click")},strings:{ok:BACheetahStrings.codeErrorFix,cancel:BACheetahStrings.codeErrorIgnore}})},_showCodeFieldCriticalError:function(e){e.stopImmediatePropagation(),BACheetah.alert(BACheetahStrings.codeerrorhtml)},_initMultipleFields:function(){var e=x(".ba-cheetah-settings:visible .ba-cheetah-field-multiples"),t=null,a=0,i=BACheetahConfig.isRtl?{left:10}:{right:10},o=e.attr("data-limit")||0,h=x("tbody.ba-cheetah-field-multiples").find("tr").length||0;for(0<parseInt(o)&&h-1>=parseInt(o)?(x(".ba-cheetah-field-copy").hide(),x(".ba-cheetah-field-add").fadeOut()):x(".ba-cheetah-field-copy, .ba-cheetah-field-add").show();a<e.length;a++)1===(t=e.eq(a).find(".ba-cheetah-field-multiple")).length?t.eq(0).find(".ba-cheetah-field-actions").addClass("ba-cheetah-field-actions-single"):t.find(".ba-cheetah-field-actions").removeClass("ba-cheetah-field-actions-single");x(".ba-cheetah-field-multiples").sortable({items:".ba-cheetah-field-multiple",cursor:"move",cursorAt:i,distance:5,opacity:.5,placeholder:"ba-cheetah-field-dd-zone",stop:BACheetah._fieldDragStop,tolerance:"pointer",axis:"y"})},_addFieldClicked:function(){var e,t=x(this),a=t.attr("data-field"),i=t.closest("tr").siblings("tr[data-field="+a+"]").last(),o=i.clone(),h=o.find(".ba-cheetah-form-field"),s=null,n=parseInt(i.find("label span.ba-cheetah-field-index").html(),10)+1;o.find("th label span.ba-cheetah-field-index").html(n),o.find(".ba-cheetah-form-field-preview-text").html(""),o.find(".ba-cheetah-form-field-before").remove(),o.find(".ba-cheetah-form-field-after").remove(),o.find("input, textarea, select").val(""),i.after(o),BACheetah._initMultipleFields(),h.length?(s=h.find(".ba-cheetah-form-field-edit").data("type"),h.find("input").val(JSON.stringify(BACheetahSettingsConfig.defaults.forms[s]))):(s=(h=t.closest("form.ba-cheetah-settings")).data("type"))&&h.hasClass("ba-cheetah-module-settings")&&(e=BACheetahSettingsConfig.defaults.modules[s][a][0],o.find("input, textarea, select").val(e))},_copyFieldClicked:function(){var e=x(this).closest("tr"),t=e.clone(),a=parseInt(e.find("label span.ba-cheetah-field-index").html(),10)+1;t.find("th label span.ba-cheetah-field-index").html(a),e.after(t),BACheetah._renumberFields(e.parent()),BACheetah._initMultipleFields(),BACheetah.preview.delayPreview()},_deleteFieldClicked:function(){var e=x(this).closest("tr"),t=e.parent();confirm(BACheetahStrings.deleteFieldMessage)&&(e.remove(),BACheetah._renumberFields(t),BACheetah._initMultipleFields(),BACheetah.preview.delayPreview())},_renumberFields:function(e){for(var t=e.find(".ba-cheetah-field-multiple"),a=0;a<t.length;a++)t.eq(a).find("th label span.ba-cheetah-field-index").html(a+1)},_fieldDragHelper:function(){return x('<div class="ba-cheetah-field-dd-helper"></div>')},_fieldDragStop:function(e,t){BACheetah._renumberFields(t.item.parent()),BACheetah.preview.delayPreview()},_initSelectFields:function(){var e=x(".ba-cheetah-settings:visible").find("select");e.on("change",BACheetah._settingsSelectChanged),e.trigger("change"),e.on("change",BACheetah._calculateSettingsTabsOverflow);e=x(".ba-cheetah-settings:visible").find(".ba-cheetah-button-group-field input[type=hidden]");e.on("change",BACheetah._settingsSelectChanged),e.trigger("change"),e.on("change",BACheetah._calculateSettingsTabsOverflow)},_settingsSelectChanged:function(){var e=x(this),t=e.attr("data-toggle"),a=e.attr("data-hide"),i=e.attr("data-trigger"),o=e.val(),h=0;e.attr("name");if(void 0!==t){for(h in t=BACheetah._jsonParse(t))BACheetah._settingsSelectToggle(t[h].fields,"hide","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(t[h].sections,"hide","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(t[h].tabs,"hide","a[href*=ba-cheetah-settings-tab-","]");void 0!==t[o]&&(BACheetah._settingsSelectToggle(t[o].fields,"show","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(t[o].sections,"show","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(t[o].tabs,"show","a[href*=ba-cheetah-settings-tab-","]"))}if(void 0!==a){for(h in a=BACheetah._jsonParse(a))BACheetah._settingsSelectToggle(a[h].fields,"show","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(a[h].sections,"show","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(a[h].tabs,"show","a[href*=ba-cheetah-settings-tab-","]");void 0!==a[o]&&(BACheetah._settingsSelectToggle(a[o].fields,"hide","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(a[o].sections,"hide","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(a[o].tabs,"hide","a[href*=ba-cheetah-settings-tab-","]"))}if(void 0!==i&&void 0!==(i=BACheetah._jsonParse(i))[o]&&void 0!==i[o].fields)for(h=0;h<i[o].fields.length;h++)x("#ba-cheetah-field-"+i[o].fields[h]).find("select").trigger("change")},_settingsSelectToggle:function(e,t,a,i){var o=0;if(i=void 0===i?"":i,void 0!==e)for(;o<e.length;o++)x(".ba-cheetah-settings:visible").find(a+e[o]+i)[t](),x(a+e[o]+i).parent().find('.ba-cheetah-field[data-type="code"]').each(function(){BACheetah._codeDisabled||x(this).data("editor").resize()})},_initColorPickers:function(){var e=BACheetahConfig.colorPresets||[];BACheetah.colorPicker=new BACheetahColorPicker({mode:"hsl",elements:".ba-cheetah-color-picker .ba-cheetah-color-picker-value",presets:e,labels:{colorPresets:BACheetahStrings.colorPresets,colorPicker:BACheetahStrings.colorPicker,placeholder:BACheetahStrings.placeholder,removePresetConfirm:BACheetahStrings.removePresetConfirm,noneColorSelected:BACheetahStrings.noneColorSelected,alreadySaved:BACheetahStrings.alreadySaved,noPresets:BACheetahStrings.noPresets,presetAdded:BACheetahStrings.presetAdded}}),x(BACheetah.colorPicker).on("presetRemoved presetAdded presetSorted",function(e,t){BACheetah.ajax({action:"save_color_presets",presets:t.presets})})},_initGradientPickers:function(){x(".ba-cheetah-settings:visible .ba-cheetah-gradient-picker").each(BACheetah._initGradientPicker)},_initGradientPicker:function(){var e=x(this),t=e.find(".ba-cheetah-gradient-picker-type-select"),a=e.find(".ba-cheetah-gradient-picker-angle-wrap"),i=e.find(".ba-cheetah-gradient-picker-position");t.on("change",function(){"linear"===x(this).val()?(a.show(),i.hide()):(a.hide(),i.show())})},_initPhotoFields:function(){var e=x(".ba-cheetah-settings:visible").find(".ba-cheetah-photo-field select");e.on("change",BACheetah._toggleSettingsOnIconChange),e.trigger("change")},_initSinglePhotoSelector:function(){null===BACheetah._singlePhotoSelector&&(BACheetah._singlePhotoSelector=wp.media({title:BACheetahStrings.selectPhoto,button:{text:BACheetahStrings.selectPhoto},library:{type:BACheetahConfig.uploadTypes.image},multiple:!1}),BACheetah._singlePhotoSelector.on("open",BACheetah._wpmedia_reset_errors),_wpPluploadSettings.defaults.multipart_params.ba_cheetah_upload_type="photo")},_selectSinglePhoto:function(){BACheetah._initSinglePhotoSelector(),BACheetah._singlePhotoSelector.once("open",x.proxy(BACheetah._singlePhotoOpened,this)),BACheetah._singlePhotoSelector.once("select",x.proxy(BACheetah._singlePhotoSelected,this)),BACheetah._singlePhotoSelector.open()},_singlePhotoOpened:function(){var e=BACheetah._singlePhotoSelector.state().get("selection"),t=x(this).closest(".ba-cheetah-photo-field"),a=t.find("input[type=hidden]"),i=a.val(),o=null;x(this).hasClass("ba-cheetah-photo-replace")?(e.reset(),t.addClass("ba-cheetah-photo-empty"),a.val("")):""!==i?((o=wp.media.attachment(i)).fetch(),e.add(o?[o]:[])):e.reset()},_singlePhotoSelected:function(){var e=BACheetah._singlePhotoSelector.state().get("selection").first().toJSON(),t=x(this).closest(".ba-cheetah-photo-field"),a=t.find("input[type=hidden]"),i=t.find(".ba-cheetah-photo-preview img"),o=t.find("select");a.val(e.id),i.attr("src",BACheetah._getPhotoSrc(e)),t.removeClass("ba-cheetah-photo-empty").removeClass("ba-cheetah-photo-no-attachment"),t.find("label.error").remove(),o.show(),o.html(BACheetah._getPhotoSizeOptions(e)),o.trigger("change"),BACheetahSettingsConfig.attachments[e.id]=e},_singlePhotoRemoved:function(){BACheetah._initSinglePhotoSelector();var e=BACheetah._singlePhotoSelector.state(),t=void 0!==e?e.get("selection"):null,a=x(this).closest(".ba-cheetah-photo-field"),i=a.find("input[type=hidden]"),e=a.find("select");t&&t.reset(),a.addClass("ba-cheetah-photo-empty"),i.val(""),e.html('<option value="" selected></option>'),e.trigger("change")},_getPhotoSrc:function(e){return(void 0===e.sizes?e:void 0!==e.sizes.thumbnail?e.sizes.thumbnail:e.sizes.full).url},_getPhotoSizeOptions:function(e,t){var a="",i=null,o=null,h="",s={full:BACheetahStrings.fullSize,large:BACheetahStrings.large,medium:BACheetahStrings.medium,thumbnail:BACheetahStrings.thumbnail};if(void 0===e.sizes||0===e.sizes.length)a+='<option value="'+e.url+'">'+BACheetahStrings.fullSize+"</option>";else for(i in t=t&&t.split(/[\\/]/).pop(),e.sizes)h=void 0!==s[i]?s[i]+" - ":void 0!==BACheetahConfig.customImageSizeTitles[i]?BACheetahConfig.customImageSizeTitles[i]+" - ":"",o="",t?t===e.sizes[i].url.split(/[\\/]/).pop()&&(o=' selected="selected"'):o="full"==i?' selected="selected"':"",a+='<option value="'+e.sizes[i].url+'"'+o+">"+h+e.sizes[i].width+" x "+e.sizes[i].height+"</option>";return a},_selectMultiplePhotos:function(){var e=x(this).closest(".ba-cheetah-multiple-photos-field").find("input[type=hidden]").val(),t=""===e?"":BACheetah._jsonParse(e),a=wp.media.gallery.defaults.id,i='[gallery ids="-1"]',o=null,e=null,h=null,s=null,n=[];if("object"==typeof t){for(s in t)n.push(t[s]);i='[gallery ids="'+n.join()+'"]'}o=wp.shortcode.next("gallery",i).shortcode,_.isUndefined(o.get("id"))&&!_.isUndefined(a)&&o.set("id",a),e=wp.media.gallery.attachments(o),(h=new wp.media.model.Selection(e.models,{props:e.props.toJSON(),multiple:!0})).gallery=e.gallery,h.more().done(function(){h.length||BACheetah._multiplePhotoSelector.setState("gallery-library"),h.props.set({query:!1}),h.unmirror(),h.props.unset("orderby")}),BACheetah._multiplePhotoSelector&&BACheetah._multiplePhotoSelector.dispose(),BACheetah._multiplePhotoSelector=wp.media({frame:"post",state:x(this).hasClass("ba-cheetah-multiple-photos-edit")?"gallery-edit":"gallery-library",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:h}).open(),x(BACheetah._multiplePhotoSelector.views.view.el).addClass("ba-cheetah-multiple-photos-lightbox"),BACheetah._multiplePhotoSelector.once("update",x.proxy(BACheetah._multiplePhotosSelected,this))},_multiplePhotosSelected:function(e){for(var t=x(this).closest(".ba-cheetah-multiple-photos-field"),a=t.find("input[type=hidden]"),i=t.find(".ba-cheetah-multiple-photos-count"),o=[],h=0;h<e.models.length;h++)o.push(e.models[h].id);1==o.length?i.html("1 "+BACheetahStrings.photoSelected):i.html(o.length+" "+BACheetahStrings.photosSelected),t.removeClass("ba-cheetah-multiple-photos-empty"),t.find("label.error").remove(),a.val(JSON.stringify(o)).trigger("change")},_initSingleVideoSelector:function(){null===BACheetah._singleVideoSelector&&(BACheetah._singleVideoSelector=wp.media({title:BACheetahStrings.selectVideo,button:{text:BACheetahStrings.selectVideo},library:{type:BACheetahConfig.uploadTypes.video},multiple:!1}),BACheetah._singleVideoSelector.on("open",BACheetah._wpmedia_reset_errors),_wpPluploadSettings.defaults.multipart_params.ba_cheetah_upload_type="video")},_selectSingleVideo:function(){BACheetah._initSingleVideoSelector(),BACheetah._singleVideoSelector.once("select",x.proxy(BACheetah._singleVideoSelected,this)),BACheetah._singleVideoSelector.open()},_singleVideoSelected:function(){var e=BACheetah._singleVideoSelector.state().get("selection").first().toJSON(),t=x(this).closest(".ba-cheetah-video-field"),a=t.find(".ba-cheetah-video-preview-img"),i=t.find(".ba-cheetah-video-preview-filename"),o=t.find("input[type=hidden]");a.html('<i class="fas fa-file-video"></i>'),i.html(e.filename),t.removeClass("ba-cheetah-video-empty"),t.find("label.error").remove(),o.val(e.id).trigger("change"),BACheetahSettingsConfig.attachments[e.id]=e},_singleVideoRemoved:function(){BACheetah._initSingleVideoSelector();var e=BACheetah._singleVideoSelector.state(),t=void 0!==e?e.get("selection"):null,a=x(this).closest(".ba-cheetah-video-field"),i=a.find(".ba-cheetah-video-preview-img img"),o=a.find(".ba-cheetah-video-preview-filename"),e=a.find("input[type=hidden]");t&&t.reset(),i.attr("src",""),o.html(""),a.addClass("ba-cheetah-video-empty"),e.val("").trigger("change")},_selectMultipleAudios:function(){var e=x(this).closest(".ba-cheetah-multiple-audios-field").find("input[type=hidden]").val(),t=""==e?'[playlist ids="-1"]':'[playlist ids="'+BACheetah._jsonParse(e).join()+'"]',a=wp.shortcode.next("playlist",t).shortcode,e=wp.media.playlist.defaults.id,t=null,i=null;_.isUndefined(a.get("id"))&&!_.isUndefined(e)&&a.set("id",e),t=wp.media.playlist.attachments(a),(i=new wp.media.model.Selection(t.models,{props:t.props.toJSON(),multiple:!0})).playlist=t.playlist,i.more().done(function(){i.props.set({query:!1}),i.unmirror(),i.props.unset("orderby")}),BACheetah._multipleAudiosSelector&&BACheetah._multipleAudiosSelector.dispose(),BACheetah._multipleAudiosSelector=wp.media({frame:"post",state:x(this).hasClass("ba-cheetah-multiple-audios-edit")?"playlist-edit":"playlist-library",title:wp.media.view.l10n.editPlaylistTitle,editing:!0,multiple:!0,selection:i}).open(),BACheetah._multipleAudiosSelector.content.get("view").sidebar.unset("playlist"),BACheetah._multipleAudiosSelector.on("content:render:browse",function(e){e&&e.sidebar.on("ready",function(){e.sidebar.unset("playlist")})}),BACheetah._multipleAudiosSelector.once("update",x.proxy(BACheetah._multipleAudiosSelected,this))},_multipleAudiosSelected:function(e){for(var t=x(this).closest(".ba-cheetah-multiple-audios-field"),a=t.find(".ba-cheetah-multiple-audios-count"),i=t.find("input[type=hidden]"),o=[],h=0;h<e.models.length;h++)o.push(e.models[h].id);1==o.length?a.html("1 "+BACheetahStrings.audioSelected):a.html(o.length+" "+BACheetahStrings.audiosSelected),i.val(JSON.stringify(o)).trigger("change"),t.removeClass("ba-cheetah-multiple-audios-empty"),t.find("label.error").remove()},_initIconFields:function(){var e=x(".ba-cheetah-settings:visible").find(".ba-cheetah-icon-field input");e.on("change",BACheetah._toggleSettingsOnIconChange),e.trigger("change")},_toggleSettingsOnIconChange:function(){var e=x(this),t=e.val(),e=e.attr("data-show");void 0!==e&&(e=BACheetah._jsonParse(e),BACheetah._settingsSelectToggle(e.fields,"hide","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(e.sections,"hide","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(e.tabs,"hide","a[href*=ba-cheetah-settings-tab-","]"),t&&(BACheetah._settingsSelectToggle(e.fields,"show","#ba-cheetah-field-"),BACheetah._settingsSelectToggle(e.sections,"show","#ba-cheetah-settings-section-"),BACheetah._settingsSelectToggle(e.tabs,"show","a[href*=ba-cheetah-settings-tab-","]"),BACheetah._calculateSettingsTabsOverflow()))},_selectIcon:function(){var t=this;BACheetahIconSelector.open(function(e){BACheetah._iconSelected.apply(t,[e])})},_iconSelected:function(e){var t=x(this).closest(".ba-cheetah-icon-field"),a=t.find("input[type=hidden]"),i=t.find("i"),o=i.attr("data-icon");a.val(e).trigger("change"),i.removeClass(o),i.addClass(e),i.attr("data-icon",e),t.removeClass("ba-cheetah-icon-empty"),t.find("label.error").remove()},_removeIcon:function(){var e=x(this).closest(".ba-cheetah-icon-field"),t=e.find("input[type=hidden]"),a=e.find("i");t.val("").trigger("change"),a.removeClass(),a.attr("data-icon",""),e.addClass("ba-cheetah-icon-empty")},_formFieldClicked:function(){var e=x(this),t=e.closest(".ba-cheetah-settings"),a=e.attr("data-type"),i=e.siblings("input").val(),o=BACheetah._moduleHelpers[a],h=(BACheetahSettingsConfig.forms[a],BACheetah._openNestedSettings({className:"ba-cheetah-lightbox ba-cheetah-form-field-settings"}));""===i&&(i=JSON.stringify(BACheetahSettingsConfig.forms[a])),BACheetahSettingsForms.render({id:a,nodeId:t.attr("data-node"),nodeSettings:BACheetah._getSettings(t),settings:BACheetah._jsonParse(i.replace(/&#39;/g,"'")),lightbox:h,helper:o,rules:o?o.rules:null},function(){e.attr("id","ba-cheetah-"+h._node.attr("data-instance-id")),h._node.find("form.ba-cheetah-settings").attr("data-type",a),BACheetahResponsiveEditing._switchAllSettingsToCurrentMode()})},_saveFormFieldClicked:function(){var e,t=x(this).closest(".ba-cheetah-settings"),a=x(this).closest(".ba-cheetah-lightbox-wrap").attr("data-instance-id"),i=t.attr("data-type"),o=BACheetah._getSettings(t),h=BACheetah._moduleHelpers[i],s=x(".ba-cheetah-settings #ba-cheetah-"+a),n=s.parent().attr("data-preview-text"),l=t.find("#ba-cheetah-field-"+n),r=o[n],d=x('select[name="'+n+'"]'),i=document.createElement("div"),a=!0;return 0<d.length&&(r=d.find('option[value="'+o[n]+'"]').text()),void 0!==h&&(t.find("label.error").remove(),t.validate().hideErrors(),a=(a=t.validate().form())&&h.submit()),a?(void 0!==n&&void 0!==r&&("icon"===l.data("type")?r='<i class="'+r+'"></i>':35<r.length&&(i.innerHTML=r,r=(i.textContent||i.innerText||"").replace(/^(.{35}[^\s]*).*/,"$1")+"..."),s.siblings(".ba-cheetah-form-field-preview-text").html(r)),""!=(e=s.siblings("input").val().replace(/&#39;/g,"'"))&&(o=x.extend(BACheetah._jsonParse(e),o)),s.siblings("input").val(JSON.stringify(o)).trigger("change"),BACheetah._closeNestedSettings(),!0):(BACheetah._toggleSettingsTabErrors(),!1)},_layoutFieldClicked:function(){var e=x(this);e.siblings().removeClass("ba-cheetah-layout-field-option-selected"),e.addClass("ba-cheetah-layout-field-option-selected"),e.siblings("input").val(e.attr("data-value"))},_initLinkFields:function(){x(".ba-cheetah-settings:visible .ba-cheetah-link-field").each(BACheetah._initLinkField)},_initLinkField:function(){var e=x(this),t=e.find(".ba-cheetah-link-field-search-input"),e=e.find(".ba-cheetah-link-field-options-wrap input[type=checkbox]");t.autoSuggest(BACheetah._ajaxUrl({ba_cheetah_action:"ba_cheetah_autosuggest",ba_cheetah_as_action:"ba_cheetah_as_links",_wpnonce:BACheetahConfig.ajaxNonce}),{asHtmlID:t.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:3,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:BACheetahStrings.noResultsFound,showResultListWhenNoMatch:!0,queryParam:"ba_cheetah_as_query",selectionLimit:1,afterSelectionAdd:BACheetah._updateLinkField,formatList:function(e,t){return t.html(e.name+'<span class="type">['+e.type+"]</span>")}}),e.on("click",BACheetah._linkFieldCheckboxClicked)},_updateLinkField:function(e,t,a){var i=e.closest(".ba-cheetah-link-field"),o=i.find(".ba-cheetah-link-field-search"),e=i.find(".ba-cheetah-link-field-search-input");i.find(".ba-cheetah-link-field-input").val(t.value).trigger("keyup"),e.autoSuggest("remove",t.value),o.hide()},_linkFieldSelectClicked:function(){var e=x(this).closest(".ba-cheetah-link-field").find(".ba-cheetah-link-field-search");e.show(),e.find("input").focus()},_linkFieldSelectCancelClicked:function(){var e=x(this);e.parent().hide(),e.closest(".ba-cheetah-link-field").find("input.ba-cheetah-link-field-input").focus()},_linkFieldCheckboxClicked:function(){var e=x(this),t=e.is(":checked"),a=e.siblings("input[type=hidden]"),i="",i=e.hasClass("ba-cheetah-link-field-target-cb")?t?"_blank":"_self":t?"yes":"no";a.val(i)},_initFontFields:function(){x(".ba-cheetah-settings:visible .ba-cheetah-font-field").each(BACheetah._initFontField)},_initFontField:function(){var e=x(this),t=e.attr("data-value"),a=e.find(".ba-cheetah-font-field-font"),e=e.find(".ba-cheetah-font-field-weight");BACheetahConfig.select2Enabled&&a.select2({width:"100%"}).on("select2:open",function(e){x(".select2-search__field").attr("placeholder",BACheetahStrings.placeholderSelect2),document.querySelector(".select2-search__field").focus()}),a.on("change",function(){BACheetah._getFontWeights(a)}),-1<t.indexOf("family")&&(t=BACheetah._jsonParse(t),a.val(t.family),a.trigger("change"),e.find("option[value="+t.weight+"]").length&&e.val(t.weight))},_getFontWeights:function(e){var a=e.closest(".ba-cheetah-font-field").find(".ba-cheetah-font-field-weight"),i=e.val(),o=a.val(),h=BACheetahConfig.FontWeights,t={},s=e.closest(".ba-cheetah-font-field").find(".recent-fonts option");a.html(""),0<s.length&&!1==0<x(s).filter(function(e,t){return t.value===i}).length&&e.closest(".ba-cheetah-font-field").find(".recent-fonts").append(x("<option>",{value:i,text:i})),t=void 0!==BACheetahFontFamilies.system[i]?BACheetahFontFamilies.system[i].weights:(void 0!==BACheetahFontFamilies.google[i]?BACheetahFontFamilies.google:BACheetahFontFamilies.default)[i],x.each(t,function(e,t){a.append('<option value="'+t+'"'+(o===t?" selected":"")+">"+h[t]+"</option>")})},_initTinyMCE:function(){"object"==typeof tinymce&&void 0!==tinymce.ui.FloatPanel&&(tinymce.ui.FloatPanel.zIndex=100100),x(".ba-cheetah-hidden-editor").each(BACheetah._initEditorField)},_initEditorFields:function(){x(".ba-cheetah-settings:visible .ba-cheetah-editor-field").each(BACheetah._initEditorField)},_initEditorField:function(){var e=x(this),t=e.find("textarea"),a=e.attr("data-name"),i="flrich"+(new Date).getTime()+"_"+a,o=BACheetahConfig.wp_editor,h=tinyMCEPreInit,s=Number(e.attr("data-buttons")),n=e.attr("data-rows"),a=null,e=null,o=o.replace(/bacheetaheditor/g,i),h=BACheetah._jsonParse(JSON.stringify(h).replace(/bacheetaheditor/g,i));h=JSONfn.parse(JSONfn.stringify(h).replace(/bacheetaheditor/g,i)),t.after(o).remove(),x("textarea#"+i).val(t.val()),void 0!==h.mceInit[i]&&((a=h.mceInit[i]).setup=function(e){e.on("SaveContent",function(e){e.content=e.content.replace(/<a href="(\.\.\/){1,2}/g,'<a href="'+BACheetahConfig.homeUrl+"/"),e.content=e.content.replace(/src="(\.\.\/){1,2}/g,'src="'+BACheetahConfig.homeUrl+"/")})},(e=tinymce.$("#wp-"+i+"-wrap")).find("textarea").attr("rows",n),s||e.find(".wp-media-buttons").remove(),!e.hasClass("tmce-active")&&h.qtInit.hasOwnProperty(i)||a.wp_skip_init||tinymce.init(a)),quicktags(h.qtInit[i]),window.wpActiveEditor=i},_reinitEditorFields:function(){x(".ba-cheetah-lightbox-resizable:visible").length&&setTimeout(function(){var e,t;if("undefined"!=typeof tinymce){for(e=tinymce.editors.length-1;-1<e;e--)tinymce.editors[e].inline||(t=tinymce.editors[e].id,tinyMCE.execCommand("mceRemoveEditor",!0,t),tinyMCE.execCommand("mceAddEditor",!0,t));BACheetah.preview&&BACheetah.preview._initDefaultFieldPreviews(x('.ba-cheetah-field[data-type="editor"]'))}},1)},_destroyEditorFields:function(){var e;if("undefined"!=typeof tinymce){for(e=tinymce.editors.length-1;-1<e;e--)tinymce.editors[e].inline||tinyMCE.execCommand("mceRemoveEditor",!0,tinymce.editors[e].id);x(".wplink-autocomplete").remove(),x(".ui-helper-hidden-accessible").remove()}},_updateEditorFields:function(){x(".ba-cheetah-settings:visible textarea.wp-editor-area").each(BACheetah._updateEditorField)},_updateEditorField:function(){var e=x(this),t=e.closest(".ba-cheetah-editor-field"),a=(e.closest(".ba-cheetah-settings"),e.closest(".wp-editor-wrap")),i=e.attr("id"),o=t.attr("data-name"),h="undefined"!=typeof tinymce&&tinymce.get(i),i=e.siblings('textarea[name="'+o+'"]'),t=t.data("wpautop");0===i.length&&(i=x('<textarea name="'+o+'"></textarea>').hide(),e.after(i)),t?h&&a.hasClass("tmce-active")?i.val(h.getContent()):"undefined"!=typeof switchEditors?i.val(switchEditors.wpautop(e.val())):i.val(e.val()):(h&&a.hasClass("tmce-active")&&h.save(),i.val(e.val()))},_loopDataSourceChange:function(){var e=x(this).val();x(".ba-cheetah-loop-data-source").hide(),x('.ba-cheetah-loop-data-source[data-source="'+e+'"]').show()},_customQueryPostTypeChange:function(){var e=x(this).val();x(".ba-cheetah-custom-query-filter").hide(),x(".ba-cheetah-custom-query-"+e+"-filter").show()},_initOrderingFields:function(){x(".ba-cheetah-settings:visible .ba-cheetah-ordering-field-options").each(BACheetah._initOrderingField)},_initOrderingField:function(){x(this).sortable({items:".ba-cheetah-ordering-field-option",containment:"parent",tolerance:"pointer",stop:BACheetah._updateOrderingField})},_updateOrderingField:function(e){var t=x(e.target),e=t.siblings("input[type=hidden]"),a=[];t.find(".ba-cheetah-ordering-field-option").each(function(){a.push(x(this).attr("data-key"))}),e.val(JSON.stringify(a)).trigger("change")},_textFieldAddValueSelectChange:function(){var e,t=x(this),a=x('input[name="'+t.data("target")+'"]'),i=a.val(),o=t.val();-1==i.indexOf(o)&&(e=(i.trim()+" "+o.trim()).trim(),a.val(e).trigger("change").trigger("keyup")),t.val("")},_onNumberFieldFocus:function(e){var t=x(e.currentTarget);t.addClass("mousetrap"),Mousetrap.bind("up",function(){t.attr("step",1)}),Mousetrap.bind("down",function(){t.attr("step",1)}),Mousetrap.bind("shift+up",function(){t.attr("step",10)}),Mousetrap.bind("shift+down",function(){t.attr("step",10)})},_onNumberFieldBlur:function(e){x(e.currentTarget).attr("step","any").removeClass("mousetrap")},_initTimezoneFields:function(){x(".ba-cheetah-settings:visible .ba-cheetah-field[data-type=timezone]").each(BACheetah._initTimezoneField)},_initTimezoneField:function(){var e=x(this).find("select"),t=e.attr("data-value");e.find('option[value="'+t+'"]').prop("selected",!0)},_initDimensionFields:function(){var e=x(".ba-cheetah-settings:visible");e.find(".ba-cheetah-field[data-type=dimension]").each(BACheetah._initDimensionField),e.find(".ba-cheetah-dimension-field-link").on("click",BACheetah._dimensionFieldLinkClicked),BACheetah.addHook("responsive-editing-switched",this._initResponsiveDimensionFieldLinking),e.find(".ba-cheetah-compound-field-setting").has(".ba-cheetah-dimension-field-link").each(BACheetah._initDimensionFieldLinking)},_initDimensionField:function(){var e=x(this),t=e.find(".ba-cheetah-field-label label"),a=e.find(".ba-cheetah-field-control-wrapper"),e='<i class="ba-cheetah-dimension-field-link ba-cheetah-tip dashicons dashicons-admin-links" title="Link Values"></i>';t.append(e),a.prepend(e),BACheetah._initTipTips(),BACheetah._initDimensionFieldLinking.apply(this)},_initDimensionFieldLinking:function(){var e=x(this),t=e.find(".ba-cheetah-dimension-field-link"),e=BACheetah._getDimensionFieldLinkingInputs(e);BACheetah._dimensionFieldInputsAreEqual(e)?(t.removeClass("dashicons-admin-links"),t.addClass("dashicons-editor-unlink"),e.off("input",BACheetah._dimensionFieldLinkedValueChange),e.on("input",BACheetah._dimensionFieldLinkedValueChange)):(t.addClass("dashicons-admin-links"),t.removeClass("dashicons-editor-unlink"))},_initResponsiveDimensionFieldLinking:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-field[data-type=dimension]").each(BACheetah._initDimensionFieldLinking)},_dimensionFieldLinkClicked:function(){var e=x(this),t=e.closest(".ba-cheetah-compound-field-setting"),a=t.length?t:e.closest(".ba-cheetah-field"),t=a.find(".ba-cheetah-dimension-field-link"),e=t.hasClass("dashicons-editor-unlink"),a=BACheetah._getDimensionFieldLinkingInputs(a);t.toggleClass("dashicons-admin-links"),t.toggleClass("dashicons-editor-unlink"),e?a.off("input",BACheetah._dimensionFieldLinkedValueChange):(a.val(a.eq(0).val()).trigger("input"),a.on("input",BACheetah._dimensionFieldLinkedValueChange))},_dimensionFieldLinkedValueChange:function(){var e=x(this),t=e.attr("name"),t=e.closest(".ba-cheetah-dimension-field-units").find('input:not([name="'+t+'"])');t.off("input",BACheetah._dimensionFieldLinkedValueChange),t.val(e.val()).trigger("input"),t.on("input",BACheetah._dimensionFieldLinkedValueChange)},_getDimensionFieldLinkingInputs:function(e){var t=!!e.find(".ba-cheetah-field-responsive-setting").length,a=BACheetahResponsiveEditing._mode;return t?e.find(".ba-cheetah-field-responsive-setting-"+a+" input"):e.find(".ba-cheetah-dimension-field-unit input")},_dimensionFieldInputsAreEqual:function(e){var t=e.eq(0).val();if(""===t)return!1;for(var a=1;a<4;a++)if(e.eq(a).val()!==t)return!1;return!0},_initFieldPopupSliders:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-field-popup-slider").each(BACheetah._initFieldPopupSlider)},_initFieldPopupSlider:function(){var h=x("body"),s=x(this),n=s.find(".ba-cheetah-field-popup-slider-input"),l=s.find(".ba-cheetah-field-popup-slider-arrow"),e=s.data("input"),r=x('input[name="'+e+'"]');r.on("click",function(){n.hasClass("ba-cheetah-field-popup-slider-init")||(n.slider({value:r.val(),slide:function(e,t){r.val(t.value).trigger("input")}}),r.on("input",function(){n.slider("value",x(this).val())}),n.addClass("ba-cheetah-field-popup-slider-init"),n.find(".ui-slider-handle").removeAttr("tabindex")),BACheetah._setFieldPopupSliderMinMax(n),BACheetah._hideFieldPopupSliders(),h.on("mousedown",BACheetah._hideFieldPopupSliders),r.addClass("ba-cheetah-field-popup-slider-focus"),s.show();var e=x(".ba-cheetah-settings:visible .ba-cheetah-settings-tab.ba-cheetah-active"),t=e.offset(),a=r.offset(),i=r.width(),o=s.offset();o.top+s.outerHeight()>t.top+e.outerHeight()&&s.addClass("ba-cheetah-field-popup-slider-top"),l.css("left",2+a.left-o.left+i/2+"px")}),r.on("focus",function(){BACheetah._hideFieldPopupSliders()})},_hideFieldPopupSliders:function(e){var t=e?x(e.target):null,a=x("body"),i=x(".ba-cheetah-field-popup-slider:visible"),e=x(".ba-cheetah-field-popup-slider-focus");if(t){if(t.closest(".ba-cheetah-field-popup-slider").length)return;if(t.closest(".ba-cheetah-field-popup-slider-focus").length)return}a.off("mousedown",BACheetah._hideFieldPopupSliders),e.removeClass("ba-cheetah-field-popup-slider-focus"),i.hide()},_setFieldPopupSliderMinMax:function(e){var t=e.parent(),a=t.parent().parent().find("select.ba-cheetah-field-unit-select"),i=a.val(),o=t.data("slider"),h=0,s=100,t=1;""!==i&&"em"!==i&&"rem"!==i||(s=10,t=.1),"object"==typeof o&&(h=o.min?parseFloat(o.min):h,s=o.max?parseFloat(o.max):s,t=o.step?parseFloat(o.step):t,a.length&&o[i]&&(h=o[i].min?parseFloat(o[i].min):h,s=o[i].max?parseFloat(o[i].max):s,t=o[i].step?parseFloat(o[i].step):t)),e.slider({min:h,max:s,step:t})},_initPresetFields:function(){x(".ba-cheetah-settings:visible").find(".ba-cheetah-preset-select-controls").each(BACheetah._initPresetField)},_initPresetField:function(){var e=x(this),t=e.find("select"),a=e.data("presets"),e=e.data("prefix");t.on("change",BACheetah._setFormPreset.bind(this,a,e))},_setFormPreset:function(e,t,a){var i=x(a.currentTarget).val();if(presetLists=BACheetahConfig.presets,presets=presetLists[e],form=x(".ba-cheetah-settings:visible"),"undefined"!==presets&&"undefined"!==presets[i]){var o,h=presets[i].settings;for(o in h){var i=h[o],s=void 0!==t&&""!==t?form.find('[name="'+t+o+'"]'):form.find('[name="'+o+'"]');s.val(i).trigger("change").trigger("input")}}},_initDragDropFields:function(){x('.ba-cheetah-settings:visible input[name="dragdrop"]')},ajax:function(t,a){if(!BACheetah._ajaxRequest){for(var e in BACheetah.triggerHook("didBeginAJAX",t),t)void 0===t[e]&&(t[e]=null);return(t._wpnonce=BACheetahConfig.ajaxNonce,t.post_id=BACheetahConfig.postId,t.ba_cheetah=1,t.ba_cheetah_action=t.action,void 0!==t.settings&&(t.settings=BACheetah._ajaxModSecFix(x.extend(!0,{},t.settings))),void 0!==t.node_settings&&(t.node_settings=BACheetah._ajaxModSecFix(x.extend(!0,{},t.node_settings))),void 0!==t.node_preview&&(t.node_preview=BACheetah._ajaxModSecFix(x.extend(!0,{},t.node_preview))),t.settings=BACheetah._inputVarsCheck(t.settings),t.node_settings=BACheetah._inputVarsCheck(t.node_settings),"error"===t.settings||"error"===t.node_settings)?0:(t={ba_cheetah_data:t},BACheetah._ajaxRequest=x.post(BACheetah._ajaxUrl(),t,function(e){void 0!==a&&a.call(this,e),BACheetah.triggerHook("didCompleteAJAX",t)}).always(BACheetah._ajaxComplete).fail(function(e,t,a){switch(msg=!1,e.status){case 403:case 409:msg="Something you entered has triggered a "+e.status+" error.<br /><br />This is nearly always due to mod_security settings from your hosting provider."}msg&&(console.log(e),console.log(a),BACheetah.alert(msg))}),BACheetah._ajaxRequest)}BACheetah._ajaxQueue.push({data:t,callback:a})},_inputVarsCheck:function(e){var t=BACheetahConfig.MaxInputVars||0;return void 0!==e&&0<t&&(count=x.map(e,function(e,t){return t}).length,count>t)?(BACheetah.alert('<h1 style="font-size:2em;text-align:center">Critical Issue</h1><br />The number of settings being saved ('+count+") exceeds the PHP Max Input Vars setting ("+t+").<br />Please contact your host to have this value increased, the default is 1000."),console.log("Vars Count: "+count),console.log("Max Input: "+t),"error"):e},_ajaxComplete:function(){var e;BACheetah._ajaxRequest=null,BACheetah.hideAjaxLoader(),BACheetah._ajaxQueue.length&&(e=BACheetah._ajaxQueue.shift(),BACheetah.ajax(e.data,e.callback))},_ajaxUrl:function(e){var t=BACheetahConfig.shortlink,a=null;if(void 0!==e)for(a in e)t+=-1<t.indexOf("?")?"&":"?",t+=a+"="+e[a];return t},showAjaxLoader:function(){0===x(".ba-cheetah-lightbox-loading").length&&x(".ba-cheetah-loading").show()},hideAjaxLoader:function(){x(".ba-cheetah-loading").hide()},_showNodeLoading:function(e){e=x(".ba-cheetah-node-"+e);e.addClass("ba-cheetah-node-loading"),BACheetah._removeAllOverlays(),BACheetah.triggerHook("didStartNodeLoading",e)},_hideNodeLoading:function(e){x(".ba-cheetah-node-"+e).removeClass("ba-cheetah-node-loading")},_showNodeLoadingPlaceholder:function(e,t){var a=x('<div class="ba-cheetah-node-loading-placeholder"></div>');x(".ba-cheetah-node-loading-placeholder").remove(),siblings=e.hasClass("ba-cheetah-content")?e.find(" > .ba-cheetah-row"):e.hasClass("ba-cheetah-row-content")?e.find(" > .ba-cheetah-col-group"):e.hasClass("ba-cheetah-col-group")?(e.addClass("ba-cheetah-col-group-has-child-loading"),e.find(" > .ba-cheetah-col")):e.find(" > .ba-cheetah-col-group, > .ba-cheetah-module"),0===siblings.length||siblings.length==t?e.append(a):siblings.eq(t).before(a)},_removeNodeLoadingPlaceholder:function(e){var t=e.prev(".ba-cheetah-node-loading-placeholder"),e=e.next(".ba-cheetah-node-loading-placeholder");(t.length?t:e).remove()},_ajaxModSecFix:function(e){if(BACheetahConfig.modSecFix&&"undefined"!=typeof btoa)if("string"==typeof e)e=BACheetah._btoa(e);else for(var t in e)"string"==typeof e[t]?e[t]=BACheetah._btoa(e[t]):"object"==typeof e[t]&&(e[t]=BACheetah._ajaxModSecFix(e[t]));return e},getSelectOptions:function(i,o,h){const e=x(".ba-cheetah-settings:visible");var t=BACheetah._getOriginalSettings(e,!0);const s=e.find("select[name="+o+"]"),n=t[o];s.empty(),s.prop("disabled",!0),s.append(x(new Option("Loading",null,!0,!0))),BACheetah.ajax({action:i},function(e){s.empty();const t=JSON.parse(e)||[];if(t.length?(s.append(x(new Option(BACheetahStrings.selectOne,"",!n,!n)).prop("disabled",!0)),t.forEach(e=>{s.append(new Option(e.label,e.value,n==e.value,n==e.value))})):s.append(x(new Option(BACheetahStrings.noOptionsFound,"",!0,!0)).prop("disabled",!0)),s.prop("disabled",!1),!s.next().is("i")){const a=x('<i class="dashicons dashicons-update js-reload-options"></i>');a.on("click",()=>BACheetah.getSelectOptions(i,o,h)),s.after(a)}h&&"function"==typeof h&&h(t,s)})},_btoa:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))},_wpmedia_reset_errors:function(){x(".upload-error").remove(),x(".media-uploader-status").removeClass("errors").hide()},_initLightboxes:function(){BACheetah._lightbox=new BACheetahLightbox({className:"ba-cheetah-lightbox ba-cheetah-settings-lightbox",resizable:!0}),BACheetah._lightbox.on("resized",BACheetah._calculateSettingsTabsOverflow),BACheetah._lightbox.on("close",BACheetah._lightboxClosed),BACheetah._lightbox.on("beforeCloseLightbox",BACheetah._destroyEditorFields),BACheetah._actionsLightbox=new BACheetahLightbox({className:"ba-cheetah-actions-lightbox"})},_showLightbox:function(e){e=e||'<div class="ba-cheetah-lightbox-loading"></div>',BACheetah._lightbox.open(e),BACheetah._initLightboxScrollbars()},_setLightboxContent:function(e){BACheetah._lightbox.setContent(e)},_initLightboxScrollbars:function(){BACheetah._initScrollbars(),clearTimeout(BACheetah._lightboxScrollbarTimeout),BACheetah._lightboxScrollbarTimeout=setTimeout(BACheetah._initLightboxScrollbars,500)},_lightboxClosed:function(){BACheetah.triggerHook("settings-lightbox-closed"),BACheetah._lightbox.empty(),clearTimeout(BACheetah._lightboxScrollbarTimeout),BACheetah._lightboxScrollbarTimeout=null},_showActionsLightbox:function(e){var t=wp.template("ba-cheetah-actions-lightbox");BACheetah.triggerHook("actions-lightbox-settings",e),BACheetah._actionsLightbox.open(t(e))},alert:function(e,t="",a="",i=""){var o=new BACheetahLightbox({className:a||"ba-cheetah-alert-lightbox",destroyOnClose:!0}),a=wp.template(a||"ba-cheetah-alert-lightbox");o.open(a({message:e,title:t,icon:i}))},crashMessage:function(e){BACheetahLightbox.closeAll();var t=new BACheetahLightbox({className:"ba-cheetah-alert-lightbox ba-cheetah-crash-lightbox",destroyOnClose:!0}),a=wp.template("ba-cheetah-crash-lightbox"),i=window.crash_vars.product,o=window.crash_vars.white_label,h=window.crash_vars.labeled_txt;message=i+" has detected a plugin conflict that is preventing the page from saving.<p>( In technical terms theres probably a PHP error in Ajax. )</p>",info="<p>If you contact Builderall Builder Support, we need to know what the error is in the JavaScript console in your browser.</p>",info+="<div><div style='width:49%;float:left;'>",info+="<p>MacOS Users:<br />Chrome: View > Developer > JavaScript Console<br />Firefox: Tools > Web Developer > Browser Console<br />Safari: Develop > Show JavaScript console</p>",info+="</div>",info+="<div style='width:49%;float:right;'>",info+="<p>Windows Users:<br />Chrome: Settings > More Tools > Developer > Console<br />Firefox: Menu/Settings > Web Developer > Web Console<br />Edge: Settings and More > More Tools > Console</p>",info+="</div></div>",info+="<p style='display:inline-block;'>Copy the errors you find there and submit them with your Support ticket. It saves us having to ask you that as a second step. Then deactivate your plugins one by one while you try to save the page in the Builderall Builder editor. When the page saves normally, you have identified the plugin causing the conflict.</p>",BACheetahConfig.MaxInputVars<=3e3&&(info+="<br /><br />The PHP config value max_input_vars is only set to "+BACheetahConfig.MaxInputVars+". If you are using 3rd party addons this could very likely be the cause of this error."),o&&(info=h),t.open(a({message:message,info:info,debug:!1}))},_alertClose:function(){BACheetahLightbox.closeParent(this)},confirm:function(e){var t={message:"",ok:function(){},cancel:function(){},strings:{ok:BACheetahStrings.ok,cancel:BACheetahStrings.cancel}},e=x.extend({},t,void 0===e?{}:e);lightbox=new BACheetahLightbox({className:"ba-cheetah-confirm-lightbox ba-cheetah-alert-lightbox",destroyOnClose:!0}),template=wp.template("ba-cheetah-confirm-lightbox"),lightbox.open(template(e)),lightbox._node.find(".ba-cheetah-confirm-ok").on("click",e.ok),lightbox._node.find(".ba-cheetah-confirm-cancel").on("click",e.cancel)},triggerHook:function(e,t){x("body").trigger("ba-cheetah."+e,t)},addHook:function(e,t){x("body").on("ba-cheetah."+e,t)},removeHook:function(e,t){x("body").off("ba-cheetah."+e,t)},log:function(e){void 0!==window.console&&void 0!==window.console.log&&console.log(e)},logError:function(e,t){var a=null;void 0!==e&&(void 0!==e.stack?a=e.stack:void 0!==e.message&&(a=e.message),a&&(BACheetah.log("************************************************************************"),BACheetah.log(BACheetahStrings.errorMessage),BACheetah.log(a),void 0!==t&&t&&(BACheetah.log("Debug Info"),console.log(t)),x.each(window.crash_vars.vars,function(e,t){console.log(e+": "+t)}),BACheetah.log("************************************************************************"),void 0!==t&&t&&(a=t+"\n"+a),BACheetah.crashMessage(a)))},logGlobalError:function(e,t,a,i,o){BACheetah.log("************************************************************************"),BACheetah.log(BACheetahStrings.errorMessage),BACheetah.log(BACheetahStrings.globalErrorMessage.replace("{message}",e).replace("{line}",a).replace("{file}",t)),void 0!==o&&void 0!==o.stack&&BACheetah.log(o.stack),BACheetah.log("************************************************************************")},_jsonParse:function(t){try{t=JSON.parse(t)}catch(e){BACheetah.logError(e,BACheetah._parseError(t))}return t},_parseError:function(e){if(e.indexOf("</head>"))return"AJAX returned HTML page instead of data. (Possible 404 or max_input_vars)";if(php=e.match(/^<.*/gm)||!1,php&&0<php.length){var a="";return x.each(php,function(e,t){a+=t}),x(a).text()}return!1},isUndefined:function(e){return void 0===e},isBoolean:function(e){return!0===e||!1===e}},x(function(){BACheetah._init()})}(jQuery),function(exports){"use strict";exports.stringify=function(e){return JSON.stringify(e,function(e,t){var a;return t instanceof Function||"function"==typeof t?(a=t.toString()).length<8||"function"!==a.substring(0,8)?"_NuFrRa_"+a:a:t instanceof RegExp?"_PxEgEr_"+t:t})},exports.parse=function(str,date2obj){var iso8061=!!date2obj&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;return JSON.parse(str,function(key,value){var prefix;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix||"_NuFrRa_"===prefix?eval(value.slice(8)):value)})},exports.clone=function(e,t){return exports.parse(exports.stringify(e),t)}}("undefined"==typeof exports?window.JSONfn={}:exports),function(h){BACheetahAJAXLayout=function(e,t){this._data=h.extend({},this._defaults,"string"==typeof e?BACheetah._jsonParse(e):e),this._callback=t,this._post=BACheetahConfig.postId,this._head=h("head").eq(0),this._body=h("body").eq(0),this._data.css&&("inline"===BACheetahConfig.enqueueMethod?(this._oldCss=h("#ba-cheetah-layout-"+this._post+"-inline-css"),this._newCss=h('<style id="ba-cheetah-layout-'+this._post+'-inline-css" type="text/css">'+this._data.css+"</style>")):(this._loader=h('<img src="'+this._data.css+'" />'),this._oldCss=h('link[href*="/cache/'+this._post+'-layout"]'),this._newCss=h('<link rel="stylesheet" id="ba-cheetah-layout-'+this._post+'-css"  href="'+this._data.css+'" />'))),this._data.partial?(this._data.js&&(this._oldJs=h("#ba-cheetah-partial-refresh-js"),this._newJs=h('<script type="text/javascript" id="ba-cheetah-partial-refresh-js">'+this._data.js+"<\/script>")),this._data.nodeId&&(this._data.oldNodeId?(this._oldScriptsStyles=h('.ba-cheetah-node-scripts-styles[data-node="'+this._data.oldNodeId+'"]'),this._content=h(".ba-cheetah-node-"+this._data.oldNodeId)):(this._oldScriptsStyles=h('.ba-cheetah-node-scripts-styles[data-node="'+this._data.nodeId+'"]'),this._content=h(".ba-cheetah-node-"+this._data.nodeId).eq(0)))):("inline"===BACheetahConfig.enqueueMethod?(this._oldJs=h("#ba-cheetah-layout-"+this._post+"-inline-js"),this._newJs=h('<script id="ba-cheetah-layout-'+this._post+'-inline-js">'+this._data.js+"<\/script>")):(this._oldJs=h('script[src*="/cache/'+this._post+'"]'),this._newJs=h('<script src="'+this._data.js+'"><\/script>')),this._oldScriptsStyles=h(".ba-cheetah-layout-scripts-styles"),this._content=h(BACheetah._contentClass)),this._init()},BACheetahAJAXLayout.prototype={_defaults:{partial:!1,nodeId:null,nodeType:null,nodeParent:null,nodePosition:null,oldNodeId:null,html:null,scriptsStyles:null,css:null,js:null},_data:null,_callback:function(){},_post:null,_head:null,_body:null,_loader:null,_oldCss:null,_newCss:null,_oldJs:null,_newJs:null,_oldScriptsStyles:null,_content:null,_init:function(){this._body.height(this._body.height()),this._data.css?"inline"===BACheetahConfig.enqueueMethod?(this._addNewCSS(),this._finish()):"onload"in document.createElement("link")?(this._newCss.on("load",h.proxy(this._finish,this)),this._addNewCSS()):(this._loader.on("error",h.proxy(this._loadNewCSSFallbackComplete,this)),this._body.append(this._loader)):this._finish()},_loadNewCSSFallbackComplete:function(){this._loader.remove(),this._addNewCSS(),setTimeout(h.proxy(this._finish,this),250)},_addNewCSS:function(){0<this._oldCss.length?this._oldCss.after(this._newCss):this._head.append(this._newCss)},_finish:function(){this._removeOldContentAndAssets(),this._cleanNewHTML(),this._cleanNewAssets(),this._addNewHTML(),this._addNewScriptsStyles(),this._addNewJS(),h(BACheetah._contentClass).trigger("ba-cheetah.layout-rendered"),BACheetah.hideAjaxLoader()},_removeOldContentAndAssets:function(){this._content&&this._content.empty(),this._oldCss&&this._oldCss.remove(),this._oldJs&&this._oldJs.remove(),this._oldScriptsStyles&&this._oldScriptsStyles.remove()},_cleanNewHTML:function(){var e,t,a,i;this._data.scriptsStyles&&(e=h("<div>"+this._data.html+"</div>"),t="ba-cheetah-row",a=this._data.scriptsStyles,i="",this._data.partial&&(t="column-group"==this._data.nodeType?"ba-cheetah-col-group":"column"==this._data.nodeType?"ba-cheetah-col":"row-inside"==this._data.nodeType?"ba-cheetah-row-type-row-inside":"ba-cheetah-"+this._data.nodeType),e.find("> *, script").each(function(){h(this).hasClass(t)||"application/json"==h(this).attr("type")||(i=h(this).remove(),a+=i[0].outerHTML)}),""!==a&&(a=this._data.partial?'<div class="ba-cheetah-node-scripts-styles" data-node="'+this._data.nodeId+'">'+a+"<div>":'<div class="ba-cheetah-node-scripts-styles">'+a+"<div>"),this._data.html=e.html(),this._data.scriptsStyles=a)},_addNewHTML:function(){var e;this._data.partial?this._data.nodeParent?(0===(e=(e=this._data.nodeParent.hasClass("ba-cheetah-content")?this._data.nodeParent.find(" > .ba-cheetah-row"):this._data.nodeParent.hasClass("ba-cheetah-row-content")?this._data.nodeParent.find(" > .ba-cheetah-col-group"):this._data.nodeParent.hasClass("ba-cheetah-col-group")?this._data.nodeParent.find(" > .ba-cheetah-col"):this._data.nodeParent.find(" > .ba-cheetah-col-group, > .ba-cheetah-module")).filter(":not(.ba-cheetah-node-clone)")).length||this._data.nodePosition>=e.length?this._data.nodeParent.append(this._data.html):e.eq(this._data.nodePosition).before(this._data.html),this._data.nodeId&&BACheetah._removeNodeLoadingPlaceholder(h(".ba-cheetah-node-"+this._data.nodeId))):(this._content.after(this._data.html),this._content.remove()):this._content.append(this._data.html),BACheetah.preview&&this._data.nodeId&&this._data.nodeId!=BACheetah.preview.nodeId&&((e=h(BACheetah.preview.classes.node)).closest(".ba-cheetah-node-"+this._data.nodeId).length&&e.html(BACheetah.preview.elements.node.html())),this._data.onAddNewHTML&&this._data.onAddNewHTML()},_cleanNewAssets:function(){var e=this;this._data.html=this._removeDuplicateAssets(this._data.html),this._data.scriptsStyles&&""!==this._data.scriptsStyles&&(this._data.scriptsStyles=this._removeDuplicateAssets(this._data.scriptsStyles)),this._data.partial?h(".ba-cheetah-node-scripts-styles").each(function(){-1<e._data.html.indexOf("ba-cheetah-node-"+h(this).data("node"))&&h(this).remove()}):(h("#ba-cheetah-partial-refresh-js").remove(),h(".ba-cheetah-node-scripts-styles").remove())},_removeDuplicateAssets:function(e){var t=h("<div>"+e+"</div>"),a="",i="",e=window.location,o=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"");return t.find("script").each(function(){void 0!==(a=h(this).attr("src"))&&(a=a.replace(o,""),0<h('script[src*="'+a+'"]').length&&h(this).remove())}),t.find("link").each(function(){void 0!==(i=h(this).attr("href"))&&(i=i.replace(o,""),0<h('link[href*="'+i+'"]').length&&h(this).remove())}),t.html()},_addNewScriptsStyles:function(){this._data.scriptsStyles&&""!==this._data.scriptsStyles&&this._body.append(this._data.scriptsStyles)},_addNewJS:function(){setTimeout(h.proxy(function(){this._newJs&&this._head.append(this._newJs),BACheetah.triggerHook("didRenderLayoutJSComplete")},this),50)},_complete:function(){BACheetah._dragging?(BACheetah._highlightRowsAndColsForDrag(),BACheetah._refreshSortables()):(BACheetah._setupEmptyLayout(),BACheetah._highlightEmptyCols(),BACheetah._initDropTargets(),BACheetah._initSortables(),BACheetah._resizeLayout()),BACheetah._initMediaElements(),BACheetahLayout.init(),BACheetahResponsiveEditing.refreshPreview(this._callback),BACheetah.triggerHook("didRenderLayoutComplete"),this._body.height("auto")}}}(jQuery),function(u){BACheetahPreview=function(e){this.id=(new Date).getTime(),this.type=e.type,this._saveState(),e.layout?BACheetah._renderLayout(e.layout,function(){this._init(),e.callback&&e.callback()}.bind(this)):this._init()},BACheetahPreview._fontsList={},BACheetahPreview.getFormattedSelector=function(e,t){for(var a="",i=t.split(","),o=0;o<i.length;o++)-1<i[o].indexOf("{node}")?a+=i[o].replace("{node}",e):-1<i[o].indexOf("{node_id}")?a+=i[o].replace(/{node_id}/g,this.nodeId):a+=e+" "+i[o],o!=i.length-1&&(a+=", ");return a},BACheetahPreview.prototype={id:"",type:"",nodeId:null,classes:{},elements:{},state:null,_savedSettings:null,_styleSheet:null,_styleSheetMedium:null,_styleSheetResponsive:null,_timeout:null,_loaderTimeout:null,_lastClassName:null,_xhr:null,_init:function(){switch(this.nodeId=u(".ba-cheetah-settings").data("node"),this._saveSettings(),this._initElementsAndClasses(),this._createSheets(),this._initResponsivePreviews(),this._initDefaultFieldPreviews(),this.type){case"row":case"row-inside":this._initRow();break;case"col":this._initColumn();break;case"module":this._initModule();break;case"page":case"global":this._initGlobal()}BACheetah.triggerHook("preview-init",this)},_saveSettings:function(){var e=u(".ba-cheetah-settings-lightbox .ba-cheetah-settings");this._savedSettings=BACheetah._getSettingsForChangedCheck(this.nodeId,e)},_settingsHaveChanged:function(){var e=u(".ba-cheetah-settings-lightbox .ba-cheetah-settings"),e=BACheetah._getSettings(e);return JSON.stringify(this._savedSettings)!=JSON.stringify(e)},_initElementsAndClasses:function(){var e="row"==this.type?".ba-cheetah-row-content-wrap":".ba-cheetah-"+this.type+"-content";let t,a;switch(this.type){case"page":t="html",a="html body.ba-cheetah.page-id-"+BACheetahConfig.postId;break;case"global":t="html",a="html body.ba-cheetah";break;default:t=BACheetah._contentClass+" .ba-cheetah-node-"+this.nodeId,a=BACheetah._contentClass+" .ba-cheetah-node-"+this.nodeId+" > "+e}u.extend(this.classes,{settings:".ba-cheetah-"+this.type+"-settings",settingsHeader:".ba-cheetah-"+this.type+"-settings .ba-cheetah-lightbox-header",node:t,content:a}),u.extend(this.elements,{settings:u(this.classes.settings),settingsHeader:u(this.classes.settingsHeader),node:u(this.classes.node),content:u(this.classes.content)})},_createSheets:function(){this._destroySheets(),this._styleSheet||(this._styleSheet=new BACheetahStyleSheet({id:"ba-cheetah-preview",className:"ba-cheetah-preview-style"})),this._styleSheetMedium||(this._styleSheetMedium=new BACheetahStyleSheet({id:"ba-cheetah-preview-medium",className:"ba-cheetah-preview-style"}),this._styleSheetMedium.disable()),this._styleSheetResponsive||(this._styleSheetResponsive=new BACheetahStyleSheet({id:"ba-cheetah-preview-responsive",className:"ba-cheetah-preview-style"}),this._styleSheetResponsive.disable())},_destroySheets:function(){this._styleSheet&&(this._styleSheet.destroy(),this._styleSheet=null),this._styleSheetMedium&&(this._styleSheetMedium.destroy(),this._styleSheetMedium=null),this._styleSheetResponsive&&(this._styleSheetResponsive.destroy(),this._styleSheetResponsive=null)},_disableStyles:function(){var e=BACheetahResponsiveEditing._mode,t=BACheetahConfig.global,a=this.elements.node;"responsive"===e?(BACheetahSimulateMediaQuery.disableStyles(t.responsive_breakpoint),this._styleSheetResponsive.disable()):"medium"===e?(BACheetahSimulateMediaQuery.disableStyles(t.medium_breakpoint),this._styleSheetMedium.disable()):a.removeClass(function(e,t){return(t.match(/ba-cheetah-node-[^\s]*/g)||[]).join(" ")})},_enableStyles:function(){var e=BACheetahResponsiveEditing._mode,t=this.elements.node;"responsive"===e?(BACheetahSimulateMediaQuery.enableStyles(),this._styleSheetResponsive.enable()):"medium"===e?(BACheetahSimulateMediaQuery.enableStyles(),this._styleSheetMedium.enable()):t.addClass("ba-cheetah-node-"+t.data("node"))},_getDefaultValue:function(e,t){var a="",i=u(e),e=i.closest("[data-node]");return"width"===t?a="auto":-1===u.inArray(t,["line-height","font-weight"])&&e.length&&(this._disableStyles(),a=i.css(t),this._enableStyles()),a},updateCSSRule:function(e,t,a,i){var o=BACheetahResponsiveEditing._mode,h="";""!==a&&"null"!==a||(a=this._getDefaultValue(e,t)),i?(h="string"==typeof i?this.toUpperCaseWords(i):"default"===o?"":this.toUpperCaseWords(o),this["_styleSheet"+h].updateRule(e,t,a)):this._styleSheet.updateRule(e,t,a)},delay:function(e,t){this._cancelDelay(),this._timeout=setTimeout(t,e)},_cancelDelay:function(){null!==this._timeout&&clearTimeout(this._timeout)},hexToRgb:function(e){e=parseInt(e,16);return[e>>16&255,e>>8&255,255&e]},hexOrRgb:function(e){return e=e.indexOf("rgb")<0&&e.indexOf("#")<0?"#"+e:e},parseFloat:function(e){return isNaN(parseFloat(e))?0:parseFloat(e)},_initResponsivePreviews:function(){var e=".preview-"+this.id;BACheetah.addHook("responsive-editing-switched"+e,u.proxy(this._responsiveEditingSwitched,this)),BACheetah.addHook("responsive-editing-before-preview-fields"+e,u.proxy(this._responsiveEditingPreviewFields,this))},_destroyResponsivePreviews:function(){var e=".preview-"+this.id;BACheetah.removeHook("responsive-editing-switched"+e),BACheetah.removeHook("responsive-editing-before-preview-fields"+e)},_responsiveEditingSwitched:function(e,t){"default"==t?(this._styleSheetMedium.disable(),this._styleSheetResponsive.disable()):"medium"==t?(this._styleSheetMedium.enable(),this._styleSheetResponsive.disable()):"responsive"==t&&(this._styleSheetMedium.enable(),this._styleSheetResponsive.enable())},_responsiveEditingPreviewFields:function(e,t){"medium"===t&&"col"===this.type&&this.elements.node[0].style.width&&(size=parseFloat(this.elements.node[0].style.width),this.elements.size.val(size))},updateResponsiveCSSRule:function(e,t,a){this.updateCSSRule(e,t,a,!0)},_saveState:function(){var e=BACheetahConfig.postId,t=u('link[href*="/cache/'+e+'"]').attr("href"),a=u('script[src*="/cache/'+e+'"]').attr("src"),e=u(BACheetah._contentClass).html();this.state={css:t,js:a,html:e}},preview:function(){var e=u(".ba-cheetah-settings-lightbox .ba-cheetah-settings"),t=e.attr("data-node"),e=BACheetah._getSettings(e);if(BACheetah._showNodeLoading(t),this._cancelPreview(),"error"===(e=BACheetah._inputVarsCheck(e)))return 0;this._xhr=BACheetah.ajax({action:"render_layout",node_id:t,node_preview:e,preview_type:this.type},u.proxy(this._renderPreview,this))},revertGlobalPagePreview:function(){this._xhr=BACheetah.ajax({action:"render_layout",node_id:null,node_preview:BACheetahSettingsConfig.settings[this.type],preview_type:this.type},u.proxy(this._renderPreview,this))},delayPreview:function(e){this.delay(1e3,u.proxy(this.preview,this))},_cancelPreview:function(){this._xhr&&(this._xhr.abort(),this._xhr=null)},_renderPreview:function(e){this._xhr=null,BACheetah._renderLayout(e,u.proxy(this._renderPreviewComplete,this))},_renderPreviewComplete:function(){this._createSheets(),this._initElementsAndClasses(),this._initDefaultFieldPreviews(),null!==this._loaderTimeout&&clearTimeout(this._loaderTimeout),u(".ba-cheetah-preview-loader").remove(),u(BACheetah._contentClass).trigger("ba-cheetah.preview-rendered")},revert:function(){var e=this.nodeId;this._settingsHaveChanged()?("col"===this.type&&(e=this.elements.node.closest(".ba-cheetah-col-group").data("node")),BACheetah._updateNode(e,function(){this.clear()}.bind(this))):this.clear()},cancel:function(){this._cancelDelay(),this._cancelPreview()},clear:function(){this.cancel(),this._destroySheets(),this._destroyResponsivePreviews()},_initNodeTextColor:function(){u.extend(this.elements,{textColor:u(this.classes.settings+" input[name=text_color]"),linkColor:u(this.classes.settings+" input[name=link_color]"),hoverColor:u(this.classes.settings+" input[name=hover_color]"),headingColor:u(this.classes.settings+" input[name=heading_color]")}),this.elements.textColor.on("change",u.proxy(this._textColorChange,this)),this.elements.linkColor.on("change",u.proxy(this._textColorChange,this)),this.elements.hoverColor.on("change",u.proxy(this._textColorChange,this)),this.elements.headingColor.on("change",u.proxy(this._textColorChange,this))},_textColorChange:function(e){var t=this.elements.textColor.val(),a=this.elements.linkColor.val(),i=this.elements.hoverColor.val(),o=this.elements.headingColor.val(),a=""===a?t:a,i=""===i?t:i,o=""===o?t:o;t&&t.indexOf("rgb")<0&&(t="#"+t),a&&a.indexOf("rgb")<0&&(a="#"+a),i&&i.indexOf("rgb")<0&&(i="#"+i),o&&o.indexOf("rgb")<0&&(o="#"+o),this.delay(50,u.proxy(function(){""===t?this.updateCSSRule(this.classes.node,"color",""):this.updateCSSRule(this.classes.node,"color",t),""===a?this.updateCSSRule(this.classes.node+" a","color",""):this.updateCSSRule(this.classes.node+" a","color",a),""===i?this.updateCSSRule(this.classes.node+" a:hover","color",""):this.updateCSSRule(this.classes.node+" a:hover","color",i),""===o?(this.updateCSSRule(this.classes.node+" h1","color",""),this.updateCSSRule(this.classes.node+" h2","color",""),this.updateCSSRule(this.classes.node+" h3","color",""),this.updateCSSRule(this.classes.node+" h4","color",""),this.updateCSSRule(this.classes.node+" h5","color",""),this.updateCSSRule(this.classes.node+" h6","color",""),this.updateCSSRule(this.classes.node+" h1 a","color",""),this.updateCSSRule(this.classes.node+" h2 a","color",""),this.updateCSSRule(this.classes.node+" h3 a","color",""),this.updateCSSRule(this.classes.node+" h4 a","color",""),this.updateCSSRule(this.classes.node+" h5 a","color",""),this.updateCSSRule(this.classes.node+" h6 a","color","")):(this.updateCSSRule(this.classes.node+" h1","color",o),this.updateCSSRule(this.classes.node+" h2","color",o),this.updateCSSRule(this.classes.node+" h3","color",o),this.updateCSSRule(this.classes.node+" h4","color",o),this.updateCSSRule(this.classes.node+" h5","color",o),this.updateCSSRule(this.classes.node+" h6","color",o),this.updateCSSRule(this.classes.node+" h1 a","color",o),this.updateCSSRule(this.classes.node+" h2 a","color",o),this.updateCSSRule(this.classes.node+" h3 a","color",o),this.updateCSSRule(this.classes.node+" h4 a","color",o),this.updateCSSRule(this.classes.node+" h5 a","color",o),this.updateCSSRule(this.classes.node+" h6 a","color",o))},this))},_initNodeBg:function(){u.extend(this.elements,{bgType:u(this.classes.settings+" select[name=bg_type]"),bgColor:u(this.classes.settings+" input[name=bg_color]"),bgColorPicker:u(this.classes.settings+" .ba-cheetah-picker-bg_color"),bgGradientType:u(this.classes.settings+" select.ba-cheetah-gradient-picker-type-select"),bgVideoSource:u(this.classes.settings+" select[name=bg_video_source]"),bgVideo:u(this.classes.settings+" input[name=bg_video]"),bgVideoServiceUrl:u(this.classes.settings+" input[name=bg_video_service_url]"),bgVideoFallbackSrc:u(this.classes.settings+" select[name=bg_video_fallback_src]"),bgSlideshowSource:u(this.classes.settings+" select[name=ss_source]"),bgSlideshowPhotos:u(this.classes.settings+" input[name=ss_photos]"),bgSlideshowFeedUrl:u(this.classes.settings+" input[name=ss_feed_url]"),bgSlideshowSpeed:u(this.classes.settings+" input[name=ss_speed]"),bgSlideshowTrans:u(this.classes.settings+" select[name=ss_transition]"),bgSlideshowTransSpeed:u(this.classes.settings+" input[name=ss_transitionDuration]"),bgParallaxImageSrc:u(this.classes.settings+" select[name=bg_parallax_image_src]"),bgOverlayType:u(this.classes.settings+" select[name=bg_overlay_type]"),bgOverlayColor:u(this.classes.settings+" input[name=bg_overlay_color]"),bgOverlayGradient:u(this.classes.settings+" #ba-cheetah-field-bg_overlay_gradient select")}),this.elements.bgType.on("change",u.proxy(this._bgTypeChange,this)),this.elements.bgColor.on("change",u.proxy(this._bgColorChange,this)),this.elements.bgVideoServiceUrl.on("change",u.proxy(this._bgVideoChange,this)),this.elements.bgSlideshowSource.on("change",u.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowPhotos.on("change",u.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowFeedUrl.on("keyup",u.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowSpeed.on("keyup",u.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTrans.on("change",u.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTransSpeed.on("keyup",u.proxy(this._bgSlideshowChange,this)),this.elements.bgParallaxImageSrc.on("change",u.proxy(this._bgParallaxChange,this)),this.elements.bgOverlayType.on("change",u.proxy(this._bgOverlayChange,this)),this.elements.bgOverlayColor.on("change",u.proxy(this._bgOverlayChange,this))},_bgTypeChange:function(e){var t=this.elements.bgType.val(),a=BACheetahResponsiveEditing._mode;this.elements.node.removeClass("ba-cheetah-row-bg-video"),this.elements.node.removeClass("ba-cheetah-row-bg-slideshow"),this.elements.node.removeClass("ba-cheetah-row-bg-parallax"),this.elements.node.find(".ba-cheetah-bg-video").remove(),this.elements.node.find(".ba-cheetah-bg-slideshow").remove(),this.elements.content.css("background-image",""),this.updateCSSRule(this.classes.content,"background-color","transparent"),this.updateCSSRule(this.classes.content,"background-image","none"),this.updateCSSRule(this.classes.content,"background-image","none","medium"),this.updateCSSRule(this.classes.content,"background-image","none","responsive"),"none"==t?this._bgOverlayClear():"color"==t?(this.elements.bgColor.trigger("change"),this._bgOverlayClear()):"gradient"==t?(this.elements.bgGradientType.trigger("change"),this._bgOverlayClear()):"photo"==t?(this.elements.bgColor.trigger("change"),this.elements.settings.find('[data-device="'+a+'"] select[name*="bg_"]').trigger("change")):"video"==t?(this.elements.bgColor.trigger("change"),this._bgVideoChange()):"slideshow"==t?(this.elements.bgColor.trigger("change"),this._bgSlideshowChange()):"parallax"==t&&(this.elements.bgColor.trigger("change"),this.elements.bgParallaxImageSrc.trigger("change"))},_bgColorChange:function(e){var t;""===this.elements.bgColor.val()?this.updateCSSRule(this.classes.content,"background-color","transparent"):(t=this.hexOrRgb(this.elements.bgColor.val()),this.delay(100,u.proxy(function(){this.updateCSSRule(this.classes.content,"background-color",t)},this)))},_bgVideoChange:function(e){var t=this.elements,a=t.bgVideoSource.val(),i=t.bgVideo.val(),o=t.bgVideoServiceUrl.val(),t=u("<script>");"video_service"==a&&""!=o?(/^(?:(?:(?:https?:)?\/\/)?(?:www.)?(?:youtu(?:be.com|.be))\/(?:watch\?v\=|v\/|embed\/)?([\w\-]+))/i.test(o)&&u('script[src*="youtube.com"').length<1?t.attr("src","https://www.youtube.com/iframe_api"):/^(http\:\/\/|https\:\/\/)?(www\.)?(vimeo\.com\/)([0-9]+)$/.test(o)&&u('script[src*="vimeo.com"').length<1&&t.attr("src","https://player.vimeo.com/api/player.js"),t.attr("type","text/javascript").appendTo("head"),this.delay(500,u.proxy(this.preview,this))):""!=i&&this.preview()},_bgSlideshowChange:function(e){var t=this.elements,a=t.bgSlideshowSource.val(),i=t.bgSlideshowPhotos.val(),o=t.bgSlideshowFeedUrl.val(),h=t.bgSlideshowSpeed.val(),t=t.bgSlideshowTransSpeed.val();"wordpress"==a&&""===i||"smugmug"==a&&""===o||isNaN(parseInt(h))||isNaN(parseInt(t))||this.delay(500,u.proxy(this.preview,this))},_bgParallaxChange:function(e){this.elements.bgParallaxImageSrc.val()&&this.updateCSSRule(this.classes.content,{"background-image":"url("+this.elements.bgParallaxImageSrc.val()+")","background-repeat":"no-repeat","background-position":"center center","background-attachment":"fixed","background-size":"cover"})},_bgOverlayChange:function(e){var t,a=this.elements.bgOverlayType.val(),i=this.elements.bgOverlayColor.val();"color"===a?(""===i?(this.elements.node.removeClass("ba-cheetah-row-bg-overlay"),this.elements.node.removeClass("ba-cheetah-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent")):(t=this.hexOrRgb(this.elements.bgOverlayColor.val()),this.delay(100,u.proxy(function(){this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color",t)},this))),this.updateCSSRule(this.classes.content+"::after","background-image","none")):"gradient"===a?(this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.elements.bgOverlayGradient.trigger("change")):(this.elements.node.removeClass("ba-cheetah-row-bg-overlay"),this.elements.node.removeClass("ba-cheetah-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.updateCSSRule(this.classes.content+"::after","background-image","none"))},_bgOverlayAddClasses:function(){this.elements.node.hasClass("ba-cheetah-col")?this.elements.node.addClass("ba-cheetah-col-bg-overlay"):this.elements.node.addClass("ba-cheetah-row-bg-overlay")},_bgOverlayClear:function(e){this.elements.bgOverlayColor.prev(".ba-cheetah-color-picker-clear").trigger("click"),this.elements.bgOverlayType.val("color").trigger("change")},_initNodeClassName:function(){u.extend(this.elements,{className:u(this.classes.settings+" input[name=class]")}),this.elements.className.on("keyup",u.proxy(this._classNameChange,this)),this._lastClassName=this.elements.className.val()},_classNameChange:function(e){var t=this.elements.className.val();null!==this._lastClassName&&this.elements.node.removeClass(this._lastClassName),this.elements.node.addClass(t),this._lastClassName=t},_initNodeDimensions:function(e){for(var t,a={},i=["Top","Bottom","Left","Right"],o=["","Medium","Responsive"],h=this.classes.settings,s="",n=null,l=null,n=0;n<i.length;n++)for(l=0;l<o.length;l++)t=e+i[n]+o[l],s=e+"_"+i[n].toLowerCase(),""!=o[l]&&(s+="_"+o[l].toLowerCase()),a[t]=u(h+" input[name="+s+"]");u.extend(this.elements,a)},_initGlobal:function(){},_initRow:function(){u.extend(this.elements,{width:u(this.classes.settings+" select[name=width]"),contentWidth:u(this.classes.settings+" select[name=content_width]"),maxContentWidth:u(this.classes.settings+" input[name=max_content_width]"),maxContentWidthUnit:u(this.classes.settings+" select[name=max_content_width_unit]"),height:u(this.classes.settings+" select[name=full_height]"),minHeight:u(this.classes.settings+" input[name=min_height]"),align:u(this.classes.settings+" select[name=content_alignment]")}),this.elements.width.on("change",u.proxy(this._rowWidthChange,this)),this.elements.contentWidth.on("change",u.proxy(this._rowContentWidthChange,this)),this.elements.maxContentWidth.on("input",u.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthUnit.on("change",u.proxy(this._rowMaxContentWidthChange,this)),this.elements.height.on("change",u.proxy(this._rowHeightChange,this)),this.elements.align.on("change",u.proxy(this._rowHeightChange,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding")},_rowWidthChange:function(e){BACheetahConfig.global;var t=this.elements.node,a=this.elements.content.find(".ba-cheetah-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();t.css("max-width","none"),a.css("max-width","none"),"full"==this.elements.width.val()?(t.removeClass("ba-cheetah-row-fixed-width"),t.addClass("ba-cheetah-row-full-width")):(t.removeClass("ba-cheetah-row-full-width"),t.addClass("ba-cheetah-row-fixed-width")),this._rowMaxContentWidthChange()},_rowContentWidthChange:function(e){BACheetahConfig.global;var t=this.elements.node,a=this.elements.content.find(".ba-cheetah-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();t.css("max-width","none"),a.css("max-width","none"),"full"==this.elements.contentWidth.val()?(a.removeClass("ba-cheetah-row-fixed-width"),a.addClass("ba-cheetah-row-full-width")):(a.removeClass("ba-cheetah-row-full-width"),a.addClass("ba-cheetah-row-fixed-width"),this._rowMaxContentWidthChange())},_rowMaxContentWidthChange:function(e){var t=BACheetahConfig.global,a=this.elements.node,i=this.elements.content.find(".ba-cheetah-row-content"),o=this.elements.maxContentWidth.val(),h=this.elements.maxContentWidthUnit.val();""==o?o=t.row_width+t.row_width_unit:o+=h,"fixed"===this.elements.width.val()&&a.css("max-width",o),i.css("max-width",o)},_rowHeightChange:function(e){var t=this.elements.node;this.elements.content;t.removeClass("ba-cheetah-row-align-top"),t.removeClass("ba-cheetah-row-align-center"),t.removeClass("ba-cheetah-row-align-bottom"),t.removeClass("ba-cheetah-row-full-height"),t.removeClass("ba-cheetah-row-custom-height"),"full"==this.elements.height.val()?(t.addClass("ba-cheetah-row-full-height"),t.addClass("ba-cheetah-row-align-"+this.elements.align.val()),this.elements.minHeight.val("").trigger("input")):"custom"==this.elements.height.val()?(t.addClass("ba-cheetah-row-custom-height"),t.addClass("ba-cheetah-row-align-"+this.elements.align.val()),this.elements.minHeight.trigger("input")):this.elements.minHeight.val("").trigger("input")},_initColumn:function(){u.extend(this.elements,{size:u(this.classes.settings+" input[name=size]"),sizeMedium:u(this.classes.settings+" input[name=size_medium]"),sizeResponsive:u(this.classes.settings+" input[name=size_responsive]"),columnHeight:u(this.classes.settings+" select[name=equal_height]"),columnAlign:u(this.classes.settings+" select[name=content_alignment]"),responsiveOrder:u(this.classes.settings+" select[name=responsive_order]")}),this.elements.size.on("input",u.proxy(this._colSizeChange,this)),this.elements.sizeMedium.on("input",u.proxy(this._colSizeChange,this)),this.elements.sizeResponsive.on("input",u.proxy(this._colSizeChange,this)),this.elements.columnHeight.on("change",u.proxy(this._colHeightChange,this)),this.elements.columnAlign.on("change",u.proxy(this._colHeightChange,this)),this.elements.responsiveOrder.on("change",u.proxy(this._colResponsiveOrder,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding")},_colSizeChange:function(e){var t=u(e.target),a=92,i=parseFloat(t.val()),o=this.elements.node.closest(".ba-cheetah-col-group"),h=this.elements.node.prev(".ba-cheetah-col"),e=this.elements.node.next(".ba-cheetah-col"),s=0===e.length?h:e,h=this.elements.node.siblings(".ba-cheetah-col"),n=0,e=BACheetahResponsiveEditing._mode;0!==h.length&&(isNaN(i)&&("medium"===e?i=this.elements.size.val():"responsive"===e&&(i=this.elements.sizeMedium.val()?this.elements.sizeMedium.val():"auto"),"auto"!==i&&isNaN(i)&&(i=8)),"default"===e?(h.each(function(){u(this).data("node")!=s.data("node")&&(a-=parseFloat(u(this)[0].style.width),n+=parseFloat(u(this)[0].style.width))}),a<(i=i<8?8:i)&&(i=a),this.elements.node.css("width",i+"%"),s.css("width",100-n-i+"%")):(100<i&&t.val(i=100),this.updateCSSRule(this.classes.node,{"max-width":("auto"===i?100:i)+"% !important",width:("auto"===i?i:i+"%")+" !important"},void 0,!0),"responsive"===e&&(t.val()?(this.updateCSSRule(this.classes.node,"float",BACheetahConfig.isRtl?"right":"left",!0),this.updateCSSRule(this.classes.node,"clear","none",!0)):(this.updateCSSRule(this.classes.node,"float","none",!0),this.updateCSSRule(this.classes.node,"clear","both",!0)),t.val()||this._colsHaveCustomResponsiveWidth(h)?o.addClass("ba-cheetah-col-group-custom-width"):o.removeClass("ba-cheetah-col-group-custom-width"))))},_colsHaveCustomResponsiveWidth:function(e){var t=BACheetahSettingsConfig.nodes,a=!1;return e.each(function(){var e=u(this).data("node");t[e]&&t[e].size_responsive&&(a=!0)}),a},_colHeightChange:function(){var e=this.elements.node.parent(".ba-cheetah-col-group");e.removeClass("ba-cheetah-col-group-align-top"),e.removeClass("ba-cheetah-col-group-align-center"),e.removeClass("ba-cheetah-col-group-align-bottom"),"yes"==this.elements.columnHeight.val()?(e.addClass("ba-cheetah-col-group-equal-height"),e.addClass("ba-cheetah-col-group-align-"+this.elements.columnAlign.val())):e.removeClass("ba-cheetah-col-group-equal-height")},_colResponsiveOrder:function(){var e=this.elements.node.parent(".ba-cheetah-col-group");"reversed"==this.elements.responsiveOrder.val()?e.addClass("ba-cheetah-col-group-responsive-reversed"):e.removeClass("ba-cheetah-col-group-responsive-reversed")},_initModule:function(){this._initNodeClassName(),this._initNodeDimensions("margin")},_initDefaultFieldPreviews:function(e){for(var t,a,e=BACheetah.isUndefined(e)?this.elements.settings.find(".ba-cheetah-field"):e,i=null,o=0;o<e.length;o++)t=(i=e.eq(o)).data("type"),"refresh"==(a=i.data("preview")).type&&this._initFieldRefreshPreview(i),"text"==a.type&&this._initFieldTextPreview(i),"css"==a.type&&this._initFieldCSSPreview(i),"widget"==a.type&&this._initFieldWidgetPreview(i),"font"==a.type&&this._initFieldFontPreview(i),"attribute"==a.type&&this._initFieldAttributePreview(i),"animation"==a.type&&this._initFieldAnimationPreview(a,i),"callback"==a.type&&this._initFieldCallbackPreview(a,i,t,e),this._initFieldUnitSelect(i)},_initFieldCallbackPreview:function(e,t,a,i){var o=e.callback,h=u(".ba-cheetah-settings:visible"),s=h.data("node"),n=u(".ba-cheetah-content .ba-cheetah-node-"+s);if(void 0!==BACheetahPreviewCallbacks[o]?d=BACheetahPreviewCallbacks[o]:void 0!==window[o]&&(d=window[o]),"function"==typeof d){var l={field:t,fields:i,type:a,preview:e,form:h,nodeID:s,node:n};switch(a){case"align":case"button-group":case"text":case"multiple-photos":case"video":case"icon":case"ordering":l.input=t.find("input"),l.getValue=function(){return l.input.val()};break;case"color":l.input=t.find("input.ba-cheetah-color-picker-value"),l.getValues=function(){var e=l.input.val();BACheetahPreview.formatColor(e)};break;case"textarea":case"code":l.textarea=t.find("textarea"),l.getValue=function(){return l.textarea.val()};break;case"select":case"photo-sizes":case"post-type":l.select=t.find("select"),l.getValue=function(){return l.select.val()};break;case"photo":l.input=t.find("input[type=hidden]"),l.sizeSelect=t.find("select"),l.getValues=function(){return{value:l.input.val(),size:l.sizeSelect.val()}};break;case"unit":l.input=t.find("input[type=number]"),l.unitSelect=t.find(".ba-cheetah-field-unit-select"),l.getValues=function(){var e=l.input.val(),t=l.unitSelect.val();return{value:e,unit:t,formattedValue:e+t}};break;case"dimension":l.inputs=t.find("input[type=number]"),l.unitSelect=t.find(".ba-cheetah-field-unit-select"),l.getValues=function(){var i={inputs:[],props:{},unit:l.unitSelect.val()};return l.inputs.each(function(e,t){var a=(t=u(t)).val(),t=t.data("unit");i.inputs.push(a),i.props[t]=a}),i};break;case"animation":l.input=t.find("input"),l.select=t.find("select"),l.getValues=function(){return{delay:l.input.val(),style:l.select.val()}};break;case"link":l.input=t.find(".ba-cheetah-link-field-input-wrap input"),l.targetInput=t.find("input[name$=_target]"),l.noFollowInput=t.find("input[name$=_nofollow]"),l.getValues=function(){return{url:l.input.val(),target:l.targetInput.val(),noFollow:l.noFollowInput.val()}};break;case"shadow":l.colorInput=t.find("input.ba-cheetah-color-picker-value"),l.inputs=t.find("input[type=number]"),l.getValues=function(){l.colorInput.val(),l.inputs[0].val(),l.inputs[1].val(),l.inputs[2].val(),l.inputs[3].val()};break;case"gradient":l.inputs=t.find("input"),l.select=t.find("select"),l.gradientInputs={},l.gradientInputs.type=t.find('select[name$="[type]"]'),l.gradientInputs.angle=t.find('input[name$="[angle]"]'),l.gradientInputs.position=t.find('select[name$="[position]"]'),l.gradientInputs.stops=[],t.find(".ba-cheetah-gradient-picker-colors .ba-cheetah-gradient-picker-color-row").each(function(e,t){t=u(t),l.gradientInputs.stops.push({color:t.find(".ba-cheetah-gradient-picker-color input"),stop:t.find(".ba-cheetah-gradient-picker-stop input")})}),l.getValues=function(){var e,t={type:l.gradientInputs.type.val(),angle:l.gradientInputs.angle.val(),position:l.gradientInputs.position.val(),stops:[]};for(e in l.gradientInputs.stops){var a=l.gradientInputs.stops[e];t.stops[e]={color:a.color.val(),stop:a.stop.val()}}return t};break;case"shape-transform":l.inputs=t.find("input"),l.getValues=function(){return{scaleXSign:l.inputs.eq(0).val(),scaleYSign:l.inputs.eq(1).val(),skewX:l.inputs.eq(2).val(),skewY:l.inputs.eq(3).val(),scaleX:l.inputs.eq(4).val(),rotate:l.inputs.eq(5).val(),scaleY:l.inputs.eq(6).val()}};break;default:l.input=t.find("input"),l.getValue=function(){return l.input.val()}}a=t.find(".ba-cheetah-field-responsive-toggle");l.responsiveToggle=!!a.length&&a;var r,d=d.bind(this,l),c={input:"change keyup input",inputs:"change keyup input",targetInput:"change keyup input",noFollowInput:"change keyup input",colorInput:"change input",textarea:"change keyup input",select:"change",sizeSelect:"change",unitSelect:"change"};for(r in c)void 0!==l[r]&&l[r].on(c[r],d)}},_initFieldRefreshPreview:function(e){var t=e.data("type"),a=e.data("preview"),i=u.proxy(this.delayPreview,this);switch(t){case"align":e.find("input").on("change",i);break;case"text":e.find("input[type=text]").on("keyup",i);break;case"textarea":e.find("textarea").on("keyup",i);break;case"select":e.find("select").on("change",i);break;case"color":e.find(".ba-cheetah-color-picker-value").on("change",i);break;case"photo":e.find("select").on("change",i);break;case"multiple-photos":e.find("input").on("change",i);break;case"photo-sizes":e.find("select").on("change",i);break;case"video":case"multiple-audios":case"icon":e.find("input").on("change",i);break;case"form":e.delegate("input","change",i);break;case"editor":this._addTextEditorCallback(e,a);break;case"code":e.find("textarea").on("change",i);break;case"post-type":e.find("select").on("change",i);break;case"suggest":e.find(".as-values").on("change",i),e.find("select").on("change",i);break;case"unit":case"dimension":e.find("input[type=number]").on("input",i);break;case"ordering":e.find("input[type=hidden]").on("change",i);break;default:e.on("change",i)}},_initFieldTextPreview:function(e){var t=e.data("type"),a=e.data("preview"),i=u.proxy(this._previewText,this,a);switch(t){case"text":e.find("input[type=text]").on("keyup",i);break;case"unit":e.find("input[type=number]").on("keyup",i);break;case"textarea":e.find("textarea").on("keyup",i);break;case"code":e.find("textarea").on("change",i);break;case"editor":this._addTextEditorCallback(e,a)}},_previewText:function(e,t){var a=this._getPreviewSelector(this.classes.node,e.selector),e=u(a),a=u("<div>"+u(t.target).val()+"</div>");0<e.length?(a.find("script").remove(),e.html(a.html())):this.delayPreview(t)},_previewTextEditor:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=u(i),e="undefined"!=typeof tinyMCE?tinyMCE.get(t):null,i=u("#"+t),t="";0<o.length&&((t=e&&"none"==i.css("display")?u("<div>"+e.getContent()+"</div>"):"undefined"==typeof switchEditors||void 0===switchEditors.wpautop?u("<div>"+i.val()+"</div>"):u("<div>"+switchEditors.wpautop(i.val())+"</div>")).find("script").remove(),o.html(t.html()))},_addTextEditorCallback:function(e,t){var a=e.find("textarea.wp-editor-area").attr("id"),e=null;if("refresh"==t.type)e=u.proxy(this.delayPreview,this);else{if("text"!=t.type)return;e=u.proxy(this._previewTextEditor,this,t,a)}u("#"+a).on("keyup",e),"undefined"!=typeof tinyMCE&&(editor=tinyMCE.get(a),editor.on("change",e),editor.on("keyup",e))},_initFieldFontPreview:function(e){var t=e.data("type"),a=e.data("preview");a.id=e.attr("id");a=u.proxy(this._previewFont,this,a);"font"==t&&e.find(".ba-cheetah-font-field").on("change","select",a)},_previewFont:function(e,t){var a=u(t.delegateTarget),i=a.find(".ba-cheetah-font-field-font"),o=u(i).find(":selected").parent().attr("label"),h=a.find(".ba-cheetah-font-field-weight"),s=e.id+"-"+this.nodeId,t=this._getPreviewSelector(this.classes.node,e.selector),a=e.important?" !important":"",e="";"Google"!=o&&"Recently Used"!=o||this._buildFontStylesheet(s,i.val(),h.val());e=i.val();new RegExp("[0-9]").test(i.val())&&(e='"'+i.val()+'"'),this.updateCSSRule(t,"font-family","Default"===i.val()?"":e+a),this.updateCSSRule(t,"font-weight","default"===h.val()?"":h.val()+a)},_buildFontStylesheet:function(e,t,a){var i=BACheetahConfig.googleFontsUrl,o="",h={},s={};h[t]=[a],BACheetahPreview._fontsList[e]=h,Object.keys(BACheetahPreview._fontsList).forEach(function(e){var a=BACheetahPreview._fontsList[e];Object.keys(a).forEach(function(t){var e=a[t];s[t]=s[t]||[],e=e.filter(function(e){return s[t].indexOf(e)<0}),s[t]=s[t].concat(e)})}),u.each(s,function(e,t){o+=e+":"+t.join()+"|"}),o=i+o.slice(0,-1).replace(" ","+"),u("#ba-cheetah-google-fonts-preview").length<1?u("<link>").attr("id","ba-cheetah-google-fonts-preview").attr("type","text/css").attr("rel","stylesheet").attr("href",o).appendTo("head"):u("#ba-cheetah-google-fonts-preview").attr("href",o)},_initFieldCSSPreview:function(e){var t=e.data("preview"),a=null;if(void 0!==t.rules)for(a in t.rules)this._initFieldCSSPreviewCallback(e,t.rules[a]);else this._initFieldCSSPreviewCallback(e,t)},_initFieldCSSPreviewCallback:function(e,t){switch(e.data("type")){case"align":e.find("input").on("change",u.proxy(this._previewCSS,this,t,e));break;case"border":e.find("select").on("change",u.proxy(this._previewBorderCSS,this,t,e)),e.find("input[type=number]").on("input",u.proxy(this._previewBorderCSS,this,t,e)),e.find("input[type=hidden]").on("change",u.proxy(this._previewBorderCSS,this,t,e)),e.find("input.ba-cheetah-color-picker-value").on("change",u.proxy(this._previewBorderCSS,this,t,e));break;case"color":e.find(".ba-cheetah-color-picker-value").on("change",u.proxy(this._previewColorCSS,this,t,e));break;case"dimension":e.find("input[type=number]").on("input",u.proxy(this._previewDimensionCSS,this,t,e));break;case"gradient":e.find("select").on("change",u.proxy(this._previewGradientCSS,this,t,e)),e.find(".ba-cheetah-gradient-picker-angle").on("input",u.proxy(this._previewGradientCSS,this,t,e)),e.find(".ba-cheetah-color-picker-value").on("change",u.proxy(this._previewGradientCSS,this,t,e)),e.find(".ba-cheetah-gradient-picker-stop").on("input",u.proxy(this._previewGradientCSS,this,t,e));break;case"photo":case"select":e.find("select").on("change",u.proxy(this._previewCSS,this,t,e));break;case"shadow":e.find("input").on("input",u.proxy(this._previewShadowCSS,this,t,e)),e.find(".ba-cheetah-color-picker-value").on("change",u.proxy(this._previewShadowCSS,this,t,e));break;case"text":e.find("input[type=text]").on("keyup",u.proxy(this._previewCSS,this,t,e));break;case"typography":e.find("select").on("change",u.proxy(this._previewTypographyCSS,this,t,e)),e.find("input[type=number]").on("input",u.proxy(this._previewTypographyCSS,this,t,e)),e.find("input[type=hidden]").on("change",u.proxy(this._previewTypographyCSS,this,t,e));break;case"unit":e.find("input[type=number]").on("input",u.proxy(this._previewCSS,this,t,e))}},_previewCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=e.property,h=this._getPreviewCSSUnit(e,t,a),t=u(a.target),a=t.val(),t=!!t.closest(".ba-cheetah-field-responsive-setting").length,e=e.important&&""!==a?" !important":"";-1<o.indexOf("image")&&a?a="url("+a+")":"%"===h&&"opacity"===o?a=parseInt(a)/100:""!==a&&(a+=h),this.updateCSSRule(i,o,a+e,t)},_previewBorderCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=u(a.target),t=o.closest(".ba-cheetah-field"),h=o.closest(".ba-cheetah-compound-field-setting"),s=h.data("property"),n=o.val(),l=(h.find(".ba-cheetah-field-unit-select"),!!o.closest(".ba-cheetah-field-responsive-setting").length),o=e.important&&""!==n?" !important":"";"border-color"===(e.property=s)?this._previewColorCSS(e,t,a):"border-width"===s||"border-radius"===s?this._previewDimensionCSS(e,t,a):"box-shadow"===s?this._previewShadowCSS(e,h,a):("border-style"===s&&t.find(".ba-cheetah-border-field-width input:visible").trigger("input"),this.updateCSSRule(i,s,n+o,l))},_previewColorCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=u(a.target),h=o.val(),a=!!o.closest(".ba-cheetah-field-responsive-setting").length,o=e.important&&""!==h?" !important":"";""!==h&&h.indexOf("rgb")<0&&(h="#"+h),["background","background-color","color","border-color"].includes(e.property)&&""==h&&(h="inherit"),this.updateCSSRule(i,e.property,h+o,a)},_previewDimensionCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=e.property,h=t.attr("id").replace("ba-cheetah-field-",""),s=u(a.target).data("unit"),a=this._getDimensionValue(e,t,s,a),t=!!t.find(".ba-cheetah-field-responsive-setting").length,e=e.important&&""!==a?" !important":"",o="border-radius"===o?"border-"+s.replace("_","-")+"-radius":"border-width"===o?"border-"+s+"-width":o+"-"+s;this.updateCSSRule(i,o,a+e,t),"margin"!==h&&"padding"!==h&&"border"!==h||this.elements.node.find(".ba-cheetah-bg-slideshow").length&&BACheetah._resizeLayout()},_getDimensionValue:function(e,t,a,i){var o,h=u(i.target).val();return null===(h=h.toLowerCase().replace(/[^a-z0-9%.\-]/g,""))||""===h||isNaN(h)||(o=this._getPreviewCSSUnit(e,t,i),h=parseFloat(h)+(o||"px")),h},_getPreviewCSSUnit:function(e,t,a){var i=u(a.target),o=(BACheetahResponsiveEditing._mode,!!i.closest(".ba-cheetah-compound-field-setting").length),h=!!i.closest(".ba-cheetah-field-responsive-setting").length,a=null;return(a=(o?i.closest(".ba-cheetah-compound-field-setting"):h?i.closest(".ba-cheetah-field-responsive-setting"):t).find(".ba-cheetah-field-unit-select"))&&a.length?"SELECT"===a.prop("tagName")?a.val():a.text():e.unit||""},_initFieldUnitSelect:function(e){e.find(".ba-cheetah-field-unit-select").on("change",function(){var e=u(this),t=e.closest(".ba-cheetah-field-responsive-setting"),e=e.closest(".ba-cheetah-field");(t.length?t:e).find("input").trigger("input")})},_previewGradientCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=t.find(".ba-cheetah-gradient-picker-type-select").val(),h=t.find(".ba-cheetah-gradient-picker-angle").val(),s=t.find(".ba-cheetah-gradient-picker-position").val(),n=t.find(".ba-cheetah-color-picker-value"),l=t.find(".ba-cheetah-gradient-picker-stop input"),r=[],d="",t="";n.each(function(e){var t=u(this).val(),e=l.eq(e).val();(t=""===t?"rgba(255,255,255,0)":t).indexOf("rgb")<0&&(t="#"+t),isNaN(e)&&(e=0),r.push(t+" "+e+"%")}),r=r.join(", "),d="linear"===o?"linear-gradient("+(h=isNaN(h)?0:h)+"deg, "+r+")":"radial-gradient(at "+s+", "+r+")",t=e.important&&""!==d?" !important":"",this.updateCSSRule(i,e.property,d+t)},_previewShadowCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=t.find(".ba-cheetah-shadow-field-color input.ba-cheetah-color-picker-value").val(),h=t.find(".ba-cheetah-shadow-field-horizontal input").val(),s=t.find(".ba-cheetah-shadow-field-vertical input").val(),n=t.find(".ba-cheetah-shadow-field-blur input").val(),l=t.find(".ba-cheetah-shadow-field-spread input").val(),r=!!t.find(".ba-cheetah-shadow-field-spread input").length,d=!!u(a.target).closest(".ba-cheetah-field-responsive-setting").length,t="",a="";""!==o?(""===h&&(h=0),""===s&&(s=0),""===n&&(n=0),""===l&&(l=0),o.indexOf("rgb")<0&&(o="#"+o),t=h+"px ",t+=s+"px ",t+=n+"px ",r&&"filter"!=e.property&&(t+=l+"px "),t+=o,t+=a,"filter"==e.property&&(t="drop-shadow("+t+")")):t="unset",a=e.important&&""!==t?" !important":"",this.updateCSSRule(i,e.property,t,d)},_previewTypographyCSS:function(e,t,a){var i=this._getPreviewSelector(this.classes.node,e.selector),o=u(a.target),t=o.closest(".ba-cheetah-field"),h=o.closest(".ba-cheetah-compound-field-setting"),s=h.data("property"),n=o.val(),l=h.find(".ba-cheetah-field-unit-select"),r=!!o.closest(".ba-cheetah-field-responsive-setting").length,o=e.important&&""!==n?" !important":"";"font-family"===s?(e.id=t.attr("id"),this._previewFont(e,{delegateTarget:h})):"text-shadow"===s?(e.property="text-shadow",this._previewShadowCSS(e,h,a)):(l.length&&""!==n&&("vw"===l.val()?n="calc("+BACheetahConfig.global.responsive_base_fontsize+"px + "+n+"vw)":n+="SELECT"===l.prop("tagName")?l.val():"px"),this.updateCSSRule(i,s,n+o,r))},_initFieldAttributePreview:function(e){var t=e.data("preview"),a=t.attribute,i=e.find("input, select"),e=(e.val(),window[t.format_callback]),t=this._getPreviewSelector(this.classes.node,t.selector),t=u(t),e=this._previewAttribute.bind(this,i,t,a,e);i.on("change",e),i.on("keyup",e),i.on("input",e)},_previewAttribute:function(e,t,a,o){var h=e.val();for("function"==typeof o&&(h=o(h)),i=0;i<t.length;i++)t[i].setAttribute(a,h)},_initFieldWidgetPreview:function(e){var t=u.proxy(this.delayPreview,this);e.find("input").on("keyup",t),e.find("input[type=checkbox]").on("click",t),e.find("textarea").on("keyup",t),e.find("select").on("change",t)},_initFieldAnimationPreview:function(e,t){t.find(".ba-cheetah-animation-field-style select").on("change",u.proxy(this._previewAnimationField,this,e,t)),t.find(".ba-cheetah-animation-field-duration input").on("input",u.proxy(this._previewAnimationField,this,e,t))},_previewAnimationField:function(e,t,a){var e=this._getPreviewSelector(this.classes.node,e.selector),i=u(e),e=t.find(".ba-cheetah-animation-field-style select"),t=t.find(".ba-cheetah-animation-field-duration input"),o=e[0].options;i.removeClass("ba-cheetah-animated"),i.removeClass("ba-cheetah-animation"),i.css("animation-duration","");for(var h=0;h<o.length;h++)i.removeClass("ba-cheetah-"+o[h].value);""!==e.val()&&(i.addClass("ba-cheetah-animation"),i.addClass("ba-cheetah-"+e.val()),i.data("animation-delay",0),i.data("animation-duration",t.val())),BACheetahLayout._doModuleAnimation.apply(i)},_getPreviewSelector:function(e,t){return"page"==this.type&&(t+=".page-id-"+BACheetahConfig.postId),BACheetahPreview.getFormattedSelector.call(this,e,t)},toUpperCaseWords:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},BACheetahPreview.formatColor=function(e){return e=""!==e&&e.indexOf("rgb")<0&&e.indexOf("url")<0&&e.indexOf("#")<0?"#"+e:e},BACheetahPreviewCallbacks={previewShape:function(e,t){var a=e.preview.position,i=e.preview.prefix,e=e.form;yOrientation=e.find('input[name="'+(i+"transform[][scaleYSign]")+'"]'),"bottom"===a?yOrientation.val("invert"):yOrientation.val(""),yOrientation.trigger("change"),this.delayPreview()},previewCSSVar:function(e,t){var a=e.getValues(),i=e.preview,e=this._getPreviewSelector(this.classes.node,i.selector);u(e).get(0).style.setProperty(i.variable,a.formattedValue)},previewShapeLayerSize:function(e,t){var a,i=e.getValues(),o=i.unit,h=i.props.width,s=i.props.height,n=i.props.top,l=e.preview.prefix,r=e.preview.position,d=this._getPreviewSelector(this.classes.node,".ba-cheetah-"+r+"-edge-layer"),c=d+" > *",u=e.form.find('[name="'+l+'align"]').val().split(" "),i=u[0],u=u[1],l=e.form.find('[name="'+l+'shape"]').val(),l=BACheetahConfig.presets.shape[l];if(shapeProps={width:"100%",left:"auto",right:"auto",height:"auto",top:"auto",bottom:"auto"},h){shapeProps.width=h+o;var p=h/2+o;switch(u){case"left":shapeProps.left="0",shapeProps.right="auto";break;case"right":shapeProps.left="auto",shapeProps.right="0";break;case"center":shapeProps.left="calc( 50% - "+p+")",shapeProps.right="auto"}}switch(this.updateCSSRule(c,"width",shapeProps.width),this.updateCSSRule(c,"left",shapeProps.left),this.updateCSSRule(c,"right",shapeProps.right),a=s?s/2+o:h?h/l.data.viewBox.width*100/2+o:"",s&&(shapeProps.height=s+o),i){case"top":shapeProps.top="0",shapeProps.bottom="auto";break;case"bottom":shapeProps.top="auto",shapeProps.bottom="0";break;case"center":shapeProps.top="calc( 50% - "+a+")",shapeProps.bottom="auto"}this.updateCSSRule(c,"height",shapeProps.height),this.updateCSSRule(c,"top",shapeProps.top),this.updateCSSRule(c,"bottom",shapeProps.bottom),""===n?this.updateCSSRule(d,r,"0"):this.updateCSSRule(d,r,n+o)},previewShapeAlign:function(e,t){var a=e.preview.prefix;e.form.find('[name="'+a+'size_width"]').trigger("input")},previewShapeFillStyle:function(e,t){var a=e.input.val(),i=e.preview,o=e.preview.prefix,h="ba-cheetah-row-"+e.nodeID+"-"+o+"-linear-gradient",s="ba-cheetah-row-"+e.nodeID+"-"+o+"-radial-gradient",n="ba-cheetah-row-"+e.nodeID+"-"+o+"-pattern",l=e.form;if(void 0!==a){var r=this._getPreviewSelector(this.classes.node,i.selector);switch(a){case"color":var d=l.find("[name="+o+"fill_color]").val();this.updateCSSRule(r,"fill",BACheetahPreview.formatColor(d));break;case"gradient":d=l.find("#ba-cheetah-field-"+o+"fill_gradient").find('select[name$="[type]"]').val();this.updateCSSRule(r,"fill","url(#"+("radial"===d?s:h)+")");break;case"pattern":this.updateCSSRule(r,"fill","url(#"+n+")")}}},previewShapeGradientFill:function(e,t){var a=e.getValues(),i=e.node,o=".ba-cheetah-"+e.preview.position+"-edge-layer",e=i.find(o+" "+a.type+"Gradient"),i="url(#"+e.attr("id")+")",o=this._getPreviewSelector(this.classes.node,o+" .ba-cheetah-shape");this.updateCSSRule(o,"fill",i);var h,s=e.find("stop");for(h in console.log(a.stops,e),a.stops){var n=a.stops[h],l=s.eq(h),r=n.color,d=n.stop,c=1;0===r.indexOf("rgba")&&(c=(n=r.substring(r.indexOf("(")+1,r.lastIndexOf(")")).split(/,\s*/)).pop(),r="rgb("+n.join(",")+")"),console.log(BACheetahPreview.formatColor(r),r),l.attr("stop-color",BACheetahPreview.formatColor(r)),l.attr("stop-opacity",c),l.attr("offset",d+"%")}if("linear"===a.type&&void 0!==e[0]&&e[0].setAttribute("gradientTransform","rotate("+a.angle+" .5 .5 )"),"radial"===a.type){parts=a.position.split(" ");var u,p,o=parts[0],i=parts[1];switch(o){case"top":case"left":u=0;break;case"center":u=.5;break;case"bottom":case"right":u=1}switch(i){case"top":case"left":p=0;break;case"center":p=.5;break;case"bottom":case"right":p=1}(i=.5)===u&&.5===p||(i=1),e.attr("cx",u),e.attr("cy",p),e.attr("r",i)}},previewShapeTransform:function(e,t){e.form;var a=e.preview,a=(a.prefix,this._getPreviewSelector(this.classes.node,a.selector)+" > *"),i=e.getValues(),o=[];Object.keys(i).map(function(e){var t=i[e],a="";switch(e){case"scaleXSign":case"scaleYSign":return;case"scaleX":case"scaleY":t&&""!==t&&0!==t||(t="1"),t="invert"===("scaleX"===e?i.scaleXSign:i.scaleYSign)?-Math.abs(t):Math.abs(t),o.push(e+"("+t+")");break;case"translateX":case"translateY":t&&o.push(e+"("+t+(a="px")+")");break;case"skewX":case"skewY":t&&o.push(e+"("+t+(a="deg")+")");break;case"rotate":a="deg",""!==t&&"0"!==t&&o.push("rotate("+t+a+")")}}),this.updateCSSRule(a,"transform",o.join(" "))}}}(jQuery),function(d){var a={ignored:[],reparsed:[],width:null,callback:null,sheets:{},styles:[],queue:[],emPxValue:null,regex:{media:/@media[^{]*{([\s\S]+?})\s*}/gi,empty:/@media[^{]*{([^{}]*?)}/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)\}$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},ignore:function(e){Array.prototype.push.apply(this.ignored,e)},reparse:function(e){Array.prototype.push.apply(this.reparsed,e)},update:function(e,t){this.width=void 0===e?null:e,this.callback=void 0===t?null:t,i.update(),this.queueSheets()?this.runQueue():this.applyStyles()},queueSheets:function(){for(var e,t,a,i=null,o=null,h=null,s=!1,n=0,l=0;n<document.styleSheets.length;n++)if(element=document.styleSheets[n].ownerNode,i=element.href,e=element.id,t=element.tagName.toLowerCase(),o=element.rel,a=element.media,h=i?i.split("?").shift():e||"style-"+n,s=!1,"style"===t||i&&o&&"stylesheet"===o.toLowerCase()){for(l=0;l<this.ignored.length;l++)if(-1<h.indexOf(this.ignored[l])){s=!0;break}if(!s){for(l=0;l<this.reparsed.length;l++)if(-1<h.indexOf(this.reparsed[l])){this.sheets[h]=null;break}void 0!==this.sheets[h]&&this.sheets[h]||this.queue.push({docSheet:document.styleSheets[n],element:d(element),key:h,tagName:t,href:i,id:e,media:a})}}return this.queue.length},runQueue:function(){var t;this.queue.length?"style"===(t=this.queue.shift()).tagName?(this.parse(t.element.html(),t),this.runQueue()):d.get(t.href,d.proxy(function(e){this.parse(e,t),this.runQueue()},this)).fail(this.runQueue.bind(this)):this.applyStyles()},parse:function(e,t){var a,i=this.regex,o=this.cleanStyles(e),h=o.match(i.media),s=h&&h.length||0,n=!s&&t.media,l=null,e="",r=0,d=0;for(h?e=o.replace(i.media,""):n&&"all"!=t.media?s=1:e=o,this.sheets[t.key]={docSheet:t.docSheet,element:t.element,key:t.key,tagName:t.tagName,href:t.href,id:t.id,all:e,queries:[]},r=0;r<s;r++)for(o=n?(l=t.media,this.convertURLs(o,t.href)):(l=h[r].match(i.findStyles)&&RegExp.$1,RegExp.$2&&this.convertURLs(RegExp.$2,t.href)),a=l.split(","),d=0;d<a.length;d++)"print"!=((l=a[d]).split("(")[0].match(i.only)&&RegExp.$2)&&(l.replace(i.minmaxwh,"").match(i.other)||this.sheets[t.key].queries.push({minw:l.match(i.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:l.match(i.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),styles:o}))},applyStyles:function(){var e=d("head"),t={all:"",queries:[]},a=null,i=null,o=null,h=null,s=null,n=null,l=null,r=!1;for(o in this.clearStyles(),this.sheets)if((i=this.sheets[o]).queries.length&&this.width){for(t.all+=i.all,s=0;s<i.queries.length;s++)n=(h=i.queries[s]).minw,l=h.maxw,r=!1,n&&(n=parseFloat(n)*(-1<n.indexOf("em")?this.getEmPxValue():1),this.width>=n&&(t.queries.push({media:"min",width:n,styles:h.styles}),r=!0)),l&&!r&&(l=parseFloat(l)*(-1<l.indexOf("em")?this.getEmPxValue():1),this.width<=l&&t.queries.push({media:"max",width:l,styles:h.styles}));i.docSheet.disabled=!0}for(""!==t.all&&(a=d('<style class="ba-cheetah-media-query" data-query="all"></style>'),this.styles.push(a),e.append(a),a.html(t.all)),s=0;s<t.queries.length;s++)h=t.queries[s],a=d('<style class="ba-cheetah-media-query" data-query="'+h.media+'" data-value="'+h.width+'"></style>'),this.styles.push(a),e.append(a),a.html(h.styles);this.callback&&(this.callback(),this.callback=null)},clearStyles:function(){var e=null,t=this.styles.slice(0);for(e in this.styles=[],this.sheets)this.sheets[e].docSheet.disabled=!1;for(var a=0;a<t.length;a++)t[a].empty(),t[a].remove()},disableStyles:function(e){for(var t,a,i=0;i<this.styles.length;i++)t=(a=this.styles[i]).attr("data-query"),a=parseInt(a.attr("data-value")),"max"===t&&!isNaN(a)&&a<=e&&(this.styles[i][0].sheet.disabled=!0)},enableStyles:function(){for(var e=0;e<this.styles.length;e++)this.styles[e][0].sheet.disabled=!1,this.styles[e][0].sheet.disabled=!0,this.styles[e][0].sheet.disabled=!1},cleanStyles:function(e){var t=this.regex;return e.replace(t.comments,"").replace(t.keyframes,"").replace(t.empty,"")},convertURLs:function(e,t){return t?((t=t.substring(0,t.lastIndexOf("/"))).length&&(t+="/"),e.replace(this.regex.urls,"$1"+t+"$2$3")):e},getEmPxValue:function(){if(this.emPxValue)return this.emPxValue;var e,t=window.document,a=t.documentElement,i=t.body,o=t.createElement("div"),h=a.style.fontSize,s=i&&i.style.fontSize,n=!1;return o.style.cssText="position:absolute;font-size:1em;width:1em",i||((i=n=t.createElement("body")).style.background="none"),a.style.fontSize="100%",i.style.fontSize="100%",i.appendChild(o),n&&a.insertBefore(i,a.firstChild),e=parseFloat(o.offsetWidth),n?a.removeChild(i):i.removeChild(o),a.style.fontSize=h,i.style.fontSize=s||"",this.emPxValue=e}},i={_functions:null,update:function(){if(!this._functions)for(var e in this._functions={},t)this._functions[e]=jQuery.fn[e];if(a.width)for(e in t)jQuery.fn[e]=t[e];else for(e in this._functions)jQuery.fn[e]=this._functions[e]}},t={width:function(e){return null!=e?i._functions.width.call(this,e):d.isWindow(this[0])?a.width:i._functions.width.call(this)}};BACheetahSimulateMediaQuery={ignore:function(e){a.ignore(e)},reparse:function(e){a.reparse(e)},update:function(e,t){a.update(e,t)},disableStyles:function(e){a.disableStyles(e)},enableStyles:function(){a.enableStyles()}}}(jQuery),function(r){BACheetahResponsiveEditing={_mode:"default",refreshPreview:function(e){var t;r(".ba-cheetah-responsive-preview").length&&"default"!==this._mode?("responsive"==this._mode?(t=320<=BACheetahConfig.global.responsive_breakpoint?320:BACheetahConfig.global.responsive_breakpoint,BACheetahSimulateMediaQuery.update(t,e)):"medium"==this._mode&&(t=769<=BACheetahConfig.global.medium_breakpoint?769:BACheetahConfig.global.medium_breakpoint,BACheetahSimulateMediaQuery.update(t,e)),BACheetah._resizeLayout()):e&&e()},_init:function(){this._bind(),this._initMediaQueries()},_bind:function(){BACheetah.addHook("endEditingSession",this._clearPreview),BACheetah.addHook("didEnterRevisionPreview",this._clearPreview),BACheetah.addHook("responsiveEditing",this._menuToggleClicked),BACheetah.addHook("preview-init",this._switchAllSettingsToCurrentMode),BACheetah.addHook("responsive-editing-switched",this._showSize),r("body").delegate(".ba-cheetah-field-responsive-toggle","click",this._settingToggleClicked),r("body").delegate(".ba-cheetah-responsive-preview-message button","click",this._previewToggleClicked)},_initMediaQueries:function(){BACheetahSimulateMediaQuery.ignore([BACheetahConfig.pluginUrl,BACheetahConfig.relativePluginUrl]),BACheetahSimulateMediaQuery.ignore(BACheetahConfig.responsiveIgnore),BACheetahSimulateMediaQuery.reparse([BACheetahConfig.postId+"-layout-draft.css",BACheetahConfig.postId+"-layout-draft-partial.css",BACheetahConfig.postId+"-layout-preview.css",BACheetahConfig.postId+"-layout-preview-partial.css","ba-cheetah-global-css","ba-cheetah-layout-css"])},_showSize:function(){var e=r(".ba-cheetah-responsive-preview-message .size"),t="1"===BACheetahConfig.global.responsive_preview?BACheetahConfig.global.medium_breakpoint:769,a="1"===BACheetahConfig.global.responsive_preview?BACheetahConfig.global.responsive_breakpoint:360,i="";r(".ba-cheetah-responsive-preview").hasClass("ba-cheetah-preview-responsive")?i=BACheetahStrings.mobile+" "+a+"px":r(".ba-cheetah-responsive-preview").hasClass("ba-cheetah-preview-medium")&&(i=BACheetahStrings.medium+" "+t+"px"),e.html("").html(i)},_switchTo:function(e,t){var a=r("html"),i=r("body"),o=r(BACheetah._contentClass),h=r(".ba-cheetah-responsive-preview"),s=r(".ba-cheetah-responsive-preview-mask"),n=r(".ba-cheetah-content-placeholder"),l=null;if(BACheetahResponsiveEditing._mode=e,BACheetahResponsiveEditing._switchAllSettingsTo(e),"default"==e){if(0===n.length)return;a.removeClass("ba-cheetah-responsive-preview-enabled"),n.after(o),n.remove(),h.remove(),s.remove()}else 0===h.length?(a.addClass("ba-cheetah-responsive-preview-enabled"),o.after('<div class="ba-cheetah-content-placeholder"></div>'),i.prepend(wp.template("ba-cheetah-responsive-preview")()),r(".ba-cheetah-responsive-preview").addClass("ba-cheetah-preview-"+e),r(".ba-cheetah-responsive-preview-content").append(o)):(h.removeClass("ba-cheetah-preview-responsive ba-cheetah-preview-medium"),h.addClass("ba-cheetah-preview-"+e));"responsive"==e?(l="1"!==BACheetahConfig.global.responsive_preview&&360<=BACheetahConfig.global.responsive_breakpoint?360:BACheetahConfig.global.responsive_breakpoint,o.width(l),BACheetahSimulateMediaQuery.update(l,t),BACheetahResponsiveEditing._setMarginPaddingPlaceholders()):"medium"==e?(l="1"!==BACheetahConfig.global.responsive_preview&&769<=BACheetahConfig.global.medium_breakpoint?769:BACheetahConfig.global.medium_breakpoint,o.width(l),BACheetahSimulateMediaQuery.update(l,t),BACheetahResponsiveEditing._setMarginPaddingPlaceholders()):(o.width(""),BACheetahSimulateMediaQuery.update(null,t)),this._setContentBackgroundColor(),BACheetah._resizeLayout(),this._previewFields(),this._activeNavbarMode(e),BACheetah.triggerHook("responsive-editing-switched",e)},_activeNavbarMode:function(e){const t=r(".ba-navbar-actions .ba-navbar-devices"),a=t.find('.ba-cheetah-button:not([data-mode="'+e+'"])');a.removeClass("ba-device-active");const i=t.find('.ba-cheetah-button[data-mode="'+e+'"]');i.addClass("ba-device-active")},_setContentBackgroundColor:function(){var e=r(BACheetah._contentClass),t=r(".ba-cheetah-responsive-preview"),a=r(".ba-cheetah-content-placeholder").parents(),i="#fff",o=0;if(0===t.length)e.css("background-color","");else{for(;o<a.length&&"rgba(0, 0, 0, 0)"==(i=a.eq(o).css("background-color"));o++);e.css("background-color",i)}},_switchToAndScroll:function(e){var t=r(".ba-cheetah-settings").data("node"),a=void 0===t?void 0:r(".ba-cheetah-node-"+t);BACheetahResponsiveEditing._switchTo(e,function(){var e;void 0!==a&&a&&(r(window),(e=r(".ba-cheetah-responsive-preview-content")).length?(e.scrollTop(0),e.scrollTop(a.offset().top-150)):r("html, body").scrollTop(a.offset().top-100))})},_switchAllSettingsTo:function(e){var t="";r(".ba-cheetah-field-responsive-setting").hide(),t="default"==e?"#ba-cheetah-icon--desktop":"medium"==e?"#ba-cheetah-icon--tablet":"#ba-cheetah-icon--smartphone";const a=r(".ba-cheetah-field-responsive-toggle");a.data("mode",e),a.find("svg use").attr("xlink:href",t),r(".ba-cheetah-field-responsive-setting-"+e).css("display","inline-block")},_switchAllSettingsToCurrentMode:function(){var e=BACheetahResponsiveEditing;e._switchAllSettingsTo(e._mode),BACheetah.triggerHook("responsive-editing-switched",e._mode)},_setMarginPaddingPlaceholders:function(){var e="#ba-cheetah-field-padding .ba-cheetah-field-responsive-setting-default",t={values:{top:r(e+' input[ name="padding_top" ]').val(),right:r(e+' input[ name="padding_right" ]').val(),bottom:r(e+' input[ name="padding_bottom" ]').val(),left:r(e+' input[ name="padding_left" ]').val()},placeholders:{top:r(e+' input[ name="padding_top" ]').attr("placeholder"),right:r(e+' input[ name="padding_right" ]').attr("placeholder"),bottom:r(e+' input[ name="padding_bottom" ]').attr("placeholder"),left:r(e+' input[ name="padding_left" ]').attr("placeholder")}},a="#ba-cheetah-field-padding .ba-cheetah-field-responsive-setting-medium",i={values:{top:r(a+' input[ name="padding_top_medium" ]').val(),right:r(a+' input[ name="padding_right_medium" ]').val(),bottom:r(a+' input[ name="padding_bottom_medium" ]').val(),left:r(a+' input[ name="padding_left_medium" ]').val()},placeholders:{top:"",right:"",bottom:"",left:""}},o="#ba-cheetah-field-padding .ba-cheetah-field-responsive-setting-responsive",h=(r(a+' input[ name="padding_top_responsive" ]').val(),r(a+' input[ name="padding_right_responsive" ]').val(),r(a+' input[ name="padding_bottom_responsive" ]').val(),r(a+' input[ name="padding_left_responsive" ]').val(),"#ba-cheetah-field-margin .ba-cheetah-field-responsive-setting-default"),s={values:{top:r(h+' input[ name="margin_top" ]').val(),right:r(h+' input[ name="margin_right" ]').val(),bottom:r(h+' input[ name="margin_bottom" ]').val(),left:r(h+' input[ name="margin_left" ]').val()},placeholders:{top:r(h+' input[ name="margin_top" ]').attr("placeholder"),right:r(h+' input[ name="margin_right" ]').attr("placeholder"),bottom:r(h+' input[ name="margin_bottom" ]').attr("placeholder"),left:r(h+' input[ name="margin_left" ]').attr("placeholder")}},n="#ba-cheetah-field-margin .ba-cheetah-field-responsive-setting-medium",e={values:{top:r(n+' input[ name="margin_top_medium" ]').val(),right:r(n+' input[ name="margin_right_medium" ]').val(),bottom:r(n+' input[ name="margin_bottom_medium" ]').val(),left:r(n+' input[ name="margin_left_medium" ]').val()},placeholders:{top:s.values.top||s.placeholders.top,right:s.values.right||s.placeholders.right,bottom:s.values.bottom||s.placeholders.bottom,left:s.values.left||s.placeholders.left}},h="#ba-cheetah-field-margin .ba-cheetah-field-responsive-setting-responsive";r(h+' input[ name="margin_top_responsive" ]').val(),r(h+' input[ name="margin_right_responsive" ]').val(),r(h+' input[ name="margin_bottom_responsive" ]').val(),r(h+' input[ name="margin_left_responsive" ]').val();""!=t.values.top?r(a+' input[ name="padding_top_medium"] ').attr("placeholder",t.values.top):r(a+' input[ name="padding_top_medium"] ').attr("placeholder",t.placeholders.top),""!=t.values.right?r(a+' input[ name="padding_right_medium"] ').attr("placeholder",t.values.right):r(a+' input[ name="padding_right_medium"] ').attr("placeholder",t.placeholders.right),""!=t.values.bottom?r(a+' input[ name="padding_bottom_medium"] ').attr("placeholder",t.values.bottom):r(a+' input[ name="padding_bottom_medium"] ').attr("placeholder",t.placeholders.bottom),""!=t.values.left?r(a+' input[ name="padding_left_medium"] ').attr("placeholder",t.values.left):r(a+' input[ name="padding_left_medium"] ').attr("placeholder",t.placeholders.left),""!=i.values.top?r(o+' input[ name="padding_top_responsive"] ').attr("placeholder",i.values.top):""!=t.values.top?r(o+' input[ name="padding_top_responsive"] ').attr("placeholder",t.values.top):r(o+' input[ name="padding_top_responsive"] ').attr("placeholder",t.placeholders.top),""!=i.values.right?r(o+' input[ name="padding_right_responsive"] ').attr("placeholder",i.values.right):""!=t.values.right?r(o+' input[ name="padding_right_responsive"] ').attr("placeholder",t.values.right):r(o+' input[ name="padding_right_responsive"] ').attr("placeholder",t.placeholders.right),""!=i.values.bottom?r(o+' input[ name="padding_bottom_responsive"] ').attr("placeholder",i.values.bottom):""!=t.values.bottom?r(o+' input[ name="padding_bottom_responsive"] ').attr("placeholder",t.values.bottom):r(o+' input[ name="padding_bottom_responsive"] ').attr("placeholder",t.placeholders.bottom),""!=i.values.left?r(o+' input[ name="padding_left_responsive"] ').attr("placeholder",i.values.left):""!=t.values.left?r(o+' input[ name="padding_left_responsive"] ').attr("placeholder",t.values.left):r(o+' input[ name="padding_left_responsive"] ').attr("placeholder",t.placeholders.left),""!=s.values.top?r(n+' input[ name="margin_top_medium" ]').attr("placeholder",s.values.top):r(n+' input[ name="margin_top_medium" ]').attr("placeholder",s.placeholders.top),""!=s.values.right?r(n+' input[ name="margin_right_medium" ]').attr("placeholder",s.values.right):r(n+' input[ name="margin_right_medium" ]').attr("placeholder",s.placeholders.right),""!=s.values.bottom?r(n+' input[ name="margin_bottom_medium" ]').attr("placeholder",s.values.bottom):r(n+' input[ name="margin_bottom_medium" ]').attr("placeholder",s.placeholders.bottom),""!=s.values.left?r(n+' input[ name="margin_left_medium" ]').attr("placeholder",s.values.left):r(n+' input[ name="margin_left_medium" ]').attr("placeholder",s.placeholders.left),""!=e.values.top?r(h+' input[ name="margin_top_responsive" ]').attr("placeholder",e.values.top):""!=s.values.top?r(h+' input[ name="margin_top_responsive" ]').attr("placeholder",s.values.top):r(h+' input[ name="margin_top_responsive" ]').attr("placeholder",s.placeholders.top),""!=e.values.right?r(h+' input[ name="margin_right_responsive" ]').attr("placeholder",e.values.right):""!=s.values.right?r(h+' input[ name="margin_right_responsive" ]').attr("placeholder",s.values.right):r(h+' input[ name="margin_right_responsive" ]').attr("placeholder",s.placeholders.right),""!=e.values.bottom?r(h+' input[ name="margin_bottom_responsive" ]').attr("placeholder",e.values.bottom):""!=s.values.bottom?r(h+' input[ name="margin_bottom_responsive" ]').attr("placeholder",s.values.bottom):r(h+' input[ name="margin_bottom_responsive" ]').attr("placeholder",s.placeholders.bottom),""!=e.values.left?r(h+' input[ name="margin_left_responsive" ]').attr("placeholder",e.values.left):""!=s.values.left?r(h+' input[ name="margin_left_responsive" ]').attr("placeholder",s.values.left):r(h+' input[ name="margin_left_responsive" ]').attr("placeholder",s.placeholders.left)},_settingToggleClicked:function(){var e=r(this),t="default"==(t=e.data("mode"))?"medium":"medium"==t?"responsive":"default";BACheetahResponsiveEditing._switchAllSettingsTo(t),BACheetahResponsiveEditing._switchToAndScroll(t),e.siblings(".ba-cheetah-field-responsive-setting:visible").find("input").focus()},_menuToggleClicked:function(){var e="default"==(e=BACheetahResponsiveEditing._mode)?"medium":"medium"==e?"responsive":"default";BACheetah.MainMenu.hide(),BACheetahResponsiveEditing._switchAllSettingsTo(e),BACheetahResponsiveEditing._switchToAndScroll(e)},_previewToggleClicked:function(){var e=r(this).data("mode");console.log("aqui fioo"),BACheetahResponsiveEditing._switchAllSettingsTo(e),BACheetahResponsiveEditing._switchToAndScroll(e)},_clearPreview:function(){BACheetahResponsiveEditing._switchToAndScroll("default")},_previewFields:function(){var o=BACheetahResponsiveEditing._mode,e=r(".ba-cheetah-settings:visible");0!==e.length&&void 0!==e.attr("data-node")&&(BACheetah.triggerHook("responsive-editing-before-preview-fields",o),e.find(".ba-cheetah-settings-tab").each(function(){var e=r(this);e.css("display","block"),e.find(".ba-cheetah-field-responsive-setting-"+o+":visible").each(function(){var e=r(this),t=e.closest(".ba-cheetah-field"),a=t.data("type"),i=t.data("preview"),t=t.find(".ba-cheetah-field-connection-visible").length;"refresh"!=i.type&&(t?"photo"===a&&"default"!==o&&e.find(".ba-cheetah-photo-remove").trigger("click"):(e.find("input").trigger("keyup"),e.find("select").trigger("change")))}),e.css("display","")}),BACheetah.triggerHook("responsive-editing-after-preview-fields",o))}},r(function(){BACheetahResponsiveEditing._init()})}(jQuery),function(s){BACheetahResponsivePreview={enter:function(e){this.render(),e&&(this.switchTo(e),this.activatePreviewMenuBarDeviceIcon(e),this._showSize(e))},exit:function(){this.destroy()},activatePreviewMenuBarDeviceIcon:function(e){const t=s(".ba-cheetah--preview-actions .ba-preview-devices"),a=t.find('.ba-cheetah-button:not([data-mode="'+e+'"])');a.removeClass("ba-device-active");const i=t.find('.ba-cheetah-button[data-mode="'+e+'"]');i.addClass("ba-device-active")},switchTo:function(e){var t=BACheetahConfig.global,a=s("#ba-cheetah-preview-frame"),i="100%";"responsive"==e?(i="1"!==t.responsive_preview&&360<=t.responsive_breakpoint?360:t.responsive_breakpoint,a.width(i)):"medium"==e&&(i="1"!==t.responsive_preview&&769<=t.medium_breakpoint?769:t.medium_breakpoint,a.width(i)),a.width(i)},render:function(e){var t=s("body"),a=BACheetahConfig.previewUrl,i=s("#ba-cheetah-preview-mask, #ba-cheetah-preview-frame"),o=s('<div id="ba-cheetah-preview-mask"></div>'),h=s('<span class="ba-cheetah-preview-size"></span>');frame=s('<iframe id="ba-cheetah-preview-frame" src="'+a+'"></iframe>'),wrap=s('<div class="ba-preview-container">"'),i.remove(),wrap.append(h),wrap.append(frame),t.css("overflow","hidden"),t.append(o),t.append(wrap)},_showSize:function(e){var t=s(".ba-cheetah-preview-size"),a="1"===BACheetahConfig.global.responsive_preview?BACheetahConfig.global.medium_breakpoint:769,i="1"===BACheetahConfig.global.responsive_preview?BACheetahConfig.global.responsive_breakpoint:360,o="";"responsive"===e?o=BACheetahStrings.mobile+" "+i+"px":"medium"===e&&(o=BACheetahStrings.medium+" "+a+"px"),t.html("").html(o)},destroy:function(){s(".ba-preview-container, #ba-cheetah-preview-mask").remove(),s("body").css("overflow","visible")}}}(jQuery),function(t){BACheetahTour={_tour:null,start:function(){BACheetahTour._tour?BACheetahTour._tour.restart():(BACheetahTour._tour=new Tour(BACheetahTour._config()),BACheetahTour._tour.init()),BACheetah._triggerSettingsSave(!1,!0)&&(["ba-cheetah-header","ba-cheetah-footer","ba-cheetah-popup"].includes(BACheetahConfig.userTemplateType)?BACheetahTour._tour.start():(BACheetah.triggerHook("openMainMenu"),setTimeout(()=>{BACheetahTour._tour.start()},450)))},_config:function(){var e={storage:!1,backdrop:!0,autoscroll:!1,onStart:BACheetahTour._onStart,onPrev:BACheetahTour._onPrev,onNext:BACheetahTour._onNext,onEnd:BACheetahTour._onEnd,template:function(e,t){return`<div class="popover" role="tooltip"> 
						<span class="tour-steps-count">${e+1+"/"+a}</span> 
						<i class="fas fa-times" data-role="end"></i> 
						<div class="arrow"></div>
						<div class="popover-content"></div> 
						<div class="popover-navigation clearfix"> 
						<button class="ba-cheetah-button ba-cheetah-button-primary ba-cheetah-tour-next" data-role="next">${BACheetahStrings.tourNext}</button> 
						</div> 
					</div>`},steps:[{element:".ba-cheetah--menu .ba-cheetah-mode-toggle",placement:"right",content:BACheetahStrings.tourMode},{element:'.ba-cheetah--menu-item[data-event="showPageSettings"]',placement:"right",content:BACheetahStrings.tourPageSettings,onHidden:function(){BACheetah.triggerHook("closeMainMenu")}},{element:".ba-cheetah--content-library-panel",placement:"left",content:BACheetahStrings.tourTemplates,onShow:function(){BACheetah.ContentPanel.show("templates")}},{element:".ba-cheetah--content-library-panel #ba-cheetah-blocks-rows",placement:"left",content:BACheetahStrings.tourAddRows,onShow:function(){BACheetah.ContentPanel.show("rows")}},{element:'.ba-cheetah--content-library-panel .ba-cheetah--panel-view[data-tab="modules"]',placement:"left",content:BACheetahStrings.tourAddContent,onShow:function(){BACheetah.ContentPanel.show("modules")}},{element:".ba-cheetah-button-group.ba-navbar-devices",placement:"bottom",content:BACheetahStrings.tourMobileEditing},{element:".ba-cheetah-done-button",placement:"bottom",content:BACheetahStrings.tourDoneButton,onShow:function(){BACheetahTour._dimSection("body")}},{orphan:!0,backdrop:!0,content:BACheetahStrings.tourFinished,template:'<div class="popover" role="tooltip"> <div class="arrow"></div> <i class="fas fa-times" data-role="end"></i> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation clearfix"> <button class="ba-cheetah-button ba-cheetah-button-primary ba-cheetah-tour-next" data-role="end">'+BACheetahStrings.tourEnd+"</button> </div> </div>"}]};const a=e.steps.length-1;return e},_onStart:function(){var e=t("body");e.scrollTop(0),e.append('<div class="ba-cheetah-tour-mask"></div>')},_onPrev:function(){t(".ba-cheetah-tour-dimmed").remove()},_onNext:function(){t(".ba-cheetah-tour-dimmed").remove()},_onEnd:function(){t("body").off("ba-cheetah.template-selector-loaded"),t(".ba-cheetah-tour-mask").remove(),t(".ba-cheetah-tour-dimmed").remove(),t(".ba-cheetah-tour-placeholder-content").remove(),t(".ba-cheetah-tour-demo-content").removeClass("ba-cheetah-tour-demo-content"),BACheetah._setupEmptyLayout(),BACheetah._highlightEmptyCols(),BACheetah._showPanel(),BACheetah._initTemplateSelector()},_dimSection:function(e){t(e).find(".ba-cheetah-tour-dimmed").remove(),t(e).append('<div class="ba-cheetah-tour-dimmed"></div>')}}}(jQuery),function(n,o){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t=t||0,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var a=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>a.length)&&(t=a.length),t-=e.length;e=a.indexOf(e,t);return-1!==e&&e===t}),n.fn.textWidth=function(e,t){return n.fn.textWidth.fakeEl||(n.fn.textWidth.fakeEl=n("<span>").hide().appendTo(document.body)),n.fn.textWidth.fakeEl.text(e||this.val()||this.text()).css("font",t||this.css("font")),n.fn.textWidth.fakeEl.width()},BACheetahExtendableObject={create:function(e){var t=Object.create(this),t=n.extend(t,e);return n(this).trigger("onCreate"),t}},n.fn.switchClass=function(o,e){return this.each(function(){return n(this).removeClass(function(e,t){var a=[],i=t.split(" ");for(e in i)i[e].startsWith(o)&&a.push(i[e]);return a.join(" ")}),n(this).addClass(o+e)})};var e={init:function(){o.addHook("cancelTask",this.onCancelTask.bind(this)),o.addHook("showSavedMessage",this.onSaveShortcut.bind(this)),o.addHook("goToNextTab",this.onNextPrevTabShortcut.bind(this,"next")),o.addHook("goToPrevTab",this.onNextPrevTabShortcut.bind(this,"prev")),o.addHook("endEditingSession",this.onEndEditingSession.bind(this)),o.addHook("restartEditingSession",this.onRestartEditingSession.bind(this)),this.setDefaultKeyboardShortcuts()},addShortcut:function(e,t,a){e=n.proxy(this,"onTriggerKey",e);a?Mousetrap.bindGlobal(t,e):Mousetrap.bind(t,e)},reset:function(){Mousetrap.reset()},setDefaultKeyboardShortcuts:function(){for(var e in this.reset(),BACheetahConfig.keyboardShortcuts){var t=BACheetahConfig.keyboardShortcuts[e].keyCode,a=BACheetahConfig.keyboardShortcuts[e].isGlobal;this.addShortcut(e,t,a)}},onTriggerKey:function(e,t){console.log("onTriggerKey",e),o.triggerHook(e),t.preventDefault?t.preventDefault():t.returnValue=!1},onCancelTask:function(){a.isPreviewing?a.endPreview():t.isShowing?t.hide():o.ContentPanel.isShowing&&o.ContentPanel.hide()},pause:function(){Mousetrap.pause()},unpause:function(){Mousetrap.unpause()},onEndEditingSession:function(){if("Builder"in BA&&"data"in BA.Builder){const e=BA.Builder.data.getSystemActions();e.setIsEditing(!1)}document.documentElement.classList.remove("ba-cheetah-assistant-visible"),this.reset(),this.addShortcut("restartEditingSession","mod+e")},onRestartEditingSession:function(){if("Builder"in BA&&"data"in BA.Builder){const e=BA.Builder.data.getSystemActions();e.setIsEditing(!0)}"assistant"===BA.Builder.data.getSystemState().currentPanel&&document.documentElement.classList.add("ba-cheetah-assistant-visible"),this.reset(),this.setDefaultKeyboardShortcuts()},onSaveShortcut:function(){var e;e=o.SaveManager.layoutNeedsPublish()?BACheetahStrings.savedStatus.hasAlreadySaved:BACheetahStrings.savedStatus.nothingToSave,o.SaveManager.showStatusMessage(e),setTimeout(function(){o.SaveManager.resetStatusMessage()},2e3)},onNextPrevTabShortcut:function(e,t){var a=n(".bal-cheetah-lightbox:visible"),i=a.find(".ba-cheetah-settings-tabs a");0<a.length&&(a=i.filter("a.ba-cheetah-active"),("next"==e?a.is(i.last())?i.first():a.next("a"):a.is(i.first())?i.last():a.prev("a")).trigger("click")),o._calculateSettingsTabsOverflow(),t.preventDefault()}},t=BACheetahExtendableObject.create({isShowing:!1,init:function(){this.$el=n(".ba-cheetah-publish-actions"),this.$defaultBarButtons=n(".ba-cheetah-bar-actions"),this.$clickAwayMask=n(".ba-cheetah-publish-actions-click-away-mask"),this.$doneBtn=this.$defaultBarButtons.find(".ba-cheetah-done-button"),this.$doneBtn.on("click",this.onDoneTriggered.bind(this)),this.$actions=this.$el.find(".ba-cheetah-button"),this.$actions.on("click touchend",this.onActionClicked.bind(this)),o.addHook("triggerDone",this.onDoneTriggered.bind(this));var e=this.hide.bind(this);o.addHook("cancelPublishActions",e),o.addHook("endEditingSession",e),this.$clickAwayMask.on("click",e);const t=n(".ba-navbar-actions"),a=t.find(".ba-cheetah-button");a.on("click touchend",this.onCheetahActionClicked.bind(this))},onDoneTriggered:function(){o.SaveManager.layoutNeedsPublish()?this.show():BACheetahConfig.shouldRefreshOnPublish?o._exit():o._exitWithoutRefresh()},show:function(){this.isShowing||o._triggerSettingsSave(!1,!0)&&(this.$el.removeClass("is-hidden"),this.$defaultBarButtons.css("opacity","0"),this.$clickAwayMask.show(),this.isShowing=!0,o.triggerHook("didShowPublishActions"))},hide:function(){this.isShowing&&(this.$el.addClass("is-hidden"),this.$defaultBarButtons.css("opacity","1"),this.$clickAwayMask.hide(),this.isShowing=!1)},onCheetahActionClicked:function(e){switch(n(e.currentTarget).data("action")){case"change-device":var t=n(e.currentTarget).data("mode")||"default";BACheetahResponsiveEditing._switchTo(t);break;case"undo":o.triggerHook("undo");break;case"preview":o.triggerHook("previewLayout");break;case"redo":o.triggerHook("redo")}},onActionClicked:function(e){e=n(e.currentTarget).data("action");switch(e){case"dismiss":this.hide();break;case"discard":this.hide(),a.muteToolbar(),o._discardButtonClicked();break;case"publish":this.hide(),a.muteToolbar(),o._publishButtonClicked(),o._destroyOverlayEvents();break;default:this.hide(),a.muteToolbar(),o._draftButtonClicked()}o.triggerHook(e+"ButtonClicked")}}),a={isPreviewing:!1,init:function(){this.$el=n("body"),this.$mainToolbar=n(".ba-cheetah-bar"),this.$mainToolbarContent=this.$mainToolbar.find(".ba-cheetah-bar-content"),this.$wpAdminBar=n("#wpadminbar"),this.$endPreviewBtn=n(".ba-cheetah--preview-actions .end-preview-btn"),this.$publishPreviewBtn=n(".ba-cheetah--preview-actions .publish-preview-btn"),o.addHook("endEditingSession",this.endEditingSession.bind(this)),o.addHook("previewLayout",this.togglePreview.bind(this)),this.$endPreviewBtn.on("click",this.endPreview.bind(this)),this.$publishPreviewBtn.on("click",this.publishOnPreview.bind(this)),this.$deviceIcons=n(".ba-cheetah--preview-actions .ba-preview-devices .ba-cheetah-button"),this.$deviceIcons.on("click",this.onDeviceIconClick.bind(this)),this.$wpAdminBar.find("#wp-admin-bar-ba-cheetah-frontend-edit-link > a, #wp-admin-bar-ba-cheetah-theme-builder-frontend-edit-link > a").on("click",this.onClickPageBuilderToolbarLink.bind(this)),n("#wpadminbar a").attr("tabindex","-1");var e=this.restartEditingSession.bind(this);o.addHook("restartEditingSession",e),o.addHook("didHideAllLightboxes",this.unmuteToolbar.bind(this)),o.addHook("didCancelDiscard",this.unmuteToolbar.bind(this)),o.addHook("didEnterRevisionPreview",this.hide.bind(this)),o.addHook("didExitRevisionPreview",this.show.bind(this)),o.addHook("didPublishLayout",this.onPublish.bind(this))},endEditingSession:function(){o._destroyOverlayEvents(),o._removeAllOverlays(),o._removeEmptyRowAndColHighlights(),o._removeColHighlightGuides(),o._unbindEvents(),n("html").removeClass("ba-cheetah-edit").addClass("ba-cheetah-show-admin-bar"),n("body").removeClass("ba-cheetah-edit"),n("#wpadminbar a").attr("tabindex",null),n(o._contentClass).removeClass("ba-cheetah-content-editing"),this.hideMainToolbar(),o.ContentPanel.hide(),BACheetahLayout.init()},restartEditingSession:function(e){o._initTemplateSelector(),o._bindOverlayEvents(),o._highlightEmptyCols(),o._rebindEvents(),n("html").addClass("ba-cheetah-edit").removeClass("ba-cheetah-show-admin-bar"),n("body").addClass("ba-cheetah-edit"),n("#wpadminbar a").attr("tabindex","-1"),n(o._contentClass).addClass("ba-cheetah-content-editing"),this.showMainToolbar(),e.preventDefault()},onClickPageBuilderToolbarLink:function(e){o.triggerHook("restartEditingSession"),e.preventDefault()},onPublish:function(){this.$wpAdminBar.find("#wp-admin-bar-ba-cheetah-frontend-edit-link > a span").css("color","#6bc373")},hide:function(){n("html").hasClass("ba-cheetah-edit")&&(o._unbindEvents(),o._destroyOverlayEvents(),o._removeAllOverlays(),n("html").removeClass("ba-cheetah-edit"),n("body").removeClass("admin-bar"),this.hideMainToolbar(),o.ContentPanel.hide(),BACheetahLayout.init(),o.triggerHook("didHideEditingUI"))},show:function(){n("html").hasClass("ba-cheetah-edit")||(o._rebindEvents(),o._bindOverlayEvents(),this.showMainToolbar(),BACheetahResponsiveEditing._switchTo("default"),n("html").addClass("ba-cheetah-edit"),n("body").addClass("admin-bar"),o.triggerHook("didShowEditingUI"))},beginPreview:function(){var e;o._triggerSettingsSave(!1,!0)&&(this.isPreviewing=!0,this.hide(),n("html").addClass("ba-cheetah-preview"),n("html, body").removeClass("ba-cheetah-edit"),o._removeEmptyRowAndColHighlights(),o._removeColHighlightGuides(),o.triggerHook("didBeginPreview"),e=n(".ba-navbar-devices .ba-device-active").data("mode"),BACheetahResponsivePreview.enter(e))},endPreview:function(){this.isPreviewing=!1,this.show(),o._highlightEmptyCols(),BACheetahResponsivePreview.exit(),n("html").removeClass("ba-cheetah-preview"),n("html, body").addClass("ba-cheetah-edit")},publishOnPreview:function(){this.endPreview(),t.onDoneTriggered()},togglePreview:function(){this.isPreviewing?this.endPreview():this.beginPreview()},hideMainToolbar:function(){this.$mainToolbar.addClass("is-hidden"),n("html").removeClass("ba-cheetah-is-showing-toolbar")},showMainToolbar:function(){this.unmuteToolbar(),this.$mainToolbar.removeClass("is-hidden"),n("html").addClass("ba-cheetah-is-showing-toolbar")},onDeviceIconClick:function(e){e=n(e.target).data("mode");BACheetahResponsivePreview.switchTo(e),BACheetahResponsivePreview._showSize(e),BACheetahResponsivePreview.activatePreviewMenuBarDeviceIcon(e)},muteToolbar:function(){this.$mainToolbarContent.addClass("is-muted"),o._hideTipTips()},unmuteToolbar:function(){this.$mainToolbarContent.removeClass("is-muted")}},i={isEditing:!0,init:function(){history.pushState&&(o.addHook("endEditingSession",this.onLeaveBuilder.bind(this)),o.addHook("restartEditingSession",this.onEnterBuilder.bind(this)))},onEnterBuilder:function(){history.replaceState({},document.title,BACheetahConfig.editUrl),this.isEditing=!0},onLeaveBuilder:function(){history.replaceState({},document.title,BACheetahConfig.url),this.isEditing=!1}},h={$row:null,$rowContent:null,row:null,drag:{},init:function(){var e;this.userCanResize()&&((e=n(o._contentClass)).delegate(".ba-cheetah-row","mouseenter touchstart",this.onDragHandleHover.bind(this)),e.delegate(".ba-cheetah-block-row-resize","mousedown touchstart",this.onDragHandleDown.bind(this)))},userCanResize:function(){return BACheetahConfig.rowResize.userCanResizeRows},onDragHandleHover:function(e){var t,a,i,o,h,s;this.drag.isDragging||(t=this,a=n(e.target).closest(".ba-cheetah-row"),i=a.data("node"),o=n(".ba-cheetah-row-settings[data-node="+i+"]"),h=o.find("[name=max_content_width_unit]"),s="px",t.onSettingsReady(i,function(e){h.length?s=h.length:void 0!==e&&(s=e.max_content_width_unit),t.$row=a,t.$rowContent=t.$row.find(".ba-cheetah-row-content"),t.row={node:i,form:o,unit:s,isFixedWidth:t.$row.hasClass("ba-cheetah-row-fixed-width"),parentWidth:("vw"===s?n(window):t.$row.parent()).width()},t.drag={edge:null,isDragging:!1,originalPosition:null,originalWidth:null,calculatedWidth:null,operation:null},t.row.isFixedWidth?t.drag.originalWidth=t.$row.width():t.drag.originalWidth=t.$rowContent.width(),t.dragInit()}))},onSettingsReady:function(e,t){var a=void 0!==BACheetahSettingsConfig.nodes?BACheetahSettingsConfig.nodes:null;null!==a&&void 0!==a[e]?(t(a[e]),null!=h._mouseEnterTimeout&&(clearTimeout(h._mouseEnterTimeout),h._mouseEnterTimeout=null)):(clearTimeout(h._mouseEnterTimeout),h._mouseEnterTimeout=setTimeout(this.onSettingsReady.bind(this),350,e,t))},onDragHandleDown:function(){n("body").addClass("ba-cheetah-row-resizing"),null!=h._mouseEnterTimeout&&(clearTimeout(h._mouseEnterTimeout),h._mouseEnterTimeout=null)},dragInit:function(e){this.$row.find(".ba-cheetah-block-row-resize").draggable({axis:"x",start:this.dragStart.bind(this),drag:this.dragging.bind(this),stop:this.dragStop.bind(this)})},dragStart:function(e,t){var a=n("body"),t=n(t.helper);this.drag.isDragging=!0,this.row.isFixedWidth?this.drag.originalWidth=this.$row.width():this.drag.originalWidth=this.$rowContent.width(),t.hasClass("ba-cheetah-block-col-resize-e")&&(this.drag.edge="e",this.$feedback=t.find(".ba-cheetah-block-col-resize-feedback-left")),t.hasClass("ba-cheetah-block-col-resize-w")&&(this.drag.edge="w",this.$feedback=t.find(".ba-cheetah-block-col-resize-feedback-right")),a.addClass("ba-cheetah-row-resizing"),o._colResizing=!0,o._destroyOverlayEvents(),o._closePanel()},dragging:function(e,t){var a,i=t.position.left,o=t.originalPosition.left,h=this.drag.originalWidth,s=this.drag.edge,n=BACheetahConfig.rowResize.minAllowedWidth,t=BACheetahConfig.rowResize.maxAllowedWidth;o!==i&&(BACheetahConfig.isRtl&&(s="w"==s?"e":"w"),this.drag.operation=i<o?"w"===s?"+":"-":"e"===s?"+":"-",a=Math.abs(o-i),"+"===this.drag.operation?this.drag.calculatedWidth=h+2*a:this.drag.calculatedWidth=h-2*a,!1!==n&&this.drag.calculatedWidth<n&&(this.drag.calculatedWidth=n),!1!==t&&this.drag.calculatedWidth>t&&(this.drag.calculatedWidth=t),this.row.isFixedWidth&&this.$row.css("max-width",this.drag.calculatedWidth+"px"),this.$rowContent.css("max-width",this.drag.calculatedWidth+"px"),"px"!==this.row.unit&&(this.drag.calculatedWidth=Math.round(this.drag.calculatedWidth/this.row.parentWidth*100)),_.isUndefined(this.$feedback)||this.$feedback.html(this.drag.calculatedWidth+this.row.unit).show(),this.row.form.length&&this.row.form.find("[name=max_content_width]").val(this.drag.calculatedWidth))},dragStop:function(e,t){this.drag.isDragging=!1,_.isUndefined(this.$feedback)||this.$feedback.hide();var a={action:"resize_row_content",node:this.row.node,width:this.drag.calculatedWidth},i=n("body");o.ajax(a),o._bindOverlayEvents(),i.removeClass("ba-cheetah-row-resizing"),n(".ba-cheetah-block-overlay").each(function(){o._buildOverlayOverflowMenu(n(this))}),setTimeout(function(){o._colResizing=!1},50),o.triggerHook("didResizeRow",{rowId:this.row.node,rowWidth:this.drag.calculatedWidth})}},s={templateName:"ba-cheetah-toolbar",init:function(){this.template=wp.template(this.templateName),this.render(),this.initTipTips(),this.$el.find(".ba-cheetah-content-panel-button").on("click",o._togglePanel)},render:function(e){e=n(this.template(e));this.$el=e,this.el=e.get(0),a.$mainToolbar=this.$el,n("body").prepend(e),n("html").addClass("ba-cheetah-is-showing-toolbar")},initTipTips:function(){n(".ba-cheetah--saving-indicator").tipTip({defaultPosition:"bottom",edgeOffset:14}),n(".ba-navbar-devices .ba-cheetah-button, .ba-navbar-history .ba-cheetah-button").tipTip({defaultPosition:"bottom",edgeOffset:6}),n(".ba-cheetah-mode-toggle .ba-cheetah-mode-toggle-label img").tipTip({defaultPosition:"right",edgeOffset:6}),n(".ba-cheetah--main-menu-panel-view-title a").tipTip({defaultPosition:"right",edgeOffset:6})},onNotificationsButtonClicked:function(){o.triggerHook("toggleNotifications")},onNotificationsLoaded:function(){n("body").removeClass("ba-cheetah-has-new-notifications");o.ajax({action:"ba_cheetah_notifications",read:!0})}};n(function(){o.ContentPanel.init(),BACheetahConfig.simpleUi||o.MainMenu.init(),BACheetahConfig.showToolbar?(s.init(),o.ContentPanel.alignPanelArrow()):n("html").addClass("ba-cheetah-no-toolbar"),e.init(),a.init(),i.init(),h.init(),t.init(),o.triggerHook("didInitUI")})}(jQuery,BACheetah),function(o,i){var h=BACheetahExtendableObject.create({templateName:"ba-cheetah-main-menu-panel-view",name:"Untitled View",isShowing:!1,isRootView:!1,items:{},init:function(){this.template=wp.template(this.templateName)},render:function(){return this.template(this)},bindEvents:function(){this.$items=this.$el.find(".ba-cheetah--menu-item")},show:function(){this.$el.addClass("is-showing"),this.isShowing=!0},hide:function(){this.$el.removeClass("is-showing"),this.isShowing=!1},transitionIn:function(e){requestAnimationFrame(this.show.bind(this))},transitionOut:function(e){this.hide()}}),t=BACheetahExtendableObject.create({templateName:"ba-cheetah-main-menu-panel",template:null,menu:null,views:{},viewNavigationStack:[],isShowing:!1,shouldShowTabs:!1,init:function(){for(var e in this.template=wp.template(this.templateName),o("body").prepend(this.template(this)),this.$el=o(".ba-cheetah--main-menu-panel"),this.$el.find(".ba-cheetah--main-menu-panel-views").html(""),BACheetahConfig.mainMenu)this.renderPanel(e);o("body").on("click",".ba-cheetah--main-menu-panel .pop-view",this.goToPreviousView.bind(this)),this.$tabs=this.$el.find(".ba-cheetah--tabs > span"),this.$tabs.on("click",this.onItemClick.bind(this)),o("body").on("click",".ba-cheetah-bar-title-icon",this.toggle.bind(this));var t=this.hide.bind(this),a=this.show.bind(this);i.addHook("didShowPublishActions",t),i.addHook("didBeginSearch",t),i.addHook("didBeginPreview",t),i.addHook("didShowContentPanel",t),i.addHook("endEditingSession",t),i.addHook("didFocusSearchBox",t),i.addHook("didEnterRevisionPreview",t),i.addHook("didFailSettingsSave",t),i.addHook("showKeyboardShortcuts",t),i.addHook("openMainMenu",a),i.addHook("closeMainMenu",t),this.$mask=o(".ba-cheetah--main-menu-panel-mask"),this.$mask.on("click",t),s.init(),n.init()},renderPanel:function(e){var t,a=this.views[e],i=BACheetahConfig.mainMenu[e];i.handle=e,(t=h.create(i)).init(),i=o(t.render()),t.$el=i,o(".ba-cheetah--main-menu-panel-views").append(i),t.bindEvents(),t.$el.find(".ba-cheetah--menu-item").on("click",this.onItemClick.bind(this)),void 0!==a&&(a.$el.remove(),a.isShowing&&(this.currentView=t).show()),t.isRootView&&(this.rootView=t,this.currentView=t),this.views[e]=t},show:function(){this.isShowing||(this.$el.addClass("is-showing"),o(".ba-cheetah-bar-title-icon").addClass("is-showing-menu"),this.currentView.transitionIn(),this.isShowing=!0,this.$mask.show(),i.triggerHook("didOpenMainMenu"))},hide:function(){this.isShowing&&(this.$el.removeClass("is-showing"),o(".ba-cheetah-bar-title-icon").removeClass("is-showing-menu"),this.isShowing=!1,this.resetViews(),this.$mask.hide())},toggle:function(){this.isShowing?this.hide():this.show()},onItemClick:function(e){var t=o(e.currentTarget);switch(t.data("type")){case"view":var a=t.data("view");this.goToView(a);break;case"event":a=t.data("event");i.triggerHook(a,t)}},goToView:function(e){var t=this.currentView,e=this.views[e];t.transitionOut(),e.transitionIn(),this.currentView=e,this.viewNavigationStack.push(t)},goToPreviousView:function(){var e=this.currentView,t=this.viewNavigationStack.pop();e.transitionOut(!0),t.transitionIn(!0),this.currentView=t,o(".ba-cheetah-bar-title-caret").focus()},resetViews:function(){this.currentView!=this.rootView&&(this.currentView.hide(),this.rootView.show(),this.currentView=this.rootView,this.viewNavigationStack=[])}});i.MainMenu=t;var s={init:function(){var e;i.addHook("saveTemplate",this.saveTemplate.bind(this)),i.addHook("saveCoreTemplate",this.saveCoreTemplate.bind(this)),i.addHook("duplicateLayout",this.duplicateLayout.bind(this)),i.addHook("showLayoutSettings",this.showLayoutSettings.bind(this)),i.addHook("showGlobalSettings",this.showGlobalSettings.bind(this)),i.addHook("showPageSettings",this.showPageSettings.bind(this)),i.addHook("startTour",this.startTour.bind(this)),i.addHook("toggleUISkin",this.toggleUISkin.bind(this)),i.addHook("clearLayoutCache",this.clearLayoutCache.bind(this)),o("input[name=cheetah-mode-checkbox]").change(this.toogleCheetahMode.bind(this)),"BA"in window&&"Builder"in BA&&(e=BA.Builder.data.getSystemActions(),i.addHook("showKeyboardShortcuts",function(){e.setShouldShowShortcuts(!0)}))},saveTemplate:function(){i._saveUserTemplateClicked(),t.hide()},saveCoreTemplate:function(){BACheetahCoreTemplatesAdmin._saveClicked(),t.hide()},duplicateLayout:function(){i._duplicateLayoutClicked(),t.hide()},showGlobalSettings:function(){i._globalSettingsClicked(),t.hide()},showPageSettings:function(){i._pageSettingsClicked(),t.hide()},startTour:function(){i._showTourLightbox(),t.hide()},showLayoutSettings:function(){i._layoutSettingsClicked(),t.hide()},clearLayoutCache:function(){i.ajax({action:"clear_cache"},function(){location.href=BACheetahConfig.editUrl}),i.showAjaxLoader(),t.hide()},toogleCheetahMode:function(e){e=e.target.value;confirm(BACheetahStrings.changeLayoutModeMessage)?(i.ajax({action:"set_cheetah_mode",canvas_enabled:"canvas"==e},function(){location.href=BACheetahConfig.editUrl}),i.showAjaxLoader(),t.hide()):o("input[name=cheetah-mode-checkbox]").val(["canvas"==e?"default":"canvas"])},toggleUISkin:function(e){var t,a;o('a[data-event="toggleUISkin"]');o("body").hasClass("ba-cheetah-ui-skin--light")&&(t="light",a="dark"),o("body").hasClass("ba-cheetah-ui-skin--dark")&&(t="dark",a="light"),o("body").removeClass("ba-cheetah-ui-skin--"+t).addClass("ba-cheetah-ui-skin--"+a),"Builder"in BA&&"data"in BA.Builder&&BA.Builder.data.getSystemActions().setColorScheme(a),i.ajax({action:"save_ui_skin",skin_name:a})}},n={init:function(){i.addHook("beginTour",this.onStartTourClicked.bind(this))},onStartTourClicked:function(){BACheetahTour.start(),t.hide()}}}(jQuery,BACheetah),function(h,o){var s=BACheetahExtendableObject.create({handle:"",name:"",panel:null,shouldShowTabItem:!0,isShowing:!1,views:{},activeView:null,defaultView:null,categorySelector:null,init:function(e){this.categorySelector=a.create({handle:"selector-"+this.handle,tab:this,items:[]}),this.categorySelector.init(),h(this.categorySelector).on("categorySelected",this.onViewSelected.bind(this));var t;e.views;this.initViews(e.views),0===Object.keys(this.views).length&&this.addView(t={handle:"noViews",name:"No Views",templateName:"ba-cheetah-content-panel-no-view"}),this.activeView||(e=Object.keys(this.views)[0],t=this.views[e],this.activeView=t),this.defaultView=this.activeView,h(this.panel).on("afterRender",this.renderView.bind(this,this.activeView)),h(this.panel).on("onShow onShowTab",this.initScroller.bind(this)),o.addHook("contentItemsChanged",this.onLibraryDataChanged.bind(this))},initViews:function(e){for(var t in e){t=e[t];this.categorySelector.addItem(t),"separator"!==t.type&&this.addView(t)}},addView:function(e){var t=i;switch(this.handle){case"modules":t=n;break;case"rows":t=l;break;case"templates":t=r;break;case"saved":t=d;break;default:t=i}var a=(t=!_.isNull(this.viewController)&&!_.isUndefined(this.viewController)?window[this.viewController]:t).create(e),e=a.handle;a.init(),(this.views[e]=a).isShowing&&(this.activeView=a)},renderView:function(e){var t;this.$el=this.panel.$el.find('.ba-cheetah--panel-view[data-tab="'+this.handle+'"]'),t=_.isObject(e)?e:this.views[e],_.isObject(t)&&_.isFunction(t.render)&&(e=t.render(),this.$el.find(".ba-cheetah-nanoscroller-content").html(e),this.activeView=t,o._initSortables(),this===this.panel.activeTab&&this.renderGroupSelector(),this.initScroller(),this.$el.find(".ba-cheetah-nanoscroller-content").scrollTop(0))},initScroller:function(){this.$el.nanoScroller({alwaysVisible:!0,preventPageScrolling:!0,paneClass:"ba-cheetah-nanoscroller-pane",sliderClass:"ba-cheetah-nanoscroller-slider",contentClass:"ba-cheetah-nanoscroller-content"})},show:function(){h(this.activeView).trigger("onBeforeShow"),this.renderGroupSelector(),this.isShowing=!0,this.$el.addClass("is-showing"),this.$el.find(".ba-cheetah-nanoscroller-content").scrollTop(0)},hide:function(){this.isShowing=!1,this.$el.removeClass("is-showing"),this.activeView!==this.defaultView&&this.renderView(this.defaultView),_.isObject(this.categorySelector)&&this.categorySelector.close()},renderGroupSelector:function(){var e,t=this.panel.$groupSelect,a=this.panel.$el.find(".ba-cheetah-panel-search");this.isSearchEnabled?a.show():a.hide(),0<Object.keys(this.views).length&&!_.isUndefined(this.categorySelector)?(e=this.categorySelector.render(),this.panel.$el.find(".ba-cheetah-content-group-select"),t.html(e),t.show(),this.panel.$el.removeClass("single-view")):(t.hide(),a.hide(),this.panel.$el.addClass("single-view"));const i=this.panel.$el.find(".ba-cheetah--panel-controls");"saved"===this.handle?i.hide():i.show()},onViewSelected:function(e,t){this.renderView(t),this.categorySelector.close()},onLibraryDataChanged:function(){this.renderView(this.activeView)}}),i=BACheetahExtendableObject.create({templateName:"",name:"",handle:"",query:null,init:function(){this.template=wp.template(this.templateName),h(this).on("afterRender",this.bindEvents.bind(this)),h(this).trigger("afterInit")},filterTemplateData:function(e){return _.isNull(this.query)||_.isUndefined(this.query)||(e.queryResults=o.Search.byQuery(this.query)),e},render:function(){h(this).trigger("beforeRender");var e=this.filterTemplateData(this),e=h(this.template(e));return this.$el=e,h(this).trigger("afterRender"),e},bindEvents:function(){},transitionIn:function(){},transitionOut:function(){}}),n=i.create({templateName:"ba-cheetah-content-panel-modules-view",bindEvents:function(){this.$sections=this.$el,this.$items=this.$el.find(".ba-cheetah-block, .ba-cheetah-blocks-section-title"),this.$collapsibleItems=this.$el.find(".ba-cheetah-blocks-section-header"),this.$collapsibleItems.on("click",this.onCollapseModuleClicked.bind(this)),this.$items.find(".ba-cheetah--element-denied").tipTip({edgeOffset:25})},onCollapseModuleClicked:function(e){h(e.delegateTarget).parent().toggleClass("is-collapsed")}}),l=i.create({templateName:"ba-cheetah-content-panel-row-templates-view",bindEvents:function(){this.$items=this.$el.find(".ba-cheetah-block, .ba-cheetah-blocks-section-title"),this.$items.find(".ba-cheetah--template-incompatible, .ba-cheetah--template-denied").tipTip({edgeOffset:25}),this.$items.find(".ba-preview-row").tipTip({edgeOffset:5,defaultPosition:"right"})}}),r=i.create({templateName:"ba-cheetah-content-panel-templates-view",bindEvents:function(){this.$items=this.$el.find(".ba-cheetah--template-collection-item"),this.$items.find(".ba-cheetah--template-apply").on("click",this.onTemplateClick.bind(this)),this.$items.find(".ba-cheetah--template-incompatible, .ba-cheetah--template-denied").tipTip({maxWidth:100,edgeOffset:25}),this.$userTemplateSections=h(".ba-cheetah-user-templates"),this.$userTemplates=this.$el.find(".ba-cheetah-user-template, .ba-cheetah--save-new-user-template"),this.$saveNewTemplateInput=this.$el.find('.ba-cheetah-save-control input[name="template-name"]'),this.$saveNewTemplateCat=this.$el.find('.ba-cheetah-save-control input[name="template-category"]'),this.$saveNewTemplateBtn=this.$el.find(".ba-cheetah-save-control button"),this.$saveNewMask=this.$el.find(".ba-cheetah-save-control-mask"),this.$saveNewTemplateInput.on("focus",this.onSaveInputFocus.bind(this)),this.$saveNewTemplateInput.on("keyup",this.onSaveInputKeyup.bind(this)),this.$saveNewTemplateBtn.on("click",this.onSaveButtonClick.bind(this)),this.$saveNewMask.on("click",this.resetSaveInput.bind(this))},onSaveInputFocus:function(){this.resetSaveInput(),this.$saveNewMask.show()},resetSaveInput:function(){this.$saveNewTemplateInput.val(""),this.$saveNewTemplateBtn.hide(),this.$saveNewMask.hide()},onSaveInputKeyup:function(e){var t=h(e.currentTarget),e=t.val(),t=t.siblings("button");""!==e?t.show():t.hide()},onSaveButtonClick:function(e){var t=h(e.currentTarget),e=t.siblings('input[name="template-name"]').val(),t=t.siblings('input[name="template-category"]').val();""!==e&&o.ajax({action:"save_user_template",settings:{name:e,category:t}},o._saveUserTemplateSettingsComplete)},onTemplateClick:function(e){var t=h(e.currentTarget).closest(".ba-cheetah--template-collection-item"),a=t.data("id"),e=t.data("type"),t=t.data("content-central-id");o._requestTemplateInsert(a,e,t)}}),d=i.create({templateName:"ba-cheetah-content-panel-saved-view",filterTemplateData:function(e){return e.queryResults=o.Search.byQuery({kind:"template",type:"user",content:["module","column","row"]}),e}}),a=BACheetahExtendableObject.create({templateName:"ba-cheetah-content-panel-category-selector",template:null,tab:null,isOpen:!1,items:{},init:function(){this.template=wp.template(this.templateName),h(this).on("afterRender",this.bindEvents.bind(this)),h(this.tab.panel).on("didShowSearchControls",this.close.bind(this))},render:function(){this.close();var e=h(this.template(this));return this.$el=e,h(this).trigger("afterRender"),e},bindEvents:function(){this.$selectorTitle=this.$el.find(".ba-cheetah--selector-display"),this.$selectorTitle.on("click",this.toggleOpenClose.bind(this)),this.$categories=this.$el.find(".ba-cheetah--selector-menu .ba-cheetah--menu-item"),this.$categories.on("click",this.onCategoryClick.bind(this))},addItem:function(e){var t=_.isUndefined(e.handle)?_.uniqueId("sep_"):e.handle;this.items[t]=e},open:function(){this.isOpen||(this.$el.addClass("is-showing"),this.isOpen=!0)},close:function(){this.isOpen&&(this.$el.removeClass("is-showing"),this.isOpen=!1,this.$selectorTitle.find("button").focus())},toggleOpenClose:function(){this.isOpen?this.close():this.open()},onCategoryClick:function(e){var t=h(e.target),a=t.data("view");t.hasClass("ba-cheetah-has-children")?((e=h('[data-parent="'+a+'"]')).is(":visible")?(this.items[a].hasChildrenOpen=!1,t.removeClass("ba-cheetah-has-children-showing"),e.hide()):(this.items[a].hasChildrenOpen=!0,t.addClass("ba-cheetah-has-children-showing"),e.show()),t.blur()):h(this).trigger("categorySelected",a)}});o.ContentPanel=BACheetahExtendableObject.create({templateName:"ba-cheetah-content-panel-base",template:null,tabs:{},activeTab:null,isShowing:!1,init:function(){if(BACheetahConfig.panelData){var e,t=BACheetahConfig.panelData.tabs;for(e in t){var a=t[e],i=s.create(a);i.panel=this,i.views={},i.init(a),(this.tabs[e]=i).isShowing&&(this.activeTab=i),this.activeTab||(a=Object.keys(this.tabs)[0],(i=this.tabs[a]).isShowing=!0,this.activeTab=i)}this.template=wp.template(this.templateName),this.render(),this.renderSearchResults=wp.template("ba-cheetah-search-results-panel"),this.renderNoResults=wp.template("ba-cheetah-search-no-results"),o.triggerHook("contentPanelDidInit")}},render:function(){h("body").prepend(this.template(this)),this.$el=h(".ba-cheetah--content-library-panel"),this.bindEvents(),this.$groupSelect=this.$el.find(".ba-cheetah-content-group-select"),h(this).trigger("afterRender")},bindEvents:function(){this.$tabs=this.$el.find(".ba-cheetah--tabs [data-tab]"),this.$tabs.on("mouseup",this.onTabItemMouseUp.bind(this)),this.$tabs.on("click",this.onTabItemClick.bind(this)),this.$search=this.$el.find(".ba-cheetah-panel-search"),this.$searchBtn=this.$search.find(".ba-cheetah-toggle-panel-search"),this.$searchInput=this.$search.find('input[name="search-term"]'),this.$searchBtn.on("click",this.onSearchButtonClicked.bind(this)),this.$search.find(".ba-cheetah-dismiss-panel-search").on("click",this.onDismissButtonClicked.bind(this)),this.$searchInput.on("keyup",this.onSearchTermChanged.bind(this)),this.$searchPanel=this.$el.find(".ba-cheetah--search-results-panel"),o.addHook("showContentPanel",this.show.bind(this)),o.addHook("showModules",this.show.bind(this,"modules")),o.addHook("showRows",this.show.bind(this,"rows")),o.addHook("showTemplates",this.show.bind(this,"templates")),o.addHook("showSaved",this.show.bind(this,"saved")),o.addHook("showSearch",this.goToSearch.bind(this));var e=this.hide.bind(this);o.addHook("hideContentPanel",e),o.addHook("didShowLightbox",e),o.addHook("didShowPublishActions",e),o.addHook("didBeginSearch",e),o.addHook("didInitDrag",e),o.addHook("didOpenMainMenu",e),o.addHook("didApplyTemplate",e);e=this.toggleShowHide.bind(this);o.addHook("toggleContentPanel",e),o.addHook("didStopDrag",this.hideSearchControls.bind(this))},alignPanelArrow:function(){var e,t=this.$el,a=this.$el.find(".ba-cheetah--panel-arrow"),i=h(".ba-cheetah-content-panel-button"),o=this.$el.css("animation-duration");0!=i.length&&(this.$el.css("animation-duration","0s"),this.show(),e=t[0].getBoundingClientRect(),t=a[0].getBoundingClientRect(),this.hide(),this.$el.css("animation-duration",o),t=(i=(i=i[0].getBoundingClientRect()).x+i.width/2)<e.x?20:i-e.x-t.width/2,a.css({right:"auto",left:t+"px"}))},show:function(e){if("module"!==BACheetahConfig.userTemplateType&&!BACheetahConfig.simpleUi&&(o.triggerHook("willShowContentPanel"),void 0!==e&&this.showTab(e),!this.isShowing&&o._triggerSettingsSave(!1,!0)&&(h("body").addClass("ba-cheetah-content-panel-is-showing"),this.isShowing=!0,h(this).trigger("onShow"),o.triggerHook("didShowContentPanel"),"Builder"in BA&&"data"in BA.Builder))){const t=BA.Builder.data.getSystemActions();t.hideCurrentPanel()}},hide:function(){this.isShowing&&(this.$el.hasClass("ba-cheetah-ui-pinned")||(h("body").removeClass("ba-cheetah-content-panel-is-showing"),this.isShowing=!1,h(this).trigger("onHide"),o.triggerHook("didHideContentPanel")))},toggleShowHide:function(){this.isShowing?this.hide():this.show()},showTab:function(e){e=this.tabs[e];_.isObject(e)&&(_.isObject(this.activeTab)&&("modules"==this.activeTab.handle&&o._triggerSettingsSave(!1,!1,!1),this.activeTab.hide(),this.$tabs.filter(".is-showing").removeClass("is-showing")),this.hideSearchControls(),e.show(),this.$tabs.filter('[data-tab="'+e.handle+'"]').addClass("is-showing"),this.activeTab=e,h(this).trigger("onShowTab"))},goToSearch:function(){this.show("modules"),this.$el.find(".ba-cheetah-toggle-panel-search").trigger("click")},onTabItemMouseUp:function(e){h(e.currentTarget).blur()},onTabItemClick:function(e){e=h(e.target).data("tab");this.showTab(e)},onSearchButtonClicked:function(){this.showSearchControls()},onDismissButtonClicked:function(){this.hideSearchControls(),this.$searchBtn.focus()},showSearchControls:function(){this.$search.addClass("is-showing-input"),this.$search.find('input[name="search-term"]').focus(),h(".ba-cheetah--selector-display-label").attr("tabindex",-1),this.$searchBtn.attr("tabindex",-1),h(this).trigger("didShowSearchControls")},hideSearchControls:function(){this.$search.removeClass("is-showing-input"),this.clearSearchInput(),this.hideSearchResults(),h(".ba-cheetah--selector-display-label").attr("tabindex",null),this.$searchBtn.attr("tabindex",null)},onSearchTermChanged:function(e){var t,a=this.$searchInput.val();""!==a&&""!=(t=o.Search.byTerm(a)).term?this.showSearchResults(t):this.hideSearchResults()},clearSearchInput:function(){this.$searchInput.val(""),this.hideSearchResults()},showSearchResults:function(e){var t;0<e.total?(t=h(this.renderSearchResults(e)),this.$searchPanel.html(t),o._initSortables()):(t=h(this.renderNoResults(e)),this.$searchPanel.html(t)),h("body").addClass("ba-cheetah-search-results-panel-is-showing")},hideSearchResults:function(){h("body").removeClass("ba-cheetah-search-results-panel-is-showing")}})}(jQuery,BACheetah),function(c){BACheetahSettingsForms={config:null,settings:null,legacyXhr:null,init:function(){this.bind()},bind:function(){BACheetah.addHook("didDeleteRow",this.closeOnDeleteNode),BACheetah.addHook("didDeleteColumn",this.closeOnDeleteNode),BACheetah.addHook("didDeleteModule",this.closeOnDeleteNode)},render:function(e,t){var a=BACheetahSettingsConfig.forms,i=BACheetahSettingsConfig.modules;if(!e.nodeId||e.settings){if(t=void 0===t?function(){}:t,(e=c.extend({type:"general",id:null,nodeId:null,className:"",attrs:"",title:"",badges:[],tabs:[],activeTab:null,buttons:[],settings:{},legacy:null,rules:null,preview:null,helper:null,messages:null},e)).id){if("general"===e.type&&void 0!==a[e.id])e=c.extend(!0,e,a[e.id]);else{if("module"!==e.type||void 0===i[e.id])return;e=c.extend(!0,e,i[e.id])}if(this.config=e,this.renderLightbox(e)&&(e.legacy||!this.renderLegacySettings(e,t)?this.renderComplete(e,t):this.showLightboxLoader()),"Builder"in BA&&"data"in BA.Builder){const o=BA.Builder.data.getSystemActions();o.hideCurrentPanel()}}}else this.loadNodeSettings(e,t)},loadNodeSettings:function(t,a){BACheetah.showAjaxLoader(),BACheetah.ajax({action:"get_node_settings",node_id:t.nodeId},function(e){t.settings=BACheetah._jsonParse(e),BACheetahSettingsConfig.nodes[t.nodeId]=t.settings,BACheetahSettingsForms.render(t,a),BACheetah.hideAjaxLoader()})},renderLightbox:function(e){var t=wp.template("ba-cheetah-settings"),a=BACheetah._lightbox._node.find("form.ba-cheetah-settings"),i=(c(".ba-cheetah-lightbox-wrap[data-parent]"),localStorage.getItem("ba-cheetah-settings-tab"));if(e.nodeId&&e.nodeId===a.data("node")&&!e.lightbox)return BACheetah._focusFirstSettingsControl(),!1;if(e.hide)return!0;if(i)for(var o in e.tabs)o===i.replace("ba-cheetah-settings-tab-","")&&(e.activeTab=o);if(e.activeTab||(e.activeTab=Object.keys(e.tabs).shift()),e.lightbox)e.lightbox.setContent(t(e));else{if(!BACheetah._triggerSettingsSave(!0,!0))return!1;BACheetah.preview&&BACheetah.preview.cancel(),BACheetah._closePanel(),BACheetah._showLightbox(t(e))}return!0},renderComplete:function(e,t){var a=c(".ba-cheetah-settings:visible");setTimeout(function(){e.legacy&&this.renderLegacySettingsComplete(e.legacy),t(),BACheetah._initSettingsForms(),e.rules&&BACheetah._initSettingsValidation(e.rules,e.messages),e.preview&&(BACheetah.preview=new BACheetahPreview(e.preview)),e.helper&&e.helper.init(),a.closest(".ba-cheetah-lightbox-wrap[data-parent]").length||(this.settings=BACheetah._getSettingsForChangedCheck(this.config.nodeId,a))}.bind(this),1)},renderFields:function(e,t){var a,i,o=wp.template("ba-cheetah-settings-row"),h="",s=null,n=null,l=null,r=["align","border","dimension","unit","photo","select","typography"],t=t||this.config.settings,d=BACheetahConfig.global;for(s in e)i=!!(a=e[s]).multiple,supportsResponsive=-1<c.inArray(a.type,r),n=_.isUndefined(t[s])?"":t[s],a.type&&(_.isUndefined(t[s])&&a.default&&(n=a.default),l=a.responsive&&d.responsive_enabled&&!i&&supportsResponsive?a.responsive:null,h+=o({field:a,name:s,rootName:s,value:n,preview:JSON.stringify(a.preview||{type:"refresh"}),responsive:l,rowClass:a.row_class?" "+a.row_class:"",isMultiple:i,supportsMultiple:"editor"!==a.type&&"service"!==a.type,settings:t,globalSettings:d,template:c("#tmpl-ba-cheetah-field-"+a.type)}));return h},renderField:function(e){return wp.template("ba-cheetah-field")(e)},renderSectionTemplate:function(e,t){return wp.template(e.template.id)({section:e,settings:t})},renderTabTemplate:function(e,t){return wp.template(e.template.id)({tab:e,settings:t})},renderLegacySettings:function(t,a){var e=c(".ba-cheetah-settings:visible"),i=null,o=!1,h={tabs:[],sections:[],fields:[],settings:null,node_id:null};return e.find(".ba-cheetah-legacy-field").each(function(){i=c(this),h.fields.push(i.attr("data-field")),BACheetahSettingsForms.showFieldLoader(i),o=!0}),e.find(".ba-cheetah-legacy-settings-section").each(function(){i=c(this),h.sections.push({tab:i.attr("data-tab"),section:i.attr("data-section")}),o=!0}),e.find(".ba-cheetah-legacy-settings-tab").each(function(){i=c(this),h.tabs.push(i.attr("data-tab")),o=!0}),e.attr("data-node")?h.node_id=e.attr("data-node"):h.settings=BACheetah._getOriginalSettings(e,!0),this.legacyXhr&&(this.legacyXhr.abort(),this.legacyXhr=null),this.legacyXhr=BACheetah.ajax(c.extend(this.getLegacyVars(),{action:"render_legacy_settings",data:h,form:e.attr("data-form-id"),group:e.attr("data-form-group"),lightbox:e.closest(".ba-cheetah-lightbox").attr("data-instance-id")}),function(e){BACheetahSettingsForms.renderLegacySettingsComplete(e),o&&BACheetahSettingsForms.renderComplete(t,a),BACheetahSettingsForms.hideLightboxLoader()}),o},renderLegacySettingsComplete:function(e){var a="object"==typeof e?e:BACheetah._jsonParse(e),t=null,e=null,i="",o=null,h=null;if(a.lightbox?e=(t=c(".ba-cheetah-lightbox[data-instance-id="+a.lightbox+"]")).length?t.find(".ba-cheetah-settings"):null:t=(e=c(".ba-cheetah-settings:visible")).closest(".ba-cheetah-lightbox"),e&&e.length){for(i in a.fields)(o=c("#ba-cheetah-field-"+i).attr("id","")).after(a.fields[i]).remove();for(i in a.extras)o=c("#ba-cheetah-field-"+i).find(".ba-cheetah-field-control-wrapper"),a.extras[i].multiple?o.each(function(e,t){e in a.extras[i].before&&""!=a.extras[i].before[e]&&c(this).prepend('<div class="ba-cheetah-form-field-before">'+a.extras[i].before[e]+"</div>"),e in a.extras[i].after&&""!=a.extras[i].after[e]&&c(this).append('<div class="ba-cheetah-form-field-after">'+a.extras[i].after[e]+"</div>")}):(""!=a.extras[i].before&&o.prepend('<div class="ba-cheetah-form-field-before">'+a.extras[i].before+"</div>"),""!=a.extras[i].after&&o.append('<div class="ba-cheetah-form-field-after">'+a.extras[i].after+"</div>"));for(h in a.sections)for(i in a.sections[h])c("#ba-cheetah-settings-section-"+i).html(a.sections[h][i]);for(i in a.tabs)(h=c("#ba-cheetah-settings-tab-"+i)).html(a.tabs[i]);t.data("parent")||(this.settings=BACheetah._getSettingsForChangedCheck(this.config.nodeId,e),BACheetah.preview&&(this.settings=c.extend(this.settings,BACheetah.preview._savedSettings),BACheetah.preview._savedSettings=this.settings)),this.legacyXhr=null}},getLegacyVars:function(){var e,t,a=c(".ba-cheetah-settings:visible"),i=a.closest(".ba-cheetah-lightbox").attr("data-parent"),o={};return i&&(a=(i=c(".ba-cheetah-lightbox[data-instance-id="+i+"]")).find("form.ba-cheetah-settings"),e=BACheetah._getSettings(a),(t=a.attr("data-node"))&&(o.node_id=t,o.node_settings=e)),o},settingsHaveChanged:function(){var e=BACheetah._lightbox._node.find("form.ba-cheetah-settings"),t=BACheetah._getSettings(e),t=!!this.settings&&JSON.stringify(this.settings)!=JSON.stringify(t);return t=BACheetahConfig.modulesRowInsideEnabled.includes(e.attr("data-type"))?!0:t},closeOnDeleteNode:function(e){var t=c(".ba-cheetah-settings[data-node]"),a=BACheetah._contentClass+" .ba-cheetah-node-"+t.data("node");t.length&&!c(a).length&&BACheetahLightbox.closeAll()},showLightboxLoader:function(){c(".ba-cheetah-settings:visible").append('<div class="ba-cheetah-loading"></div>')},hideLightboxLoader:function(e){c(".ba-cheetah-settings:visible .ba-cheetah-loading").remove()},showFieldLoader:function(e){e.closest(".ba-cheetah-field-control").find(".ba-cheetah-field-control-wrapper").hide().after('<div class="ba-cheetah-field-loader">'+BACheetahStrings.fieldLoading+"</div>")},hideFieldLoader:function(e){var t=e.closest(".ba-cheetah-field");e.closest(".ba-cheetah-field-control").find(".ba-cheetah-field-control-wrapper").show(),t.find(".ba-cheetah-field-loader").remove()}},BACheetahSettingsConfig="undefined"==typeof BACheetahSettingsConfig?{}:BACheetahSettingsConfig,c.extend(BACheetahSettingsConfig,{init:function(){BACheetah.addHook("didSaveNodeSettings",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didSaveNodeSettingsComplete",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didSaveLayoutSettingsComplete",this.updateOnSaveLayoutSettings.bind(this)),BACheetah.addHook("didSaveGlobalSettingsComplete",this.updateOnSaveGlobalSettings.bind(this)),BACheetah.addHook("didSaveGlobalSettingsComplete",this.reload),BACheetah.addHook("didAddRow",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didAddColumnGroup",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didAddColumn",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didAddModule",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDeleteRow",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDeleteColumn",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDeleteModule",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDuplicateRow",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDuplicateColumn",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didDuplicateModule",this.updateOnNodeEvent.bind(this)),BACheetah.addHook("didResizeRow",this.updateOnRowResize.bind(this)),BACheetah.addHook("didResizeColumn",this.updateOnColumnResize.bind(this)),BACheetah.addHook("didResetRowWidth",this.updateOnResetRowWidth.bind(this)),BACheetah.addHook("didResetColumnWidths",this.updateOnResetColumnWidths.bind(this)),BACheetah.addHook("didApplyTemplateComplete",this.updateOnApplyTemplate.bind(this)),BACheetah.addHook("didApplyRowTemplateComplete",this.updateOnApplyTemplate.bind(this)),BACheetah.addHook("didApplyColTemplateComplete",this.updateOnApplyTemplate.bind(this)),BACheetah.addHook("didSaveGlobalNodeTemplate",this.updateOnApplyTemplate.bind(this)),BACheetah.addHook("didRestoreRevisionComplete",this.updateOnApplyTemplate.bind(this)),BACheetah.addHook("didRestoreHistoryComplete",this.updateOnHistoryRestored.bind(this))},reload:function(){var e=BACheetahConfig.editUrl+"&ba_cheetah_load_settings_config=core";c('script[src*="ba_cheetah_load_settings_config=core"]').remove(),c("head").append('<script src="'+e+'"><\/script>')},updateOnSaveGlobalSettings:function(e,t){this.settings.global=t,BACheetahConfig.global=t},updateOnSaveLayoutSettings:function(e,t){this.settings.layout=t},updateOnNodeEvent:function(){var e=arguments[0];-1<e.namespace.indexOf("didAdd")?this.addNode("object"==typeof arguments[1]?arguments[1].nodeId:arguments[1]):-1<e.namespace.indexOf("didSaveNodeSettings")?this.updateNode(arguments[1].nodeId,arguments[1].settings):-1<e.namespace.indexOf("didDelete")?this.deleteNodes("object"==typeof arguments[1]?arguments[1].nodeId:arguments[1]):-1<e.namespace.indexOf("didDuplicate")&&this.duplicateNode(arguments[1].oldNodeId,arguments[1].newNodeId)},updateOnRowResize:function(e,t){this.nodes[t.rowId].max_content_width=t.rowWidth},updateOnResetRowWidth:function(e,t){this.nodes[t].max_content_width=""},updateOnColumnResize:function(e,t){this.nodes[t.colId].size=t.colWidth,this.nodes[t.siblingId].size=t.siblingWidth},updateOnResetColumnWidths:function(e,t){var a=this;t.cols.each(function(){var e=c(this),t=e.attr("data-node");a.nodes[t]&&(a.nodes[t].size=parseFloat(e[0].style.width))})},updateOnApplyTemplate:function(e,t){this.nodes=t.nodes,this.attachments=t.attachments},updateOnHistoryRestored:function(e,t){this.nodes=t.config.nodes,this.attachments=t.config.attachments,this.settings.layout=t.settings.layout,this.settings.global=t.settings.global,BACheetahConfig.global=t.settings.global},addNode:function(e,t){var a=c(".ba-cheetah-node-"+e),i=a.hasClass("ba-cheetah-row"),o=a.hasClass("ba-cheetah-col"),h=a.hasClass("ba-cheetah-col-group"),s=a.hasClass("ba-cheetah-module"),n=this;this.nodes[e]||(t||(i?t=c.extend({},this.defaults.row):o?t=c.extend({},this.defaults.column):s&&(t=c.extend({},this.defaults.modules[a.attr("data-type")])),i||h?a.find(".ba-cheetah-col").each(function(){var e=c(this),t=c.extend({},n.defaults.column);t.size=parseFloat(e[0].style.width),n.addNode(e.attr("data-node"),t)}):s&&(n.addNode(a.closest(".ba-cheetah-row").attr("data-node")),n.addNode(a.closest(".ba-cheetah-col").attr("data-node")),n.updateOnResetColumnWidths(null,{cols:a.closest(".ba-cheetah-col-group").find("> .ba-cheetah-col")}))),t&&(this.nodes[e]=t))},updateNode:function(e,a){var t=c(".ba-cheetah-node-"+e),i=this;t.hasClass("ba-cheetah-col")&&t.closest(".ba-cheetah-col-group").find("> .ba-cheetah-col").each(function(){var e=c(this),t=e.attr("data-node");i.nodes[t].size=parseFloat(e[0].style.width),i.nodes[t].equal_height=a.equal_height,i.nodes[t].content_alignment=a.content_alignment,i.nodes[t].responsive_order=a.responsive_order}),this.nodes[e]=a},duplicateNode:function(t,a){var e=c(".ba-cheetah-node-"+a).find("[data-node]"),i=c(".ba-cheetah-node-"+t).find("[data-node]"),o=this;this.nodes[a]=this.nodes[t],e.each(function(e){t=i.eq(e).attr("data-node"),a=c(this).attr("data-node"),o.nodes[t]&&(o.nodes[a]=o.nodes[t])})},deleteNodes:function(){var e="",t=c(BACheetah._contentClass).html();for(e in this.nodes)-1===t.indexOf(e)&&(this.nodes[e]=null,delete this.nodes[e])}}),c(function(){BACheetahSettingsConfig.init(),BACheetahSettingsForms.init()})}(jQuery),function(c){BACheetahSettingsCopyPaste={init:function(){BACheetah.addHook("settings-form-init",this.initExportButton),BACheetah.addHook("settings-form-init",this.initImportButton)},initExportButton:function(){new ClipboardJS("button.module-export-all",{text:function(e){var t=c(".ba-cheetah-module-settings").data("node"),a=c(".ba-cheetah-module-settings[data-node="+t+"]"),t=c(".ba-cheetah-module-settings").data("type"),a=BACheetah._getSettings(a),t="/// {type:"+t+"} "+(new Date).toDateString()+" ///",i=c("button.module-export-all"),o=i.attr("title");return i.text(BACheetahStrings.module_import.copied),setTimeout(function(){i.text(o)},1e3),t+"\n"+JSON.stringify(a)}}),new ClipboardJS("button.module-export-style",{text:function(e){var t,a=c(".ba-cheetah-module-settings").data("node"),i=c(".ba-cheetah-module-settings[data-node="+a+"]"),a=c(".ba-cheetah-module-settings").data("type"),o=BACheetah._getSettings(i),a="/// {type:"+a+"} "+(new Date).toDateString()+" ///",h=c("button.module-export-style"),s=h.attr("title"),n={};for(t in o){var l=i.find('[name="'+t+'"]'),r=i.find('[name*="'+t+'["]'),d=!1;l.length?d=l.closest(".ba-cheetah-field").data("is-style"):r.length&&(d=r.closest(".ba-cheetah-field").data("is-style")),d&&(n[t]=o[t])}return h.text(BACheetahStrings.module_import.copied),setTimeout(function(){h.text(s)},1e3),a+"\n"+JSON.stringify(n)}})},initImportButton:function(){c("button.module-import-apply").click(function(){var e=c(".ba-cheetah-settings-lightbox .ba-cheetah-settings"),t=c(".module-import-input").val(),a=t.match(/\/\/\/\s\{type:([_a-z0-9-]+)/),i=!1,o=c(".ba-cheetah-module-settings").data("type"),h=c(".ba-cheetah-settings-lightbox .module-import-error");if(h.hide(),!(i=a&&void 0!==a[1]?a[1]:i)||i!==o)return h.html(BACheetahStrings.module_import.type).show(),!1;t=t.replace(/\/\/\/.+\/\/\//,"");try{var s=JSON.parse(t)}catch(e){var s=!1;return h.html(BACheetahStrings.module_import.error).show(),!1}s&&(e=e.attr("data-node"),s=c.extend({},BACheetahSettingsConfig.nodes[e],s),BACheetahSettingsConfig.nodes[e]=s,BACheetah.ajax({action:"save_settings",node_id:e,settings:s},BACheetah._saveSettingsComplete.bind(this,!0,null)),BACheetah.triggerHook("didSaveNodeSettings",{nodeId:e,settings:s}),BACheetah._lightbox.close())})}},c(function(){BACheetahSettingsCopyPaste.init()})}(jQuery),function(l){var e={minWidth:320,maxWidth:600,minHeight:400,init:function(){this.initPanel(),this.pinOrUnpin(),this.bind()},bind:function(){var e=l(window),t=l("body");e.on("resize",_.throttle(this.windowResize.bind(this),250)),t.delegate(".ba-cheetah-ui-pinned-collapse","click",this.collapse),t.delegate(".ba-cheetah--content-library-panel .ba-cheetah--tabs","click",this.closeLightboxOnPanelClick),BACheetah.addHook("didShowLightbox",this.pinLightboxOnOpen.bind(this)),BACheetah.addHook("didHideAllLightboxes",this.pinnedLightboxClosed.bind(this)),BACheetah.addHook("endEditingSession",this.hide.bind(this)),BACheetah.addHook("didHideEditingUI",this.hide.bind(this)),BACheetah.addHook("publishButtonClicked",this.hide.bind(this)),BACheetah.addHook("restartEditingSession",this.show.bind(this)),BACheetah.addHook("didShowEditingUI",this.show.bind(this)),BACheetah.addHook("didShowLightbox",this.uncollapse.bind(this)),BACheetah.addHook("willShowContentPanel",this.uncollapse.bind(this)),BACheetah.addHook("willShowContentPanel",this.closeLightboxOnPanelClick.bind(this))},isPinned:function(){return l(".ba-cheetah--content-library-panel").hasClass("ba-cheetah-ui-pinned")},pin:function(e,t){this.pinPanel(e),this.pinLightboxes(),t&&this.savePosition(),BACheetah._resizeLayout(),BACheetah.triggerHook("didPinContentPanel")},unpin:function(e){this.unpinLightboxes(),this.unpinPanel(),e&&this.savePosition(),BACheetah._resizeLayout(),BACheetah.triggerHook("didUnpinContentPanel")},pinOrUnpin:function(){var e=l(".ba-cheetah--content-library-panel"),t=this.isPinned();e.hasClass("ba-cheetah-ui-pinned-hidden")||(window.innerWidth<=this.maxWidth?(t&&this.unpin(!1),this.disableDragAndResize()):(t||this.restorePosition(),this.enableDragAndResize()))},show:function(){var e=l(".ba-cheetah--content-library-panel");e.hasClass("ba-cheetah-ui-pinned-hidden")&&(e.removeClass("ba-cheetah-ui-pinned-hidden"),e.show(),this.restorePosition())},hide:function(){var e=l("body"),t=l(".ba-cheetah--content-library-panel");this.isPinned()&&(this.uncollapse(),t.addClass("ba-cheetah-ui-pinned-hidden"),t.hide(),e.css("margin",""),BACheetah._resizeLayout())},collapse:function(){var e=l(this).find("i:visible"),t=l("body"),a=e.data("toggle"),i=e.data("position"),o=l(".ba-cheetah--content-library-panel"),e=o.outerWidth();"hide"===a?(o.css(i,"-"+e+"px"),t.css("margin-"+i,""),t.addClass("ba-cheetah-ui-pinned-is-collapsed")):(o.css(i,"0px"),t.css("margin-"+i,e+"px"),t.removeClass("ba-cheetah-ui-pinned-is-collapsed"))},uncollapse:function(){this.isCollapsed()&&l(".ba-cheetah-ui-pinned-collapse:visible").trigger("click")},isCollapsed:function(){return l("body").hasClass("ba-cheetah-ui-pinned-is-collapsed")},initPanel:function(){var e=l(".ba-cheetah--content-library-panel");e.draggable({cursor:"move",handle:".ba-cheetah--tabs",cancel:".ba-cheetah--tabs button",scroll:!1,drag:this.drag.bind(this),stop:this.dragStop.bind(this),start:this.dragStart.bind(this)}).resizable({handles:"e, w",minHeight:this.minHeight,minWidth:this.minWidth,maxWidth:this.maxWidth,start:this.resizeStart.bind(this),stop:this.resizeStop.bind(this)}),e.addClass("ba-cheetah-ui-pinned-container"),e.find(".ui-resizable-e, .ui-resizable-w").hide()},pinPanel:function(e){var t=l(".ba-cheetah--content-library-panel"),a=t.outerWidth(),i=l("body"),o=l(".ba-cheetah-responsive-preview, .ba-cheetah-responsive-preview-mask");content=l(BACheetah._contentClass).parentsUntil("body").last(),i.addClass("ba-cheetah-ui-is-pinned ba-cheetah-ui-is-pinned-"+e),i.addClass("ba-cheetah-content-panel-is-showing"),i.css("margin-"+e,a+"px"),o.css("margin-"+e,a+"px"),l(".ba-cheetah-ui-pinned-content-transform").length||content.addClass("ba-cheetah-ui-pinned-content-transform"),t.addClass("ba-cheetah-ui-pinned ba-cheetah-ui-pinned-"+e),t.find(".ui-resizable-"+("left"===e?"e":"w")).show(),t.on("resize",_.throttle(this.resize.bind(this),250)),t.attr("style",""),BACheetah.ContentPanel.isShowing=!0},unpinPanel:function(){var e=l(".ba-cheetah--content-library-panel"),t=e.find(".ba-cheetah--panel-content .is-showing").data("tab"),a=l("body"),i=l(".ba-cheetah-responsive-preview, .ba-cheetah-responsive-preview-mask"),o=l(BACheetah._contentClass).parentsUntil("body").last();a.css("margin-left",""),a.css("margin-right",""),a.removeClass("ba-cheetah-ui-is-pinned"),a.removeClass("ba-cheetah-ui-is-pinned-left"),a.removeClass("ba-cheetah-ui-is-pinned-right"),i.css("margin-left",""),i.css("margin-right",""),o.removeClass("ba-cheetah-lightbox-content-transform"),e.removeClass("ba-cheetah-ui-pinned"),e.removeClass("ba-cheetah-ui-pinned-left"),e.removeClass("ba-cheetah-ui-pinned-right"),e.find(".ui-resizable-handle").hide(),e.off("resize"),e.attr("style",""),e.find(".ba-cheetah--tabs [data-tab="+t+"]").addClass("is-showing")},pinLightboxes:function(){var e=this;l(".ba-cheetah-lightbox-resizable").each(function(){e.pinLightbox(l(this))}),BACheetah._reinitEditorFields()},pinLightbox:function(e){var t=l(".ba-cheetah--content-library-panel"),a=e.closest(".ba-cheetah-lightbox-wrap");a.closest(".ba-cheetah-ui-pinned").length||(t.append(a),e.attr("style",""),e.draggable("disable"),e.resizable("disable")),e.is(":visible")&&t.find(".ba-cheetah--tabs .is-showing").removeClass("is-showing")},pinLightboxOnOpen:function(e,t){t=t._node.find(".ba-cheetah-lightbox-resizable");t.length&&(t.hasClass("ba-cheetah-ui-pinning-initialized")||(t.draggable("option","start",this.dragStart.bind(this)),t.draggable("option","drag",this.drag.bind(this)),t.draggable("option","stop",this.dragStop.bind(this)),t.addClass("ba-cheetah-ui-pinning-initialized")),this.isPinned()&&this.pinLightbox(t),BACheetah.addHook("responsive-editing-switched",this.resize))},pinnedLightboxClosed:function(){var e=l(".ba-cheetah--content-library-panel");tab=null,this.isPinned()&&(tab=e.find(".ba-cheetah--panel-content .is-showing").data("tab"),e.find(".ba-cheetah--tabs [data-tab="+tab+"]").addClass("is-showing")),l(".bal-cheetah-lightbox").removeClass("ba-cheetah-lightbox-prevent-animation")},unpinLightboxes:function(){var h=l("body"),s=l(".ba-cheetah--content-library-panel");s.find(".ba-cheetah-lightbox-wrap").each(function(){var e,t,a,i=l(this),o=i.find(".bal-cheetah-lightbox");o.draggable("enable"),o.resizable("enable"),o.find(".ui-resizable-handle").show(),h.append(i),o.is(":visible")?(e=parseInt(s.css("top"))-parseInt(i.css("top"))-parseInt(i.css("padding-top")),t=parseInt(s.css("left"))-parseInt(i.css("padding-left")),a=parseInt(s.css("right"))-parseInt(i.css("padding-right")),o.css("top",(e<0?0:e)+"px"),o.css(BACheetahConfig.isRtl?"right":"left",(BACheetahConfig.isRtl?a:t)+"px"),o.addClass("ba-cheetah-lightbox-prevent-animation"),h.removeClass("ba-cheetah-content-panel-is-showing"),BACheetah.ContentPanel.isShowing=!1):o.css({top:"25px",left:"25px"})}),BACheetah._reinitEditorFields()},closeLightboxOnPanelClick:function(){BACheetah._triggerSettingsSave(!1,!0)},windowResize:function(){this.pinOrUnpin()},resizeStart:function(){l("body").addClass("ba-cheetah-resizable-is-resizing"),BACheetah._destroyOverlayEvents(),BACheetah._removeAllOverlays()},resize:function(){var e=l("body"),t=l(".ba-cheetah-responsive-preview, .ba-cheetah-responsive-preview-mask"),a=l(".ba-cheetah--content-library-panel"),i=a.outerWidth();a.is(":visible")?a.hasClass("ba-cheetah-ui-pinned-left")?(e.css("margin-left",i+"px"),t.css("margin-left",i+"px")):a.hasClass("ba-cheetah-ui-pinned-right")&&(e.css("margin-right",i+"px"),t.css("margin-right",i+"px")):e.css("margin","")},resizeStop:function(){l("body").removeClass("ba-cheetah-resizable-is-resizing"),BACheetah._bindOverlayEvents(),BACheetah._resizeLayout(),this.savePosition()},dragStart:function(e,t){var a=l("body"),e=(l(e.target),l(".ba-cheetah-bar-actions"));l(".ba-cheetah-lightbox-resizable:visible").length||e.addClass("ba-cheetah-content-panel-pin-zone"),a.addClass("ba-cheetah-draggable-is-dragging"),a.append('<div class="ba-cheetah-ui-pin-zone ba-cheetah-ui-pin-zone-left"></div>'),a.append('<div class="ba-cheetah-ui-pin-zone ba-cheetah-ui-pin-zone-right"></div>'),BACheetah._destroyOverlayEvents()},drag:function(e,t){var a=l("body"),i=l(".ba-cheetah-responsive-preview"),o=l(window),h=(i.length?i:o).width(),s=o.scrollTop(),n=l(".ba-cheetah--content-library-panel").offset().top,i=l(".ba-cheetah-bar-actions"),o=l(e.target);o.hasClass("ba-cheetah--content-library-panel")&&(e.clientX<h-75&&n-s<46?i.addClass("ba-cheetah-content-panel-pin-zone-hover"):i.removeClass("ba-cheetah-content-panel-pin-zone-hover")),o.hasClass("ba-cheetah-ui-pinned")?this.unpinPanel():e.clientX<75?a.addClass("ba-cheetah-ui-show-pin-zone ba-cheetah-ui-show-pin-zone-left"):e.clientX>h-75?a.addClass("ba-cheetah-ui-show-pin-zone ba-cheetah-ui-show-pin-zone-right"):(a.removeClass("ba-cheetah-ui-show-pin-zone"),a.removeClass("ba-cheetah-ui-show-pin-zone-left"),a.removeClass("ba-cheetah-ui-show-pin-zone-right"))},dragStop:function(e,t){l(window);var a=l("body"),i=l(".ba-cheetah-bar-actions"),o=l(".ba-cheetah-ui-pin-zone"),h=l(".ba-cheetah--content-library-panel"),s=l(".ba-cheetah-lightbox-resizable:visible");l(e.target);a.removeClass("ba-cheetah-draggable-is-dragging"),i.removeClass("ba-cheetah-content-panel-pin-zone"),i.removeClass("ba-cheetah-content-panel-pin-zone-hover"),o.remove(),s.length&&parseInt(s.css("top"))<0&&s.css("top","0"),a.hasClass("ba-cheetah-ui-show-pin-zone")?(a.hasClass("ba-cheetah-ui-show-pin-zone-left")?this.pin("left",!0):this.pin("right",!0),a.removeClass("ba-cheetah-ui-show-pin-zone"),a.removeClass("ba-cheetah-ui-show-pin-zone-left"),a.removeClass("ba-cheetah-ui-show-pin-zone-right")):h.find(".bal-cheetah-lightbox").length?(this.unpin(!0),"module"!==BACheetahConfig.userTemplateType&&!BACheetahConfig.simpleUi||h.hide()):(h.attr("style",""),this.savePosition()),BACheetah._bindOverlayEvents()},disableDragAndResize:function(){var e=l(".ba-cheetah--content-library-panel"),t=l(".ba-cheetah-lightbox-resizable");e.draggable("disable"),e.resizable("disable"),t.draggable("disable"),t.resizable("disable")},enableDragAndResize:function(){var e=l(".ba-cheetah--content-library-panel"),t=l(".ba-cheetah-lightbox-resizable:not(.ba-cheetah-lightbox-width-full)");e.draggable("enable"),e.resizable("enable"),this.isPinned()||(t.draggable("enable"),t.resizable("enable"))},savePosition:function(){var e=l(".ba-cheetah--content-library-panel"),t=l(".ba-cheetah-lightbox-resizable:visible"),a={pinned:{width:e.outerWidth(),position:null}};e.hasClass("ba-cheetah-ui-pinned-left")?a.pinned.position="left":e.hasClass("ba-cheetah-ui-pinned-right")?a.pinned.position="right":t.length&&(a.lightbox={width:t.width(),height:t.height(),top:parseInt(t.css("top"))<0?"0px":t.css("top"),left:t.css("left")}),BACheetahConfig.userSettings.pinned=a.pinned,a.lightbox&&(BACheetahConfig.userSettings.lightbox=a.lightbox),BACheetah.ajax({action:"save_pinned_ui_position",data:a})},restorePosition:function(){var e=l(".ba-cheetah--content-library-panel"),t=BACheetahConfig.userSettings.pinned;t&&t.position&&(e.css("width",t.width+"px"),this.pin(t.position,!1),e.css("width",t.width+"px"))}};l(function(){e.init()})}(jQuery),function(n){var a={init:function(){this.setupMainMenuData(),n(".ba-cheetah--revision-actions select").on("change",this.selectChanged),n(".ba-cheetah-cancel-revision-preview").on("click",this.exitPreview.bind(this)),n(".ba-cheetah-apply-revision-preview").on("click",this.applyClicked.bind(this)),BACheetah.addHook("revisionItemClicked",this.itemClicked.bind(this)),BACheetah.addHook("didPublishLayout",this.refreshItems.bind(this))},setupMainMenuData:function(){var e,t,a=BACheetahConfig.revisions.posts,i=BACheetahConfig.revisions.authors,o=wp.template("ba-cheetah-revision-list-item"),h=n(".ba-cheetah--revision-actions select"),s=0;if(BACheetahConfig.mainMenu.revisions.items=[],h.html(""),0===a.length)BACheetahConfig.mainMenu.revisions.items.push({eventName:"noRevisionsMessage",type:"event",label:wp.template("ba-cheetah-no-revisions-message")()});else for(;s<a.length;s++)e=BACheetahStrings.revisionDate.replace("%s",a[s].date.diff),e+=" ("+a[s].date.published+")",t=BACheetahStrings.revisionAuthor.replace("%s",i[a[s].author].name),BACheetahConfig.mainMenu.revisions.items.push({eventName:"revisionItemClicked",type:"event",label:o({id:a[s].id,date:e,author:t,avatar:i[a[s].author].avatar})}),h.append('<option value="'+a[s].id+'">'+e+"</option>");void 0!==BACheetah.MainMenu&&BACheetah.MainMenu.renderPanel("revisions")},refreshItems:function(){BACheetah.ajax({action:"refresh_revision_items"},this.refreshItemsComplete.bind(this))},refreshItemsComplete:function(e){BACheetahConfig.revisions=BACheetah._jsonParse(e),this.setupMainMenuData()},itemClicked:function(e,t){t=n(t).find(".ba-cheetah-revision-list-item").attr("data-revision-id");BACheetah._triggerSettingsSave(!1,!0)&&(n(".ba-cheetah--revision-actions select").val(t),this.preview(t))},selectChanged:function(e){a.preview(n(this).val())},applyClicked:function(e){var t=n(".ba-cheetah--revision-actions select").val();a.restore(t)},preview:function(e){n(".ba-cheetah--revision-actions").css("display","flex"),BACheetah.triggerHook("didEnterRevisionPreview"),BACheetah.showAjaxLoader(),BACheetah.ajax({action:"render_revision_preview",revision_id:e},this.previewRenderComplete.bind(this))},previewRenderComplete:function(e){BACheetah._renderLayout(e,function(){BACheetah._destroyOverlayEvents(),BACheetah._removeAllOverlays()})},exitPreview:function(){n(".ba-cheetah--revision-actions").hide(),BACheetah.triggerHook("didExitRevisionPreview"),BACheetah._bindOverlayEvents(),BACheetah._updateLayout()},restore:function(e){n(".ba-cheetah--revision-actions").hide(),BACheetah.triggerHook("didExitRevisionPreview"),BACheetah.showAjaxLoader(),BACheetah._bindOverlayEvents(),BACheetah.ajax({action:"restore_revision",revision_id:e},a.restoreComplete)},restoreComplete:function(e){e=BACheetah._jsonParse(e);BACheetah._renderLayout(e.layout),BACheetah.triggerHook("didRestoreRevisionComplete",e.config),settings=e.settings,void 0!==settings.css&&null!==settings.css&&(BACheetahSettingsConfig.settings.layout.css=settings.css),void 0!==settings.js&&null!==settings.js&&(BACheetahSettingsConfig.settings.layout.js=settings.js)}};n(function(){a.init()})}(jQuery),function(){var t={query:function(e){var t,a,i={},o={library:{}};if(e=this.normalizeQuery(e),_.isNull(e.kind))i=BACheetahConfig.contentItems;else for(var h in e.kind)i[t=e.kind[h]]=BACheetahConfig.contentItems[t];return a=this.findMatches(e,i),o.library=this.formatResults(a,e),o},normalizeQuery:function(e){return e=_.extend({kind:null,type:null,category:null,group:null,enabled:!0,global:null,searchTerm:null,categorized:!1},e),_.isString(e.kind)&&(e.kind=[e.kind]),e},findMatches:function(e,t){var a,i,o,h,s={},n=null,l=null;for(n in t)for(l in a=t[n],s[n]={items:[]},a)if(i=a[l],_.isUndefined(e.category)||_.isNull(e.category)||this.matchesCategory(i.category,e.category)){switch(n){case"template":if(!(_.isUndefined(e.content)||_.isNull(e.content)||(o=_.includes(e.content,i.content),h=e.content===i.content,o||h)))continue;if(!_.isUndefined(e.type)&&!_.isNull(e.type)&&e.type!==i.type)continue;if(!_.isNull(e.group)){var r=e.group,d=i.group;if(_.isString(r)&&(r=[r]),_.isString(d)&&(d=[d]),_.isEmpty(r)||_.isEmpty(d))continue;var c=!1;for(l in r){var u=r[l];_.includes(d,u)&&(c=!0)}if(!c)continue}break;case"module":if(!_.isNull(e.group)){if(!1===e.group&&0<i.group.length)continue;if(!1!==e.group&&!_.includes(i.group,e.group))continue}}(_.isUndefined(e.searchTerm)||_.isNull(e.searchTerm)||this.matchesSearchTerm(i,e.searchTerm))&&s[n].items.push(i)}return s},matchesCategory:function(e,t){var a,i,o,h;if(e===t)return!0;for(i in t=_.isString(t)?[t]:t){if(a=t[i],_.isString(e)&&e===a)return!0;if(_.isArray(e))for(o in e)if(e[o]===a)return!0;if(_.isObject(e))for(h in e)if(e[h]===a||h===a)return!0}return!1},matchesSearchTerm:function(e,t){var a=t.toLowerCase();return!(_.isUndefined(e.slug)||!e.slug.toLowerCase().includes(a))||(!(_.isUndefined(e.name)||!e.name.toLowerCase().includes(a))||(!(!_.isString(e.category)||!e.category.toLowerCase().includes(a))||(!(_.isUndefined(e.description)||!e.description.toLowerCase().includes(a))||(!(_.isUndefined(e.id_base)||!e.id_base.includes(t))||(!(!e.isWidget||!"widget".includes(a))||!(_.isUndefined(e.editor_export)||!"module".includes(a)))))))},formatResults:function(e,t){if(t.categorized)for(type in e){var a=e[type].items;e[type].categorized=this.groupBy(a,"category")}return e},groupBy:function(e,a){var o,h,s={};return _.forEach(e,function(i,e,t){o=i[a],_.isNull(o)||_.isUndefined(o)||_.isString(o)&&""===i[o]||(_.isString(o)&&(s[o]=s[o]||[],s[o].push(i)),_.isArray(o)&&(h=o,_.forEach(h,function(e,t,a){s[e]=s[e]||[],s[e].push(i)})),_.isObject(o)&&(h=o,_.forEach(h,function(e,t,a){s[e]=s[e]||[],s[e].push(i)})))}),s},search:function(e){var t=this.query({searchTerm:e}),a={total:0,term:e,sections:{}};if(!_.isUndefined(t.library.module.items)){var i,o={};for(i in t.library.module.items){var h=t.library.module.items[i],s=h.group[0],n=h.category;h.name;_.isUndefined(o[s])&&(o[s]={}),_.isUndefined(o[s][n])&&(o[s][n]=[]),o[s][n].push(h)}a.grouped=o}for(i in t.library){var l=t.library[i];!_.isUndefined(l.items)&&0<l.items.length&&(a.sections[i]={name:BACheetahStrings.typeLabels[i],handle:i,type:"",items:l.items},a.total+=l.items.length)}return a}};BACheetah.Search={byQuery:function(e){return t.query(e)},byTerm:function(e){return t.search(e)}}}(jQuery),function(a,i){var o={layoutNeedsPublish:!1,defaultIndicatorMessage:"",defaultTooltipMessage:"",messages:null,init:function(){this.messages=BACheetahStrings.savedStatus,this.$savingIndicator=a(".ba-cheetah--saving-indicator"),i.addHook("didBeginAJAX",this.onLayoutSaving.bind(this)),i.addHook("didCompleteAJAX",this.onLayoutSaved.bind(this)),i.addHook("didPublishLayout",this.onLayoutPublished.bind(this)),i.addHook("publishAndRemain",this.onPublishAndRemain.bind(this)),i.addHook("didShowLightbox",this.setLayoutNeedsPublish.bind(this)),!BACheetahConfig.layoutHasDraftedChanges&&BACheetahConfig.builderEnabled||(this.setLayoutNeedsPublish(),this.resetStatusMessage())},setLayoutNeedsPublish:function(){this.layoutNeedsPublish||(this.layoutNeedsPublish=!0,a("body").addClass("ba-cheetah--layout-has-drafted-changes"))},onLayoutSaving:function(e,t){this.isPublishingLayout(t.action)?this.showStatusMessage(this.messages.publishing,this.messages.publishingTooltip):this.isUpdatingLayout(t.action)&&(this.setLayoutNeedsPublish(),this.showStatusMessage(this.messages.saving,this.messages.savingTooltip))},isPublishingLayout:function(e){return"save_layout"==e},isUpdatingLayout:function(e){return!this.isPublishingLayout()&&(e.startsWith("render")?!!e.startsWith("render_new"):!e.startsWith("duplicate")&&(!e.startsWith("refresh")&&("save_ui_skin"!=e&&("save_lightbox_position"!=e&&("save_pinned_ui_position"!=e&&("ba_cheetah_notifications"!=e&&!(-1<e.indexOf("history"))))))))},onLayoutSaved:function(e,t){var a;this.isUpdatingLayout(t.ba_cheetah_data.action)&&(this.showStatusMessage(this.messages.saved,this.messages.savedTooltip),a=this,setTimeout(function(){a.resetStatusMessage()},2e3))},onLayoutPublished:function(){this.layoutNeedsPublish=!1,a("body").removeClass("ba-cheetah--layout-has-drafted-changes"),this.resetStatusMessage()},showStatusMessage:function(e,t){this.$savingIndicator.html(e),i.isUndefined(t)||(this.$savingIndicator.attr("title",t),a(".ba-cheetah--saving-indicator").tipTip({defaultPosition:"bottom",edgeOffset:14}))},resetStatusMessage:function(){this.layoutNeedsPublish?(this.defaultIndicatorMessage=this.messages.edited,this.defaultTooltipMessage=this.messages.editedTooltip):(this.defaultIndicatorMessage="",this.defaultTooltipMessage=""),this.showStatusMessage(this.defaultIndicatorMessage,this.defaultTooltipMessage)},onPublishAndRemain:function(){i.MainMenu.hide(),i._publishLayout(!1,!0)}};i.SaveManager={layoutNeedsPublish:function(){return o.layoutNeedsPublish},showStatusMessage:function(e,t){o.showStatusMessage(e,t)},resetStatusMessage:function(){o.resetStatusMessage()}},a(function(){o.init()})}(jQuery,BACheetah),function(o){BACheetahHistoryManager={states:[],position:0,rendering:!1,init:function(){var e=BACheetahConfig.history,i=this;this.states=e.states,this.position=parseInt(e.position),this.setupMainMenuData(),o.each(e.hooks,function(e,a){BACheetah.addHook(e,function(e,t){i.saveCurrentState(a,t)})}),BACheetah.addHook("didPublishLayout",this.clearStatesOnPublish.bind(this)),BACheetah.addHook("restartEditingSession",this.saveCurrentStateOnRestartSession.bind(this)),BACheetah.addHook("historyItemClicked",this.itemClicked.bind(this)),BACheetah.addHook("undo",this.onUndo.bind(this)),BACheetah.addHook("redo",this.onRedo.bind(this))},saveCurrentState:function(e,t){var a=this,i=null;void 0!==(t=void 0===t?{}:t).moduleType&&t.moduleType&&(i=t.moduleType),BACheetah.ajax({action:"save_history_state",label:e,module_type:i},function(e){e=JSON.parse(e);a.states=e.states,a.position=parseInt(e.position),a.setupMainMenuData()})},saveCurrentStateOnRestartSession:function(e){this.states.length||this.saveCurrentState("draft_created")},clearStatesOnPublish:function(e,t){var a=this;this.states=[],this.position=0,this.setupMainMenuData(),BACheetah.ajax({action:"clear_history_states",post_id:BACheetahConfig.postId},function(){t.shouldExit||a.saveCurrentState("draft_created")})},renderState:function(e){var t,a=this;!this.rendering&&this.states.length&&(o(".ba-cheetah-settings:visible").length||(t=setTimeout(BACheetah.showAjaxLoader,2e3),this.rendering=!0,BACheetah.ajax({action:"render_history_state",position:e},function(e){e=JSON.parse(e);e.error||(a.position=parseInt(e.position),BACheetah.triggerHook("didRestoreHistoryComplete",e),BACheetah._renderLayout(e.layout),a.setupMainMenuData()),clearTimeout(t),a.rendering=!1})))},onUndo:function(){this.renderState("prev")},onRedo:function(){this.renderState("next")},setupMainMenuData:function(){var e=BACheetahConfig.history.labels,t="";BACheetahConfig.mainMenu.history.items=[];for(var a=this.states.length-1;0<=a;a--)"string"==typeof this.states[a]?t=e[this.states[a]]||this.states[a]:(t=e[this.states[a].label]||this.states[a].label,(this.states[a].moduleType||-1<this.states[a].label.indexOf("module"))&&(t=t.replace("%s",this.getModuleName(this.states[a].moduleType)))),BACheetahConfig.mainMenu.history.items.push({eventName:"historyItemClicked",type:"event",label:wp.template("ba-cheetah-history-list-item")({label:t,current:a===this.position?1:0,position:a})});BACheetahConfig.history.enabled||BACheetahConfig.mainMenu.history.items.push({eventName:"historyItemClicked",type:"event",label:wp.template("ba-cheetah-history-list-item")({label:BACheetahConfig.history.labels.history_disabled,current:0,position:0})}),void 0!==BACheetah.MainMenu&&BACheetah.MainMenu.renderPanel("history");var i=this.position<this.states.length-1;o(".ba-navbar-actions .ba-cheetah-button[data-action=redo]").prop("disabled",!i);i=0<this.position;o(".ba-navbar-actions .ba-cheetah-button[data-action=undo]").prop("disabled",!i)},getModuleName:function(e){var t=BACheetahConfig.contentItems.module,a=0;if("widget"===e)return BACheetahStrings.widget;for(;a<t.length;a++)if(void 0!==t[a].slug&&e===t[a].slug)return t[a].name;return BACheetahStrings.module},itemClicked:function(e,t){var a=o(t).find(".ba-cheetah-history-list-item"),i=a.attr("data-position"),t=o(".ba-cheetah-history-list-item[data-current=1]");o(".ba-cheetah-settings:visible").length&&(BACheetah._closeNestedSettings(),BACheetah._lightbox.close()),t.attr("data-current",0),a.attr("data-current",1),this.renderState(i)}},o(function(){BACheetahHistoryManager.init()})}(jQuery);